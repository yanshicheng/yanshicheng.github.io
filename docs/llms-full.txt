---
url: /01.æŒ‡å—/10.ä½¿ç”¨/15.Podè¿ç»´.md
---

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Kube Nova å¹³å°ä¸­è¿›è¡Œ Pod å…¨æ–¹ä½è¿ç»´ç®¡ç†ï¼ŒåŒ…æ‹¬ Pod åˆ—è¡¨æŸ¥çœ‹ã€çŠ¶æ€ç›‘æ§ã€æ—¥å¿—ç®¡ç†ã€ç»ˆç«¯è®¿é—®ã€æ–‡ä»¶ç®¡ç†ã€å®¹å™¨ç®¡ç†ä»¥åŠ Pod ç”Ÿå‘½å‘¨æœŸæ“ä½œç­‰åŠŸèƒ½ã€‚

Pod æ˜¯ Kubernetes ä¸­æœ€å°çš„å¯éƒ¨ç½²å•å…ƒï¼Œä¹Ÿæ˜¯æ—¥å¸¸è¿ç»´å·¥ä½œä¸­æœ€å¸¸æ¥è§¦çš„èµ„æºå¯¹è±¡ã€‚Kube Nova å¹³å°æä¾›äº†å®Œå–„çš„ Pod è¿ç»´å·¥å…·é›†ï¼Œå¸®åŠ©è¿ç»´äººå‘˜å¿«é€Ÿå®šä½é—®é¢˜ã€åˆ†ææ€§èƒ½ã€ç®¡ç†å®¹å™¨ï¼Œå®ç°å¯¹ Pod å…¨ç”Ÿå‘½å‘¨æœŸçš„ç²¾ç»†åŒ–ç®¡ç†ã€‚

âœ¨ **ç‰¹æ€§:**

* **çŠ¶æ€ç›‘æ§**ï¼šå®æ—¶æŸ¥çœ‹ Pod çš„è¿è¡ŒçŠ¶æ€ã€èµ„æºä½¿ç”¨æƒ…å†µå’Œå¥åº·çŠ¶å†µã€‚
* **æ—¥å¿—ç®¡ç†**ï¼šæ”¯æŒå®æ—¶æ—¥å¿—æµã€å†å²æ—¥å¿—æŸ¥è¯¢ã€æ—¥å¿—æœç´¢å’Œä¸‹è½½ã€‚
* **ç»ˆç«¯è®¿é—®**ï¼šé€šè¿‡ Web Terminal ç›´æ¥è¿æ¥åˆ°å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤ã€‚
* **æ–‡ä»¶ç®¡ç†**ï¼šå¯è§†åŒ–æµè§ˆã€ä¸Šä¼ ã€ä¸‹è½½å®¹å™¨å†…çš„æ–‡ä»¶ç³»ç»Ÿã€‚
* **å®¹å™¨ç®¡ç†**ï¼šæŸ¥çœ‹ Pod å†…æ‰€æœ‰å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯å’Œé•œåƒç‰ˆæœ¬ã€‚
* **ä¸´æ—¶å®¹å™¨**: ä¸´æ—¶å®¹å™¨æ³¨å…¥, å¿«é€Ÿæ’éšœ
* **ç”Ÿå‘½å‘¨æœŸæ“ä½œ**ï¼šæ”¯æŒ Pod é©±é€ã€åˆ é™¤ã€ç­‰è¿ç»´æ“ä½œã€‚

**æ“ä½œè·¯å¾„**ï¼šä¸šåŠ¡ä¸­å¿ƒ â†’ åº”ç”¨ä¸­å¿ƒ â†’ ç‰ˆæœ¬ç®¡ç† â†’ Pod ç®¡ç†
**æ“ä½œè·¯å¾„**ï¼šä¸šåŠ¡ä¸­å¿ƒ â†’ åº”ç”¨ä¸­å¿ƒ â†’  Pod ç®¡ç†

***

## Pod åˆ—è¡¨

### è®¿é—®è·¯å¾„

åœ¨åº”ç”¨ä¸­å¿ƒé€‰æ‹©ç›®æ ‡æœåŠ¡åï¼Œåˆ‡æ¢åˆ°ã€Œç‰ˆæœ¬ç®¡ç†ã€æ ‡ç­¾é¡µï¼Œé€‰æ‹©å…·ä½“ç‰ˆæœ¬ï¼Œå³å¯çœ‹åˆ°è¯¥ç‰ˆæœ¬ä¸‹æ‰€æœ‰ Pod çš„åˆ—è¡¨ã€‚
![ç‰ˆæœ¬åˆ—è¡¨](https://images.ikubeops.com/static/20260116234535190.png)

***

## Pod ç›‘æ§

Pod ç›‘æ§åŠŸèƒ½æä¾›å®æ—¶çš„èµ„æºä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡å±•ç¤ºï¼Œå¸®åŠ©è¿ç»´äººå‘˜äº†è§£ Pod çš„è¿è¡Œå¥åº·çŠ¶å†µã€‚

é¡µé¢é¡¶éƒ¨å±•ç¤ºå››ä¸ªæ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ï¼š

* **CPU ä½¿ç”¨**
* **å†…å­˜ä½¿ç”¨**
* **ç£ç›˜ IO**
* **ç½‘ç»œæµé‡**
* **Pod çŠ¶æ€**
  ![podç›‘æ§](https://images.ikubeops.com/static/20260116221232474.png)

***

## Pod æ—¥å¿—

æ—¥å¿—ç®¡ç†æ˜¯ Pod è¿ç»´ä¸­æœ€å¸¸ç”¨çš„åŠŸèƒ½ï¼Œç”¨äºæ’æŸ¥é—®é¢˜ã€è¿½è¸ªåº”ç”¨è¡Œä¸ºå’Œå®¡è®¡æ“ä½œè®°å½•ã€‚
![podæ—¥å¿—](https://images.ikubeops.com/static/20260116221529091.png)

***

## Pod ç»ˆç«¯

Pod ç»ˆç«¯åŠŸèƒ½æä¾› Web Terminal ç•Œé¢ï¼Œå…è®¸è¿ç»´äººå‘˜ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿æ¥åˆ°å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤ï¼Œæ— éœ€ä½¿ç”¨ kubectl exec å‘½ä»¤ã€‚
![podç»ˆç«¯](https://images.ikubeops.com/static/20260116221556830.png)

### æ³¨æ„äº‹é¡¹

ç»ˆç«¯æ“ä½œç›´æ¥ä½œç”¨äºç”Ÿäº§å®¹å™¨ï¼Œè¯·è°¨æ…æ‰§è¡Œæœ‰å‰¯ä½œç”¨çš„å‘½ä»¤ã€‚æŸäº›ç²¾ç®€ç‰ˆå®¹å™¨é•œåƒï¼ˆå¦‚åŸºäº Alpine æˆ– Distrolessï¼‰å¯èƒ½ç¼ºå°‘å¸¸ç”¨å·¥å…·ï¼Œæ­¤æ—¶å¯è€ƒè™‘ä½¿ç”¨ä¸´æ—¶å®¹å™¨æ³¨å…¥åŠŸèƒ½ã€‚ç»ˆç«¯ä¼šè¯åœ¨é¡µé¢å…³é—­æˆ–è¿æ¥è¶…æ—¶åè‡ªåŠ¨æ–­å¼€ã€‚

***

## Pod æ–‡ä»¶ç®¡ç†

æ–‡ä»¶ç®¡ç†åŠŸèƒ½æä¾›å¯è§†åŒ–çš„æ–‡ä»¶æµè§ˆå™¨ï¼Œæ”¯æŒæŸ¥çœ‹ã€ä¸Šä¼ ã€ä¸‹è½½å®¹å™¨å†…çš„æ–‡ä»¶ï¼Œæ— éœ€é€šè¿‡å‘½ä»¤è¡Œæ“ä½œã€‚

> \[!TIP] åŠŸèƒ½ä»‹ç»
> å¼ºå¤§çš„ä¸Šä¼ ä¸‹è½½åŠŸèƒ½ï¼Œæ”¯æŒåˆ†ç‰‡ä¸Šä¼ ä¸‹è½½ã€‚

![æ–‡ä»¶ç®¡ç†](https://images.ikubeops.com/static/20260116234636859.png)

***

## å®¹å™¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸç®¡ç†

### å¯ç”¨æ“ä½œ

* **ç›‘æ§**ï¼šè·³è½¬åˆ° Pod ç›‘æ§é¡µé¢ï¼ŒæŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡ã€‚
* **å®¹å™¨åˆ—è¡¨**ï¼šæŸ¥çœ‹ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒã€çŠ¶æ€ç­‰ã€‚
* **YAML**ï¼šæŸ¥çœ‹ Pod çš„å®Œæ•´ YAML é…ç½®ã€‚
* **è¯¦æƒ…**ï¼šæŸ¥çœ‹ Pod çš„æ ¼å¼åŒ–è¯¦æƒ…ä¿¡æ¯ã€‚
* **æ³¨å…¥ä¸´æ—¶å®¹å™¨**ï¼šå‘è¿è¡Œä¸­çš„ Pod æ³¨å…¥ä¸´æ—¶è°ƒè¯•å®¹å™¨ï¼Œç”¨äºæ•…éšœæ’æŸ¥ã€‚
* **é©±é€**ï¼šå®‰å…¨åœ°å°† Pod ä»å½“å‰èŠ‚ç‚¹é©±é€ï¼Œè§¦å‘é‡æ–°è°ƒåº¦ã€‚
* **åˆ é™¤**ï¼šåˆ é™¤ Podï¼Œå¯¹äº Deployment ç®¡ç†çš„ Pod ä¼šè‡ªåŠ¨é‡å»ºã€‚

### æŸ¥çœ‹å®¹å™¨åˆ—è¡¨

å½“ Pod åŒ…å«å¤šä¸ªå®¹å™¨æ—¶ï¼Œå®¹å™¨ç®¡ç†åŠŸèƒ½å¸®åŠ©æ‚¨æŸ¥çœ‹å’Œç®¡ç†æ¯ä¸ªå®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚
![image.png](https://images.ikubeops.com/static/20260116234920572.png)

### æ³¨å…¥ä¸´æ—¶å®¹å™¨

æ­¤åŠŸèƒ½å¯ä»¥ååŠ©è¿›è¡Œæ•…éšœæ’æŸ¥ï¼Œç½‘ç»œæµ‹è¯•ç­‰ã€‚
![image.png](https://images.ikubeops.com/static/20260116235049881.png)

---

---
url: /@pages/loginPage.md
---


---

---
url: /@pages/riskLinkPage.md
---


---

---
url: /personal.md
---

## ğŸŒŸ æ”¯æŒé¡¹ç›®

å¦‚æœ Kube Nova å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç»™æˆ‘ä»¬ä¸€ä¸ª Star â­ï¸ï¼Œè¿™æ˜¯å¯¹æˆ‘ä»¬æœ€å¤§çš„é¼“åŠ±ï¼

## ğŸ‘¥ åŠ å…¥ç¤¾åŒº

æ¬¢è¿åŠ å…¥ Kube Nova ç¤¾åŒºï¼Œä¸å…¶ä»–ç”¨æˆ·ä¸€èµ·äº¤æµä½¿ç”¨ç»éªŒã€åˆ†äº«æœ€ä½³å®è·µï¼

[//]: # "## â˜• èµèµæ”¯æŒ"

[//]: #

[//]: # "Kube Nova æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå¦‚æœå®ƒå¸®åŠ©åˆ°äº†æ‚¨ï¼Œå¯ä»¥è¯·ä½œè€…å–æ¯å’–å•¡ â˜•ï¸"

[//]: #

[//]: # "<div class=\"sponsor-grid\">"

[//]: # "<div class=\"sponsor-card wechat-pay\">"

[//]: # "<div class=\"sponsor-header\"><svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><path d=\"M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 01.213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.326.326 0 00.167-.054l1.903-1.114a.864.864 0 01.717-.098 10.16 10.16 0 002.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 1.932-6.446 1.703-1.415 3.882-1.98 5.853-1.838-.576-3.583-4.196-6.348-8.596-6.348zM5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 01-1.162 1.178A1.17 1.17 0 014.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 01-1.162 1.178 1.17 1.17 0 01-1.162-1.178c0-.651.52-1.18 1.162-1.18z\"/></svg><span>å¾®ä¿¡èµèµ</span></div>"

[//]: # "<img class=\"sponsor-qr\" src=\"https://wiki-images.yanshicheng.com/common/kube-nova-wechat.png\" alt=\"å¾®ä¿¡èµèµç \" />"

[//]: # "<p class=\"sponsor-tip\">å¾®ä¿¡æ‰«ä¸€æ‰« ğŸ’š</p>"

[//]: # "</div>"

[//]: # "<div class=\"sponsor-card alipay\">"

[//]: # "<div class=\"sponsor-header\"><svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><path d=\"M21.422 15.358c-3.83-1.153-6.055-1.84-7.18-2.282.96-1.584 1.838-3.61 2.28-5.291h-5.69V6.083h6.76V5.05h-6.76V2.74c0-.17-.14-.305-.344-.305H8.064v2.615H1.222v1.033h6.842v1.702H2.017v1.012h10.94c-.37 1.173-1.063 2.727-1.87 4.03-2.88-.773-5.955-.673-7.946.702-2.28 1.577-2.688 4.406-.913 6.05 1.775 1.643 5.072 1.53 7.352-.048 1.33-.92 2.442-2.313 3.314-3.903 1.72.702 4.972 1.9 9.106 3.14l.422-2.41zM6.987 19.93c-1.512.678-3.574.543-4.463-.366-.89-.908-.533-2.503.865-3.462 1.063-.728 2.538-.94 3.987-.677.893.163 1.742.46 2.512.833-.816 1.424-1.725 2.73-2.9 3.672z\"/></svg><span>æ”¯ä»˜å®èµèµ</span></div>"

[//]: # "<img class=\"sponsor-qr\" src=\"https://wiki-images.yanshicheng.com/common/kube-nova-wechat.png\" alt=\"æ”¯ä»˜å®èµèµç \" />"

[//]: # "<p class=\"sponsor-tip\">æ”¯ä»˜å®æ‰«ä¸€æ‰« ğŸ’™</p>"

[//]: # "</div>"

[//]: # "</div>"

[//]: #

[//]: # "<div class=\"sponsor-message\">"

[//]: # "<span class=\"message-icon\">ğŸ™</span>"

[//]: # "<div class=\"message-content\">"

[//]: # "<strong>æ„Ÿè°¢æ‰€æœ‰èµåŠ©è€…</strong>"

[//]: # "<p>æ¯ä¸€ä»½æ”¯æŒéƒ½æ˜¯å¯¹å¼€æºçš„è®¤å¯ï¼Œæ„Ÿè°¢ä½ ä»¬è®© Kube Nova å˜å¾—æ›´å¥½ï¼</p>"

[//]: # "</div>"

[//]: # "</div>"

## ğŸ“® è”ç³»ä½œè€…

## ğŸ“œ å¼€æºåè®®

Kube Nova éµå¾ª [AGPL v3.0](https://github.com/yanshicheng/kube-nova/blob/main/LICENSE) å¼€æºåè®®ã€‚

---

---
url: /@pages/categoriesPage.md
---


---

---
url: /100.script/å‘¨æŠ¥æ¨¡æ¿.md
---

## æœ¬å‘¨æ¦‚è¦

```dataviewjs
//æ—¥è®°æ–‡ä»¶åæ ¼å¼ï¼ˆå®šä¹‰æˆä½ è‡ªå·±æ—¥è®°æ–‡ä»¶åçš„æ ¼å¼ï¼Œæ›¿æ¢å…¶ä¸­çš„å˜é‡ï¼‰
//yyyy = å¹´ä»½ï¼ˆä¾‹å¦‚ï¼š2023ï¼‰
//m    = è‡ªé€‚åº”ä½æ•°æœˆä»½ï¼ˆä¾‹å¦‚ï¼š3ã€10ï¼‰
//mm   = ä¸¤ä½æ•°æœˆä»½ï¼ˆä¾‹å¦‚ï¼š03ã€10ï¼‰
//d    = è‡ªé€‚åº”ä½æ•°æ—¥æœŸï¼ˆä¾‹å¦‚ï¼š3ã€10ï¼‰
//dd   = ä¸¤ä½æ•°æ—¥æœŸï¼ˆä¾‹å¦‚ï¼š03ã€10ï¼‰
let dailyFileFormat = "yyyy-m-d-æ—¥æŠ¥";
//æ—¥è®°æ–‡ä»¶å¤¹è·¯å¾„
const dailyFilePath = "WorkRecord/æ—¥æŠ¥";

//æ—¥æŠ¥æ–‡ä»¶åæ ¼å¼ï¼ˆå®šä¹‰æˆä½ è‡ªå·±æ—¥æŠ¥æ–‡ä»¶åçš„æ ¼å¼ï¼Œæ›¿æ¢å…¶ä¸­çš„å˜é‡ï¼‰
//yyyy = å¹´ä»½ï¼ˆä¾‹å¦‚ï¼š2023ï¼‰
//m    = è‡ªé€‚åº”ä½æ•°æœˆä»½ï¼ˆä¾‹å¦‚ï¼š3ã€10ï¼‰
//mm   = ä¸¤ä½æ•°æœˆä»½ï¼ˆä¾‹å¦‚ï¼š03ã€10ï¼‰
//d    = è‡ªé€‚åº”ä½æ•°æ—¥æœŸï¼ˆä¾‹å¦‚ï¼š3ã€10ï¼‰
//dd   = ä¸¤ä½æ•°æ—¥æœŸï¼ˆä¾‹å¦‚ï¼š03ã€10ï¼‰
let dailyWorkFileFormat = "yyyy-m-d-æ—¥æŠ¥";
//æ—¥è®°æ–‡ä»¶å¤¹è·¯å¾„
const dailyWorkFilePath = "WorkRecord/å‘¨æŠ¥";

const weekFirstDay = dv.current().weekFirstDay;
const weekLastDat = dv.current().weekLastDat;
const weekday=["æ˜ŸæœŸæ—¥","æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"];

//æœ¬å‘¨æ—¥ç¨‹è¾“å‡º
let resultText = "";

//ç”¨äºæ¦‚è¦ç»Ÿè®¡
let dailyCountComplete = 0;
let dailyCountFail = 0;
let workCountComplete = 0;
let workCountFail = 0;
let docCount = 0;
for(var i = 0;i <= 6; i++){
    const nowDate = new Date(weekFirstDay);
    nowDate.setDate(nowDate.getDate() + i);

    //å½“å¤©æœ‰æ—¥è®°æ‰ç”Ÿæˆæ•°æ®
    const dayFile = dv.page(dailyFilePath + "/" + formatDailyFileName(nowDate,dailyFileFormat) +".md");
    if(dayFile != null){
        //æ ‡é¢˜
        resultText += "\n";
        resultText += "> [!TIP]- " +  weekday[nowDate.getDay()] +"\n> <span style='color: #72e9fd;font-weight:bold'>ğŸ“—[[" + dayFile.file.path + "|"+dayFile.file.name+"]]</span>\n";
    
        //æ—¥ç¨‹
        resultText += ">> [!SUCCESS] æ—¥ç¨‹è¡¨\n"
        if(dayFile != null && dayFile.file != null){
            const dayTask = dayFile.file.tasks;
            for(var rc = 0;rc < dayTask.length;rc ++){
                dayTask[rc].status == "x" ? dailyCountComplete++ : dailyCountFail++;
                resultText += ">> "+dayTask[rc].symbol+" ["+dayTask[rc].status+"] "+dayTask[rc].text+"\n";
            }
        }
        
        //å·¥ä½œ
        resultText += " > "
        resultText += "\n >> [!example] å·¥ä½œé¡¹\n"
        const dayWorkFile = dv.page(dailyWorkFilePath + "/" + formatDailyFileName(nowDate,dailyWorkFileFormat) +".md");
        if(dayWorkFile != null && dayWorkFile.file != null){
            const dayTask = dayWorkFile.file.tasks;
            for(var gz = 0;gz < dayTask.length;gz ++){
                dayTask[gz].status == "x" ? workCountComplete++ : workCountFail++;
                resultText += ">> "+dayTask[gz].symbol+" ["+dayTask[gz].status+"] "+dayTask[gz].text+"\n";
            }
        }
    
    
        //æ–‡ç« 
        resultText += " >"
        resultText += "\n >> [!NOTE] æ–°æ–‡ç« \n";
        const dayNewDoc = dv.pages().where(file => {
            const fileDate = new Date(file.file.cday);
            return (fileDate.getDate() == nowDate.getDate() && fileDate.getMonth() == nowDate.getMonth() && fileDate.getFullYear() && nowDate.getFullYear());
    })
        for(var j = 0;j<dayNewDoc.length;j++){
            docCount++;
            resultText += ">> - [[ " + dayNewDoc[j].file.path + "|"+dayNewDoc[j].file.name+" ]]\n";
        }
    }
    
}

//è¾“å‡º-æœ¬å‘¨æ¦‚è¦
dv.header(3,"æœ¬å‘¨æ¦‚è¦")
let summaryResult = "> [!SUCCESS] å…±å®Œæˆ \n" +
"> - ğŸŒæ—¥ç¨‹ï¼š<span style='color: #82eb82;font-weight:bold'>"+dailyCountComplete+"</span> \n" +
"> - ğŸ’¼å·¥ä½œä»»åŠ¡ï¼š<span style='color: #82eb82;font-weight:bold'>"+workCountComplete+"</span> \n" +
"> - âœ’ï¸æ–°æ–‡ç« ï¼š<span style='color: #82eb82;font-weight:bold'>"+docCount+"</span> \n" +
"> \n" +
">> [!FAIL]- æœªå®Œæˆ \n" +
">> - ğŸŒæ—¥ç¨‹ï¼š<span style='color: #f078a0;font-weight:bold'>"+dailyCountFail+"</span> \n" +
">> - ğŸ’¼å·¥ä½œä»»åŠ¡ï¼š<span style='color: #f078a0;font-weight:bold'>"+workCountFail+"</span> \n";
dv.span(summaryResult)

//æ–‡ä»¶åæ—¥æœŸæ ¼å¼åŒ–
function formatDailyFileName(date,format){
    const dateYear = date.getFullYear();
    const dateMonth = date.getMonth() + 1;
    const dateDate = date.getDate();
    return format
        .replace("yyyy",dateYear)
        .replace("mm",dateMonth < 10 ? '0' + dateMonth : dateMonth)
        .replace("m",dateMonth)
        .replace("dd",dateDate < 10 ? '0' + dateDate : dateDate)
        .replace("d",dateDate)
}
```

## æœ¬å‘¨æ—¥æŠ¥

\[\[2024-07-29-æ—¥æŠ¥]] | \[\[2024-07-30-æ—¥æŠ¥]] | \[\[2024-07-31-æ—¥æŠ¥]] | \[\[2024-08-01-æ—¥æŠ¥]] | \[\[2024-08-02-æ—¥æŠ¥]] | \[\[2024-08-03-æ—¥æŠ¥]] | \[\[2024-08-04-æ—¥æŠ¥]]

***

## ä»»åŠ¡æ€»ç»“

### æœ¬å‘¨å·²å®Œæˆ

````dataviewjs
function callout(text, type) {
    const allText = `> [!${type}]\n` + text;
    const lines = allText.split('\n');
    return lines.join('\n> ') + '\n'
}

const query = `
(done) AND (created >=  2024-07-29   AND created <= 2024-08-04  )
path includes WorkRecord/æ—¥æŠ¥
group by done
hide backlink
hide created date
`;

dv.paragraph('```tasks\n' + query + '\n```', 'done');
````

### æœ¬å‘¨æœªå®Œæˆ

````dataviewjs
function callout(text, type) {
    const allText = `> [!${type}]\n` + text;
    const lines = allText.split('\n');
    return lines.join('\n> ') + '\n'
}
const query = `
(not done) AND (created >=  2024-07-29   AND created <= 2024-08-04  )
path includes WorkRecord/æ—¥æŠ¥
group by created
hide backlink
hide created date
`;

dv.paragraph('```tasks\n' + query + '\n```', 'undone');
````

***

## æœ¬å‘¨æ€»ç»“

***

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/11.å·¥ä½œç©ºé—´.md
---

# å·¥ä½œç©ºé—´ç®¡ç†

âœ¨ **ç‰¹æ€§:**

* Namespace å¯è§†åŒ–ç®¡ç†: å·¥ä½œç©ºé—´ä¸ Kubernetes Namespace ä¸€ä¸€å¯¹åº”
* å¤šç»´åº¦èµ„æºé…é¢: æ”¯æŒ CPUã€å†…å­˜ã€GPUã€å­˜å‚¨ã€Pod ç­‰èµ„æºé…é¢è®¾ç½®
* ç»†ç²’åº¦é™åˆ¶ç­–ç•¥: Pod çº§åˆ«ã€å®¹å™¨çº§åˆ«çš„èµ„æºé™åˆ¶ä¸é»˜è®¤å€¼é…ç½®
* å®æ—¶ç›‘æ§é¢æ¿: èµ„æºä½¿ç”¨ã€é…é¢æ¶ˆè€—ã€æŒ‡æ ‡è¶‹åŠ¿ã€Pod æ’è¡Œæ¦œ
* è·¨é¡¹ç›®è¿ç§»: æ”¯æŒå·¥ä½œç©ºé—´åœ¨é¡¹ç›®é—´æ— ç¼è¿ç§»

## æ ¸å¿ƒæ¦‚å¿µ

å·¥ä½œç©ºé—´æ˜¯ Kube Nova ä¸­å¯¹ Kubernetes Namespace çš„æŠ½è±¡å°è£…ã€‚æ¯ä¸ªå·¥ä½œç©ºé—´å¯¹åº”é›†ç¾¤ä¸­çš„ä¸€ä¸ª Namespaceï¼Œæ˜¯é¡¹ç›®å†…èµ„æºéš”ç¦»å’Œç®¡ç†çš„åŸºæœ¬å•ä½ã€‚

### è‡ªåŠ¨åŒæ­¥ä¸é»˜è®¤é¡¹ç›®

å½“ Kube Nova å¹³å°åŒæ­¥é›†ç¾¤æ•°æ®æ—¶ï¼Œä¼šè‡ªåŠ¨å‘ç°é›†ç¾¤ä¸­å·²å­˜åœ¨çš„ Namespaceã€‚è¿™äº›é€šè¿‡åŒæ­¥å‘ç°çš„ Namespace ä¼šè¢«è‡ªåŠ¨å½’å±åˆ°ã€Œé»˜è®¤é¡¹ç›®ã€ä¸‹ï¼Œä½œä¸ºæœªåˆ†é…çš„å·¥ä½œç©ºé—´è¿›è¡Œç®¡ç†ã€‚

è¿™ç§è®¾è®¡ç¡®ä¿äº†é›†ç¾¤ä¸­æ‰€æœ‰çš„ Namespace éƒ½èƒ½è¢«å¹³å°çº³ç®¡ï¼Œä¸ä¼šå‡ºç°"æ¼ç®¡"çš„æƒ…å†µã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå»ºè®®å°†è¿™äº›è‡ªåŠ¨åŒæ­¥çš„å·¥ä½œç©ºé—´è¿ç§»åˆ°å¯¹åº”çš„ä¸šåŠ¡é¡¹ç›®ä¸­ï¼Œä»¥ä¾¿è¿›è¡Œæ›´ç²¾ç»†çš„èµ„æºç®¡ç†å’Œæˆæœ¬æ ¸ç®—ã€‚

### å·¥ä½œç©ºé—´ä¸èµ„æºæ± çš„å…³ç³»

å·¥ä½œç©ºé—´å¿…é¡»åˆ›å»ºåœ¨é¡¹ç›®çš„èµ„æºæ± å†…ã€‚ä¸€ä¸ªèµ„æºæ± ï¼ˆé¡¹ç›®åœ¨æŸé›†ç¾¤ä¸Šçš„é…é¢ï¼‰å¯ä»¥åŒ…å«å¤šä¸ªå·¥ä½œç©ºé—´ï¼Œæ‰€æœ‰å·¥ä½œç©ºé—´å…±äº«è¯¥èµ„æºæ± çš„é…é¢ä¸Šé™ã€‚

```
é¡¹ç›® (Project)
  â””â”€â”€ èµ„æºæ±  (é›†ç¾¤ A çš„é…é¢)
        â”œâ”€â”€ å·¥ä½œç©ºé—´ 1 (namespace-prod)
        â”œâ”€â”€ å·¥ä½œç©ºé—´ 2 (namespace-staging)
        â””â”€â”€ å·¥ä½œç©ºé—´ 3 (namespace-dev)
```

***

## å·¥ä½œç©ºé—´åˆ—è¡¨

**æ“ä½œè·¯å¾„**ï¼šé¡¹ç›®ä¸­å¿ƒ â†’ å·¥ä½œç©ºé—´

### é¡µé¢å¸ƒå±€

é¡µé¢é¡¶éƒ¨æä¾›ç­›é€‰å’Œæ“ä½œåŒºåŸŸï¼š

**é›†ç¾¤ç­›é€‰** é€šè¿‡ä¸‹æ‹‰æ¡†é€‰æ‹©è¦æŸ¥çœ‹çš„ç›®æ ‡é›†ç¾¤ï¼Œåˆ‡æ¢åæ˜¾ç¤ºè¯¥é›†ç¾¤ä¸‹å½“å‰é¡¹ç›®çš„æ‰€æœ‰å·¥ä½œç©ºé—´ã€‚

**é¡¹ç›®ä¸é›†ç¾¤ä¿¡æ¯** æ˜¾ç¤ºå½“å‰é¡¹ç›®åç§°ã€æ‰€é€‰é›†ç¾¤åç§°ï¼Œä»¥åŠèµ„æºæ± çš„æ•´ä½“ä½¿ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ã€å­˜å‚¨ä½¿ç”¨ç™¾åˆ†æ¯”ï¼‰ï¼Œä¾¿äºå¿«é€Ÿäº†è§£é…é¢æ¶ˆè€—çŠ¶æ€ã€‚

**è§†å›¾åˆ‡æ¢** é¡µé¢å³ä¸Šè§’æä¾›ã€Œå¡ç‰‡è§†å›¾ã€å’Œã€Œåˆ—è¡¨è§†å›¾ã€ä¸¤ç§å±•ç¤ºæ¨¡å¼ï¼Œå¯æ ¹æ®åå¥½é€‰æ‹©ã€‚

### å·¥ä½œç©ºé—´å¡ç‰‡

æ¯ä¸ªå·¥ä½œç©ºé—´ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºï¼ŒåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°ä¸æ ‡è¯†** æ˜¾ç¤ºå·¥ä½œç©ºé—´çš„æ˜¾ç¤ºåç§°å’Œå¯¹åº”çš„ Kubernetes Namespace åç§°ã€‚

**èµ„æºé…é¢** å±•ç¤ºè¯¥å·¥ä½œç©ºé—´åˆ†é…çš„èµ„æºé…é¢ï¼š

* **CPU**ï¼šåˆ†é…çš„ CPU æ ¸æ•°
* **å†…å­˜**ï¼šåˆ†é…çš„å†…å­˜å®¹é‡ï¼ˆGiBï¼‰
* **å­˜å‚¨**ï¼šåˆ†é…çš„ä¸´æ—¶å­˜å‚¨å®¹é‡ï¼ˆGiBï¼‰
* **GPU**ï¼šåˆ†é…çš„ GPU å¡æ•°
* **Pod**ï¼šå…è®¸åˆ›å»ºçš„ Pod æ•°é‡ä¸Šé™

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤ºå·¥ä½œç©ºé—´çš„åˆ›å»ºæ—¥æœŸã€‚

**çŠ¶æ€æŒ‡ç¤º** å¡ç‰‡åº•éƒ¨çš„çŠ¶æ€ç‚¹è¡¨ç¤ºå·¥ä½œç©ºé—´çš„å¥åº·çŠ¶æ€ã€‚

### æ“ä½œèœå•

ç‚¹å‡»å·¥ä½œç©ºé—´å¡ç‰‡å³ä¸Šè§’çš„æ›´å¤šæŒ‰é’®ï¼ˆâ‹¯ï¼‰ï¼Œå¯å±•å¼€æ“ä½œèœå•ï¼š

**æŸ¥çœ‹è¯¦æƒ…** è¿›å…¥å·¥ä½œç©ºé—´è¯¦æƒ…é¡µï¼ŒæŸ¥çœ‹å®Œæ•´çš„é…ç½®ä¿¡æ¯å’Œèµ„æºä½¿ç”¨æƒ…å†µã€‚

**ç›‘æ§** è·³è½¬åˆ°å·¥ä½œç©ºé—´ç›‘æ§é¢æ¿ï¼ŒæŸ¥çœ‹å®æ—¶èµ„æºä½¿ç”¨å’Œå†å²è¶‹åŠ¿ã€‚

**ç¼–è¾‘é…ç½®** ä¿®æ”¹å·¥ä½œç©ºé—´çš„èµ„æºé…é¢å’Œé™åˆ¶ç­–ç•¥ã€‚

**è¿ç§»ç©ºé—´** å°†å·¥ä½œç©ºé—´è¿ç§»åˆ°å…¶ä»–é¡¹ç›®ã€‚

**åˆ é™¤** åˆ é™¤å·¥ä½œç©ºé—´åŠå…¶å¯¹åº”çš„ Namespaceã€‚

***

## è¿ç§»å·¥ä½œç©ºé—´

è¿ç§»åŠŸèƒ½ç”¨äºå°†å·¥ä½œç©ºé—´ä»å½“å‰é¡¹ç›®è½¬ç§»åˆ°å…¶ä»–é¡¹ç›®ï¼Œè¿™æ˜¯ç®¡ç†è‡ªåŠ¨åŒæ­¥èµ„æºçš„å…³é”®æ“ä½œã€‚

### ä½¿ç”¨åœºæ™¯

**åœºæ™¯ä¸€ï¼šæ•´ç†è‡ªåŠ¨åŒæ­¥çš„èµ„æº** é›†ç¾¤åŒæ­¥åï¼Œå·²å­˜åœ¨çš„ Namespace ä¼šè¢«å½’å±åˆ°é»˜è®¤é¡¹ç›®ã€‚é€šè¿‡è¿ç§»åŠŸèƒ½ï¼Œå¯ä»¥å°†è¿™äº›å·¥ä½œç©ºé—´åˆ†é…åˆ°æ­£ç¡®çš„ä¸šåŠ¡é¡¹ç›®ä¸­ã€‚

**åœºæ™¯äºŒï¼šä¸šåŠ¡è°ƒæ•´** å½“ç»„ç»‡æ¶æ„è°ƒæ•´æˆ–ä¸šåŠ¡å½’å±å˜æ›´æ—¶ï¼Œå¯ä»¥å°†å·¥ä½œç©ºé—´è¿ç§»åˆ°æ–°çš„é¡¹ç›®ä¸‹ã€‚

**åœºæ™¯ä¸‰ï¼šèµ„æºé‡æ–°è§„åˆ’** åœ¨è¿›è¡Œèµ„æºæ± è°ƒæ•´æ—¶ï¼Œå¯èƒ½éœ€è¦å°†å·¥ä½œç©ºé—´è¿ç§»åˆ°é…é¢æ›´å……è¶³çš„é¡¹ç›®ã€‚

### è¿ç§»å‰ææ¡ä»¶

æ‰§è¡Œè¿ç§»æ“ä½œå‰ï¼Œè¯·ç¡®ä¿æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

**ç›®æ ‡é¡¹ç›®æ‹¥æœ‰å¯¹åº”é›†ç¾¤çš„èµ„æºæ± ** å·¥ä½œç©ºé—´åªèƒ½è¿ç§»åˆ°åœ¨åŒä¸€é›†ç¾¤ä¸Šæœ‰èµ„æºæ± çš„é¡¹ç›®ã€‚å¦‚æœç›®æ ‡é¡¹ç›®æ²¡æœ‰è¯¥é›†ç¾¤çš„èµ„æºæ± ï¼Œéœ€è¦å…ˆä¸ºç›®æ ‡é¡¹ç›®åˆ†é…èµ„æºã€‚

**ç›®æ ‡é¡¹ç›®èµ„æºé…é¢å……è¶³** ç›®æ ‡é¡¹ç›®çš„èµ„æºæ± å¿…é¡»æœ‰è¶³å¤Ÿçš„å‰©ä½™é…é¢æ¥å®¹çº³è¢«è¿ç§»çš„å·¥ä½œç©ºé—´ã€‚ç³»ç»Ÿä¼šåœ¨è¿ç§»æ—¶æ ¡éªŒé…é¢ï¼Œå¦‚æœé…é¢ä¸è¶³ï¼Œè¿ç§»å°†è¢«æ‹’ç»ã€‚

### è¿ç§»æ“ä½œæ­¥éª¤

**æ“ä½œè·¯å¾„**ï¼šå·¥ä½œç©ºé—´å¡ç‰‡ â†’ æ›´å¤šèœå•ï¼ˆâ‹¯ï¼‰â†’ è¿ç§»ç©ºé—´

1. åœ¨å¼¹å‡ºçš„ã€Œè¿ç§»å·¥ä½œç©ºé—´ã€å¯¹è¯æ¡†ä¸­ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºè¿ç§»è¯´æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»ã€‚

2. ç¡®è®¤ã€Œå½“å‰å·¥ä½œç©ºé—´ã€å’Œã€Œå½“å‰é¡¹ç›®ã€ä¿¡æ¯æ— è¯¯ã€‚

3. åœ¨ã€Œç›®æ ‡é¡¹ç›®ã€ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©è¦è¿ç§»åˆ°çš„ç›®æ ‡é¡¹ç›®ã€‚ä¸‹æ‹‰åˆ—è¡¨åªä¼šæ˜¾ç¤ºåœ¨å½“å‰é›†ç¾¤ä¸Šæœ‰èµ„æºæ± çš„é¡¹ç›®ã€‚

4. ç‚¹å‡»ã€Œç¡®è®¤è¿ç§»ã€æŒ‰é’®å®Œæˆæ“ä½œã€‚

### è¿ç§»è¯´æ˜

> \[!IMPORTANT] è¿ç§»æ³¨æ„äº‹é¡¹
>
> * å·¥ä½œç©ºé—´å°†ä»å½“å‰é¡¹ç›®è¿ç§»åˆ°ç›®æ ‡é¡¹ç›®
> * è¿ç§»è¿‡ç¨‹ä¸­ä¼šæ›´æ–°æ‰€æœ‰ç›¸å…³èµ„æºé…é¢
> * è¯·ç¡®ä¿ç›®æ ‡é¡¹ç›®æœ‰è¶³å¤Ÿçš„èµ„æºé…é¢
> * è¿ç§»æ“ä½œä¸å¯æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œ

### è¿ç§»åŸç†

è¿ç§»æ“ä½œæ˜¯çº¯å¹³å°å±‚çš„é€»è¾‘å¤„ç†ï¼Œä¸ä¼šå¯¹ Kubernetes é›†ç¾¤äº§ç”Ÿä»»ä½•å½±å“ã€‚å…·ä½“æ¥è¯´ï¼š

**ä¸å˜çš„å†…å®¹** Kubernetes é›†ç¾¤ä¸­çš„ Namespace åŠå…¶å†…éƒ¨çš„æ‰€æœ‰èµ„æºï¼ˆPodã€Deploymentã€Service ç­‰ï¼‰ä¿æŒä¸å˜ï¼Œå·¥ä½œè´Ÿè½½ä¸ä¼šä¸­æ–­ã€‚

**å˜æ›´çš„å†…å®¹** å¹³å°æ•°æ®åº“ä¸­å·¥ä½œç©ºé—´ä¸é¡¹ç›®çš„å…³è”å…³ç³»ä¼šè¢«æ›´æ–°ï¼Œèµ„æºé…é¢çš„å½’å±ä¼šä»æºé¡¹ç›®è½¬ç§»åˆ°ç›®æ ‡é¡¹ç›®ã€‚

è¿™ç§è®¾è®¡ç¡®ä¿äº†è¿ç§»æ“ä½œçš„å®‰å…¨æ€§ï¼Œå³ä½¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ‰§è¡Œè¿ç§»ï¼Œä¹Ÿä¸ä¼šå½±å“æ­£åœ¨è¿è¡Œçš„ä¸šåŠ¡ã€‚

***

## åˆ›å»ºå·¥ä½œç©ºé—´

åˆ›å»ºå·¥ä½œç©ºé—´çš„æµç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šåŸºç¡€ä¿¡æ¯ â†’ èµ„æºé…é¢ â†’ é™åˆ¶ç­–ç•¥ â†’ ç¡®è®¤ä¿¡æ¯ã€‚

**æ“ä½œè·¯å¾„**ï¼šé¡¹ç›®ä¸­å¿ƒ â†’ å·¥ä½œç©ºé—´ â†’ ç‚¹å‡»å³ä¸Šè§’ã€Œ+ã€æŒ‰é’®

### åˆ›å»ºå‰ææ¡ä»¶

è¦åœ¨æŸä¸ªé›†ç¾¤ä¸Šåˆ›å»ºå·¥ä½œç©ºé—´ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

**é¡¹ç›®å·²åˆ†é…è¯¥é›†ç¾¤çš„èµ„æºæ± ** é¡¹ç›®å¿…é¡»æ‹¥æœ‰ç›®æ ‡é›†ç¾¤çš„èµ„æºé…é¢ï¼Œæ‰èƒ½åœ¨è¯¥é›†ç¾¤ä¸Šåˆ›å»ºå·¥ä½œç©ºé—´ã€‚

**èµ„æºé…é¢å……è¶³** èµ„æºæ± ä¸­éœ€æœ‰è¶³å¤Ÿçš„å‰©ä½™é…é¢æ¥æ»¡è¶³æ–°å·¥ä½œç©ºé—´çš„èµ„æºéœ€æ±‚ã€‚

**ç”¨æˆ·æƒé™** æ“ä½œç”¨æˆ·éœ€å…·æœ‰é¡¹ç›®ç®¡ç†å‘˜æƒé™æˆ–å·¥ä½œç©ºé—´åˆ›å»ºæƒé™ã€‚

### æ­¥éª¤ä¸€ï¼šåŸºç¡€ä¿¡æ¯ï¼ˆå¿…å¡«ï¼‰

é…ç½®å·¥ä½œç©ºé—´çš„åŸºæœ¬æ ‡è¯†ä¿¡æ¯ã€‚

**å·¥ä½œç©ºé—´åç§°**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥å·¥ä½œç©ºé—´çš„æ˜¾ç¤ºåç§°ï¼Œç”¨äºåœ¨å¹³å°ä¸­æ ‡è¯†å’Œç®¡ç†ã€‚æ”¯æŒä¸­è‹±æ–‡ï¼Œæœ€å¤š 100 å­—ç¬¦ã€‚ä¾‹å¦‚ï¼š`å¼€å‘ç¯å¢ƒ`ã€`ç”Ÿäº§ç¯å¢ƒ`ã€`æµ‹è¯•ç¯å¢ƒ` ç­‰ã€‚

**å‘½åç©ºé—´**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥å¯¹åº”çš„ Kubernetes Namespace åç§°ã€‚å‘½åè§„åˆ™å¦‚ä¸‹ï¼š

* å¿…é¡»ä»¥å°å†™å­—æ¯å¼€å¤´
* åªèƒ½åŒ…å«å°å†™å­—æ¯ï¼ˆa-zï¼‰å’Œè¿å­—ç¬¦ï¼ˆ-ï¼‰
* å¿…é¡»ä»¥å­—æ¯ç»“å°¾
* ä¾‹å¦‚ï¼š`dev-namespace`ã€`prod-env`ã€`app-staging`

**æè¿°ä¿¡æ¯**ï¼ˆå¯é€‰ï¼‰ï¼šè¯¦ç»†æè¿°å·¥ä½œç©ºé—´çš„ç”¨é€”ã€è´Ÿè´£äººã€ç›¸å…³é¡¹ç›®ç­‰ä¿¡æ¯ï¼Œæœ€å¤š 500 å­—ç¬¦ã€‚

å¡«å†™å®Œæˆåï¼Œç‚¹å‡»ã€Œä¸‹ä¸€æ­¥ã€è¿›å…¥èµ„æºé…é¢é…ç½®ã€‚

### æ­¥éª¤äºŒï¼šèµ„æºé…é¢ï¼ˆå¿…å¡«ï¼‰

èµ„æºé…é¢é…ç½®å†³å®šäº†å·¥ä½œç©ºé—´å¯ä½¿ç”¨çš„èµ„æºä¸Šé™ï¼Œæ˜¯åˆ›å»ºå·¥ä½œç©ºé—´çš„æ ¸å¿ƒæ­¥éª¤ã€‚

#### é›†ç¾¤èµ„æºæ¦‚è§ˆ

é¡µé¢é¡¶éƒ¨çš„ã€Œé›†ç¾¤èµ„æºæ¦‚è§ˆã€åŒºåŸŸå®æ—¶æ˜¾ç¤ºå½“å‰èµ„æºæ± çš„é…é¢ä½¿ç”¨æƒ…å†µï¼Œå¸®åŠ©æ‚¨äº†è§£å¯åˆ†é…ç©ºé—´ï¼š

* **CPU**ï¼šå·²ä½¿ç”¨/æ€»é…é¢ï¼ˆæ ¸ï¼‰ï¼Œè¿›åº¦æ¡æ˜¾ç¤ºä½¿ç”¨æ¯”ä¾‹
* **å†…å­˜**ï¼šå·²ä½¿ç”¨/æ€»é…é¢ï¼ˆGiBï¼‰
* **å­˜å‚¨**ï¼šå·²ä½¿ç”¨/æ€»é…é¢ï¼ˆGiBï¼‰
* **Pods**ï¼šå·²ä½¿ç”¨/æ€»é…é¢ï¼ˆä¸ªï¼‰
* **GPU**ï¼šå·²ä½¿ç”¨/æ€»é…é¢ï¼ˆæ ¸ï¼‰

è¿›åº¦æ¡é¢œè‰²æŒ‡ç¤ºé…é¢çŠ¶æ€ï¼šç»¿è‰²è¡¨ç¤ºå……è¶³ï¼Œé»„è‰²è¡¨ç¤ºç´§å¼ ï¼Œçº¢è‰²è¡¨ç¤ºå³å°†è€—å°½ã€‚

#### åŸºç¡€èµ„æºé…ç½®

è®¾ç½®å·¥ä½œç©ºé—´çš„è®¡ç®—å’Œå­˜å‚¨èµ„æºé…é¢ï¼š

**CPU é…é¢**ï¼ˆå¿…å¡«ï¼‰ï¼šè®¾ç½®å·¥ä½œç©ºé—´å¯ä½¿ç”¨çš„ CPU æ ¸æ•°ä¸Šé™ã€‚è¾“å…¥æ¡†ä¸‹æ–¹æ˜¾ç¤ºèµ„æºæ± çš„å¯ç”¨ä½™é‡ã€‚å•ä½å¯é€‰æ‹©ã€Œæ ¸ã€æˆ–ã€Œæ¯«æ ¸ã€ã€‚

**å†…å­˜é…é¢**ï¼ˆå¿…å¡«ï¼‰ï¼šè®¾ç½®å·¥ä½œç©ºé—´å¯ä½¿ç”¨çš„å†…å­˜ä¸Šé™ã€‚å•ä½å¯é€‰æ‹© Giï¼ˆGiBï¼‰ã€Miï¼ˆMiBï¼‰ç­‰ã€‚

**å­˜å‚¨é…é¢**ï¼ˆå¯é€‰ï¼‰ï¼šè®¾ç½®ä¸´æ—¶å­˜å‚¨ï¼ˆephemeral-storageï¼‰çš„é…é¢ä¸Šé™ã€‚

**GPU é…é¢**ï¼ˆå¯é€‰ï¼‰ï¼šè®¾ç½®å·¥ä½œç©ºé—´å¯ä½¿ç”¨çš„ GPU å¡æ•°ã€‚å¦‚æœèµ„æºæ± æ²¡æœ‰ GPU é…é¢ï¼Œæ­¤é¡¹å°†æ˜¾ç¤ºå¯ç”¨ä¸º 0ã€‚

#### å¯¹è±¡èµ„æºé™åˆ¶

è®¾ç½®å„ç±» Kubernetes èµ„æºå¯¹è±¡çš„æ•°é‡é™åˆ¶ï¼Œé˜²æ­¢å•ä¸ªå·¥ä½œç©ºé—´åˆ›å»ºè¿‡å¤šèµ„æºå¯¹è±¡ã€‚

**å·¥ä½œè´Ÿè½½ç±»**

* **Pod æ•°é‡**ï¼ˆå¿…å¡«ï¼‰ï¼šå·¥ä½œç©ºé—´å†…å…è®¸åˆ›å»ºçš„ Pod æ€»æ•°ä¸Šé™
* **Deployment**ï¼šéƒ¨ç½²æ•°é‡é™åˆ¶
* **StatefulSet**ï¼šæœ‰çŠ¶æ€é›†æ•°é‡é™åˆ¶
* **DaemonSet**ï¼šå®ˆæŠ¤è¿›ç¨‹é›†æ•°é‡é™åˆ¶
* **Job**ï¼šä»»åŠ¡æ•°é‡é™åˆ¶
* **CronJob**ï¼šå®šæ—¶ä»»åŠ¡æ•°é‡é™åˆ¶

**ç½‘ç»œèµ„æºç±»**

* **Service**ï¼šæœåŠ¡æ•°é‡é™åˆ¶
* **Ingress**ï¼šå…¥å£èµ„æºæ•°é‡é™åˆ¶
* **LoadBalancer**ï¼šè´Ÿè½½å‡è¡¡å™¨æ•°é‡é™åˆ¶
* **NodePort**ï¼šNodePort æœåŠ¡æ•°é‡é™åˆ¶

**é…ç½®ä¸å­˜å‚¨ç±»**

* **ConfigMap**ï¼šé…ç½®æ˜ å°„æ•°é‡é™åˆ¶
* **Secret**ï¼šå¯†é’¥æ•°é‡é™åˆ¶
* **PVC**ï¼šæŒä¹…åŒ–å­˜å‚¨å·å£°æ˜æ•°é‡é™åˆ¶
* **ä¸´æ—¶å­˜å‚¨**ï¼šä¸´æ—¶å­˜å‚¨æ€»å®¹é‡é™åˆ¶

æ¯ä¸ªè¾“å…¥æ¡†ä¸‹æ–¹ä¼šæ˜¾ç¤ºèµ„æºæ± çš„å¯ç”¨ä½™é‡ï¼Œå¸®åŠ©æ‚¨åˆç†åˆ†é…èµ„æºã€‚

### æ­¥éª¤ä¸‰ï¼šé™åˆ¶ç­–ç•¥ï¼ˆé€‰å¡«ï¼‰

é™åˆ¶ç­–ç•¥ç”¨äºè®¾ç½® Pod å’Œå®¹å™¨çº§åˆ«çš„èµ„æºè¾¹ç•Œï¼Œé€šè¿‡ Kubernetes LimitRange æœºåˆ¶å®ç°ã€‚è¿™ä¸€æ­¥éª¤æ˜¯å¯é€‰çš„ï¼Œä½†å»ºè®®é…ç½®ä»¥ç¡®ä¿èµ„æºä½¿ç”¨çš„å¯æ§æ€§ã€‚

#### Pod çº§åˆ«é™åˆ¶

è®¾ç½®å•ä¸ª Pod å¯ç”³è¯·çš„èµ„æºèŒƒå›´ï¼š

**Pod æœ€å¤§ CPU**ï¼šå•ä¸ª Pod å¯ä½¿ç”¨çš„æœ€å¤§ CPU æ ¸æ•°ã€‚ä¾‹å¦‚è®¾ç½®ä¸º 8 æ ¸ï¼Œåˆ™ä»»ä½• Pod çš„ CPU limits ä¸èƒ½è¶…è¿‡ 8 æ ¸ã€‚

**Pod æœ€å¤§å†…å­˜**ï¼šå•ä¸ª Pod å¯ä½¿ç”¨çš„æœ€å¤§å†…å­˜ã€‚ä¾‹å¦‚è®¾ç½®ä¸º 16 GiBã€‚

**Pod æœ€å¤§ä¸´æ—¶å­˜å‚¨**ï¼šå•ä¸ª Pod å¯ä½¿ç”¨çš„æœ€å¤§ä¸´æ—¶å­˜å‚¨å®¹é‡ã€‚

**Pod æœ€å° CPU**ï¼šPod å¿…é¡»è¯·æ±‚çš„æœ€å° CPU é‡ã€‚ä¾‹å¦‚è®¾ç½®ä¸º 10 æ¯«æ ¸ï¼Œåˆ™æ‰€æœ‰ Pod çš„ CPU requests è‡³å°‘ä¸º 10mã€‚

**Pod æœ€å°å†…å­˜**ï¼šPod å¿…é¡»è¯·æ±‚çš„æœ€å°å†…å­˜é‡ã€‚

**Pod æœ€å°ä¸´æ—¶å­˜å‚¨**ï¼šPod å¿…é¡»è¯·æ±‚çš„æœ€å°ä¸´æ—¶å­˜å‚¨é‡ã€‚

#### å®¹å™¨çº§åˆ«é™åˆ¶

è®¾ç½®å•ä¸ªå®¹å™¨å¯ç”³è¯·çš„èµ„æºèŒƒå›´ï¼š

**å®¹å™¨æœ€å¤§ CPU**ï¼šå•ä¸ªå®¹å™¨å¯ä½¿ç”¨çš„æœ€å¤§ CPUã€‚ä¾‹å¦‚è®¾ç½®ä¸º 4 æ ¸ã€‚

**å®¹å™¨æœ€å¤§å†…å­˜**ï¼šå•ä¸ªå®¹å™¨å¯ä½¿ç”¨çš„æœ€å¤§å†…å­˜ã€‚ä¾‹å¦‚è®¾ç½®ä¸º 8 GiBã€‚

**å®¹å™¨æœ€å¤§ä¸´æ—¶å­˜å‚¨**ï¼šå•ä¸ªå®¹å™¨å¯ä½¿ç”¨çš„æœ€å¤§ä¸´æ—¶å­˜å‚¨ã€‚

**å®¹å™¨æœ€å° CPU**ï¼šå®¹å™¨å¿…é¡»è¯·æ±‚çš„æœ€å° CPUã€‚ä¾‹å¦‚è®¾ç½®ä¸º 10 æ¯«æ ¸ã€‚

**å®¹å™¨æœ€å°å†…å­˜**ï¼šå®¹å™¨å¿…é¡»è¯·æ±‚çš„æœ€å°å†…å­˜ã€‚ä¾‹å¦‚è®¾ç½®ä¸º 64 MiBã€‚

**å®¹å™¨æœ€å°ä¸´æ—¶å­˜å‚¨**ï¼šå®¹å™¨å¿…é¡»è¯·æ±‚çš„æœ€å°ä¸´æ—¶å­˜å‚¨ã€‚

#### å®¹å™¨é»˜è®¤èµ„æº

å½“ Pod æˆ–å®¹å™¨æœªæŒ‡å®šèµ„æºè¯·æ±‚å’Œé™åˆ¶æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åº”ç”¨è¿™äº›é»˜è®¤å€¼ï¼š

**é»˜è®¤ CPU é™åˆ¶**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤ CPU limitã€‚ä¾‹å¦‚è®¾ç½®ä¸º 1 æ ¸ã€‚

**é»˜è®¤å†…å­˜é™åˆ¶**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤å†…å­˜ limitã€‚ä¾‹å¦‚è®¾ç½®ä¸º 1 GiBã€‚

**é»˜è®¤ä¸´æ—¶å­˜å‚¨é™åˆ¶**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤ä¸´æ—¶å­˜å‚¨ limitã€‚

**é»˜è®¤ CPU è¯·æ±‚**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤ CPU requestã€‚ä¾‹å¦‚è®¾ç½®ä¸º 10 æ¯«æ ¸ã€‚

**é»˜è®¤å†…å­˜è¯·æ±‚**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤å†…å­˜ requestã€‚ä¾‹å¦‚è®¾ç½®ä¸º 100 MiBã€‚

**é»˜è®¤ä¸´æ—¶å­˜å‚¨è¯·æ±‚**ï¼šæœªæŒ‡å®šæ—¶çš„é»˜è®¤ä¸´æ—¶å­˜å‚¨ requestã€‚

> \[!TIP] é™åˆ¶ç­–ç•¥çš„ä½œç”¨
> é…ç½®é™åˆ¶ç­–ç•¥å¯ä»¥é˜²æ­¢ä»¥ä¸‹é—®é¢˜ï¼š
>
> * å•ä¸ª Pod/å®¹å™¨ç”³è¯·è¿‡å¤šèµ„æºï¼Œå½±å“å…¶ä»–å·¥ä½œè´Ÿè½½
> * å¼€å‘è€…å¿˜è®°è®¾ç½®èµ„æºè¯·æ±‚ï¼Œå¯¼è‡´è°ƒåº¦é—®é¢˜
> * èµ„æºä½¿ç”¨æ— çº¦æŸï¼Œéš¾ä»¥è¿›è¡Œå®¹é‡è§„åˆ’

### æ­¥éª¤å››ï¼šç¡®è®¤ä¿¡æ¯

ç¡®è®¤æ‰€æœ‰é…ç½®ä¿¡æ¯æ— è¯¯åï¼Œç‚¹å‡»ã€Œåˆ›å»ºã€æŒ‰é’®å®Œæˆå·¥ä½œç©ºé—´åˆ›å»ºã€‚

åˆ›å»ºæˆåŠŸåï¼š

* Kubernetes é›†ç¾¤ä¸­ä¼šåˆ›å»ºå¯¹åº”çš„ Namespace
* ResourceQuota èµ„æºä¼šè¢«è‡ªåŠ¨åˆ›å»ºå¹¶åº”ç”¨é…é¢é™åˆ¶
* LimitRange èµ„æºä¼šè¢«è‡ªåŠ¨åˆ›å»ºå¹¶åº”ç”¨é™åˆ¶ç­–ç•¥ï¼ˆå¦‚æœé…ç½®äº†ï¼‰
* å·¥ä½œç©ºé—´ä¼šå‡ºç°åœ¨å·¥ä½œç©ºé—´åˆ—è¡¨ä¸­

***

## å·¥ä½œç©ºé—´ç›‘æ§

å·¥ä½œç©ºé—´ç›‘æ§æä¾›å¯¹ Namespace çº§åˆ«èµ„æºä½¿ç”¨çš„å®æ—¶ç›‘æ§å’Œå†å²åˆ†æã€‚

**æ“ä½œè·¯å¾„**ï¼šå·¥ä½œç©ºé—´å¡ç‰‡ â†’ æ›´å¤šèœå•ï¼ˆâ‹¯ï¼‰â†’ ç›‘æ§

### ç›‘æ§é¢æ¿æ¦‚è§ˆ

ç›‘æ§é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºå·¥ä½œç©ºé—´çš„åŸºæœ¬çŠ¶æ€ä¿¡æ¯ï¼š

**çŠ¶æ€æ ‡è¯†** æ˜¾ç¤ºå·¥ä½œç©ºé—´çš„è¿è¡ŒçŠ¶æ€ï¼ˆActive/Inactiveï¼‰ã€‚

**å¥åº·åˆ†æ•°** åŸºäºèµ„æºä½¿ç”¨ã€Pod çŠ¶æ€ç­‰å¤šç»´åº¦æŒ‡æ ‡è®¡ç®—çš„å¥åº·è¯„åˆ†ï¼ˆæ»¡åˆ† 100ï¼‰ã€‚

**å½“å‰æ—¶é—´** æ˜¾ç¤ºç›‘æ§æ•°æ®çš„é‡‡é›†æ—¶é—´ã€‚

### ç›‘æ§è§†å›¾

ç›‘æ§é¡µé¢æä¾›å››ä¸ªç»´åº¦çš„ç›‘æ§è§†å›¾ï¼Œé€šè¿‡æ ‡ç­¾é¡µåˆ‡æ¢ï¼š

#### èµ„æºç›‘æ§

å±•ç¤ºå·¥ä½œç©ºé—´çš„æ ¸å¿ƒèµ„æºä½¿ç”¨æƒ…å†µï¼š

**CPU ä½¿ç”¨ç‡** æ˜¾ç¤º CPU çš„å®æ—¶ä½¿ç”¨ç™¾åˆ†æ¯”å’Œè´Ÿè½½æƒ…å†µï¼ˆLoadï¼‰ã€‚

**å†…å­˜ä½¿ç”¨** æ˜¾ç¤ºå†…å­˜ä½¿ç”¨ç™¾åˆ†æ¯”å’Œå…·ä½“ç”¨é‡ï¼ˆå·²ç”¨/æ€»é‡ï¼‰ã€‚

**ç£ç›˜ä½¿ç”¨** æ˜¾ç¤ºå­˜å‚¨èµ„æºçš„ä½¿ç”¨ç™¾åˆ†æ¯”ã€‚

**ç½‘ç»œæµé‡** æ˜¾ç¤ºå…¥ç«™ï¼ˆæ¥æ”¶ï¼‰å’Œå‡ºç«™ï¼ˆå‘é€ï¼‰çš„ç½‘ç»œæµé‡é€Ÿç‡ã€‚

**Pod çŠ¶æ€** æ˜¾ç¤º Pod æ€»æ•°å’Œæ­£åœ¨è¿è¡Œçš„ Pod æ•°é‡ã€‚

é¡µé¢ä¸‹æ–¹æä¾›èµ„æºä½¿ç”¨è¶‹åŠ¿å›¾ï¼Œå±•ç¤º CPUã€å†…å­˜ç­‰æŒ‡æ ‡çš„å†å²å˜åŒ–ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰å€¼ã€ä½¿ç”¨ç‡ã€å¹³å‡å€¼å’Œå³°å€¼ã€‚

#### é…é¢ç›‘æ§

å±•ç¤º ResourceQuota çš„é…é¢ä½¿ç”¨æƒ…å†µï¼Œå¸®åŠ©äº†è§£å„ç±»èµ„æºçš„æ¶ˆè€—ç¨‹åº¦å’Œå‰©ä½™ç©ºé—´ã€‚

#### æŒ‡æ ‡ç›‘æ§

å±•ç¤ºæ›´è¯¦ç»†çš„ Prometheus æŒ‡æ ‡æ•°æ®ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰æŒ‡æ ‡å’Œç³»ç»ŸæŒ‡æ ‡ã€‚

#### Pod èµ„æº Top æ¦œ

æŒ‰èµ„æºæ¶ˆè€—æ’åºå±•ç¤ºå·¥ä½œç©ºé—´å†…çš„ Pod åˆ—è¡¨ï¼Œå¸®åŠ©å¿«é€Ÿå®šä½èµ„æºæ¶ˆè€—å¤§æˆ·ã€‚å¯ä»¥æŒ‰ CPUã€å†…å­˜ç­‰ç»´åº¦æ’åºã€‚

### ç›‘æ§æ“ä½œ

**æ—¶é—´èŒƒå›´** é€šè¿‡ä¸‹æ‹‰æ¡†é€‰æ‹©æŸ¥è¯¢çš„æ—¶é—´èŒƒå›´ï¼Œå¦‚æœ€è¿‘ 30 åˆ†é’Ÿã€1 å°æ—¶ã€6 å°æ—¶ã€24 å°æ—¶ç­‰ã€‚

**è‡ªåŠ¨åˆ·æ–°** å¼€å¯åç›‘æ§æ•°æ®ä¼šå®šæ—¶è‡ªåŠ¨åˆ·æ–°ã€‚

**æ‰‹åŠ¨åˆ·æ–°** ç‚¹å‡»ã€Œåˆ·æ–°æ•°æ®ã€æŒ‰é’®ç«‹å³è·å–æœ€æ–°æ•°æ®ã€‚

**æ•°æ®å¯¼å‡º** ç‚¹å‡»ã€Œå¯¼å‡ºã€æŒ‰é’®å¯å°†ç›‘æ§æ•°æ®å¯¼å‡ºä¸ºæ–‡ä»¶ã€‚

***

## ç¼–è¾‘å·¥ä½œç©ºé—´

ç¼–è¾‘åŠŸèƒ½ç”¨äºä¿®æ”¹å·²åˆ›å»ºå·¥ä½œç©ºé—´çš„é…ç½®ã€‚

**æ“ä½œè·¯å¾„**ï¼šå·¥ä½œç©ºé—´å¡ç‰‡ â†’ æ›´å¤šèœå•ï¼ˆâ‹¯ï¼‰â†’ ç¼–è¾‘é…ç½®

### å¯ç¼–è¾‘å†…å®¹

**åŸºç¡€ä¿¡æ¯** å¯ä¿®æ”¹å·¥ä½œç©ºé—´åç§°å’Œæè¿°ä¿¡æ¯ã€‚æ³¨æ„ï¼šNamespace åç§°åˆ›å»ºåä¸å¯ä¿®æ”¹ã€‚

**èµ„æºé…é¢** å¯è°ƒæ•´ CPUã€å†…å­˜ã€å­˜å‚¨ã€GPUã€Pod ç­‰èµ„æºçš„é…é¢é™åˆ¶ã€‚

**å¯¹è±¡èµ„æºé™åˆ¶** å¯è°ƒæ•´å„ç±» Kubernetes èµ„æºå¯¹è±¡çš„æ•°é‡é™åˆ¶ã€‚

**é™åˆ¶ç­–ç•¥** å¯ä¿®æ”¹ Pod çº§åˆ«ã€å®¹å™¨çº§åˆ«çš„èµ„æºé™åˆ¶å’Œé»˜è®¤å€¼ã€‚

### ç¼–è¾‘æ³¨æ„äº‹é¡¹

**é…é¢å¢åŠ ** å¢åŠ é…é¢æ—¶ï¼Œéœ€è¦ç¡®ä¿èµ„æºæ± æœ‰è¶³å¤Ÿçš„å‰©ä½™é…é¢ã€‚

**é…é¢å‡å°‘** å‡å°‘é…é¢æ—¶ï¼Œå¦‚æœæ–°é…é¢å°äºå½“å‰å·²ä½¿ç”¨é‡ï¼Œä¿®æ”¹å°†è¢«æ‹’ç»ã€‚éœ€è¦å…ˆæ¸…ç†èµ„æºä½¿ç”¨åå†é™ä½é…é¢ã€‚

**é™åˆ¶ç­–ç•¥å˜æ›´** ä¿®æ”¹é™åˆ¶ç­–ç•¥åï¼Œå·²å­˜åœ¨çš„ Pod ä¸å—å½±å“ï¼Œåªå¯¹æ–°åˆ›å»ºçš„ Pod ç”Ÿæ•ˆã€‚

***

## åˆ é™¤å·¥ä½œç©ºé—´

åˆ é™¤åŠŸèƒ½ç”¨äºç§»é™¤ä¸å†éœ€è¦çš„å·¥ä½œç©ºé—´ã€‚

**æ“ä½œè·¯å¾„**ï¼šå·¥ä½œç©ºé—´å¡ç‰‡ â†’ æ›´å¤šèœå•ï¼ˆâ‹¯ï¼‰â†’ åˆ é™¤

### åˆ é™¤å½±å“

åˆ é™¤å·¥ä½œç©ºé—´æ˜¯ä¸€ä¸ªå±é™©æ“ä½œï¼Œä¼šäº§ç”Ÿä»¥ä¸‹å½±å“ï¼š

**Kubernetes èµ„æºåˆ é™¤** å¯¹åº”çš„ Namespace ä¼šè¢«åˆ é™¤ï¼ŒNamespace å†…çš„æ‰€æœ‰èµ„æºï¼ˆPodã€Deploymentã€Serviceã€ConfigMapã€Secretã€PVC ç­‰ï¼‰éƒ½ä¼šè¢«çº§è”åˆ é™¤ã€‚

**æ•°æ®ä¸¢å¤±** å­˜å‚¨åœ¨ PVC ä¸­çš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ï¼ˆå–å†³äºå­˜å‚¨ç±»çš„å›æ”¶ç­–ç•¥ï¼‰ã€‚

**é…é¢é‡Šæ”¾** å·¥ä½œç©ºé—´å ç”¨çš„èµ„æºé…é¢ä¼šè¢«é‡Šæ”¾å›èµ„æºæ± ã€‚

### åˆ é™¤å‰æ£€æŸ¥

æ‰§è¡Œåˆ é™¤å‰ï¼Œå»ºè®®è¿›è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

1. ç¡®è®¤å·¥ä½œç©ºé—´å†…æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„é‡è¦ä¸šåŠ¡
2. å¤‡ä»½éœ€è¦ä¿ç•™çš„é…ç½®å’Œæ•°æ®
3. é€šçŸ¥ç›¸å…³çš„å¼€å‘å’Œè¿ç»´äººå‘˜
4. ç¡®è®¤ PVC æ•°æ®çš„å¤„ç†æ–¹å¼

### åˆ é™¤ç¡®è®¤

ç³»ç»Ÿä¼šè¦æ±‚äºŒæ¬¡ç¡®è®¤åˆ é™¤æ“ä½œï¼Œé˜²æ­¢è¯¯åˆ ã€‚è¯·ä»”ç»†é˜…è¯»ç¡®è®¤æç¤ºï¼Œç¡®ä¿äº†è§£åˆ é™¤çš„å½±å“åå†æ‰§è¡Œã€‚

***

## æœ€ä½³å®è·µ

### å·¥ä½œç©ºé—´è§„åˆ’å»ºè®®

**æŒ‰ç¯å¢ƒåˆ’åˆ†** å»ºè®®æŒ‰å¼€å‘ã€æµ‹è¯•ã€é¢„å‘å¸ƒã€ç”Ÿäº§ç­‰ç¯å¢ƒåˆ›å»ºç‹¬ç«‹çš„å·¥ä½œç©ºé—´ï¼Œå®ç°ç¯å¢ƒéš”ç¦»ã€‚

**å‘½åè§„èŒƒ** å»ºç«‹ç»Ÿä¸€çš„ Namespace å‘½åè§„èŒƒï¼Œä¾‹å¦‚ï¼š`{é¡¹ç›®ç®€ç§°}-{ç¯å¢ƒ}-{ç”¨é€”}`ï¼Œå¦‚ `app-prod-api`ã€`app-dev-frontend`ã€‚

**èµ„æºé…é¢é¢„ä¼°** æ ¹æ®åº”ç”¨çš„èµ„æºéœ€æ±‚åˆç†è®¾ç½®é…é¢ï¼Œé¿å…è¿‡åº¦åˆ†é…æˆ–é…é¢ä¸è¶³ã€‚

### é™åˆ¶ç­–ç•¥é…ç½®å»ºè®®

**è®¾ç½®åˆç†çš„é»˜è®¤å€¼** ä¸ºå®¹å™¨è®¾ç½®åˆç†çš„é»˜è®¤èµ„æºè¯·æ±‚å’Œé™åˆ¶ï¼Œé¿å…å¼€å‘è€…å¿˜è®°é…ç½®å¯¼è‡´çš„é—®é¢˜ã€‚

**é˜²æ­¢èµ„æºæ»¥ç”¨** é€šè¿‡ Pod å’Œå®¹å™¨çš„æœ€å¤§é™åˆ¶ï¼Œé˜²æ­¢å•ä¸ªå·¥ä½œè´Ÿè½½å ç”¨è¿‡å¤šèµ„æºã€‚

**ä¿è¯åŸºæœ¬èµ„æº** é€šè¿‡æœ€å°èµ„æºé™åˆ¶ï¼Œç¡®ä¿æ¯ä¸ª Pod/å®¹å™¨éƒ½æœ‰åŸºæœ¬çš„è¿è¡Œèµ„æºã€‚

### è¿ç§»æ“ä½œå»ºè®®

**æ‰¹é‡è§„åˆ’** å¯¹äºå¤§é‡éœ€è¦è¿ç§»çš„å·¥ä½œç©ºé—´ï¼Œå»ºè®®å…ˆåˆ¶å®šè¿ç§»è®¡åˆ’ï¼Œæ˜ç¡®æ¯ä¸ªå·¥ä½œç©ºé—´çš„ç›®æ ‡é¡¹ç›®ã€‚

**é…é¢æ£€æŸ¥** è¿ç§»å‰æ£€æŸ¥ç›®æ ‡é¡¹ç›®çš„é…é¢æ˜¯å¦å……è¶³ï¼Œé¿å…è¿ç§»å¤±è´¥ã€‚

**éé«˜å³°æœŸæ“ä½œ** è™½ç„¶è¿ç§»ä¸å½±å“é›†ç¾¤ï¼Œä½†å»ºè®®åœ¨éä¸šåŠ¡é«˜å³°æœŸæ‰§è¡Œï¼Œä¾¿äºè§‚å¯Ÿå’Œå¤„ç†å¯èƒ½çš„é—®é¢˜ã€‚

***

## å¸¸è§é—®é¢˜

### ä¸ºä»€ä¹ˆåˆ›å»ºå·¥ä½œç©ºé—´å¤±è´¥ï¼Ÿ

**å¯èƒ½åŸå›  1**ï¼šèµ„æºæ± é…é¢ä¸è¶³ã€‚æ£€æŸ¥èµ„æºæ± çš„å‰©ä½™é…é¢æ˜¯å¦æ»¡è¶³æ–°å·¥ä½œç©ºé—´çš„éœ€æ±‚ã€‚

**å¯èƒ½åŸå›  2**ï¼šNamespace åç§°å†²çªã€‚æ£€æŸ¥é›†ç¾¤ä¸­æ˜¯å¦å·²å­˜åœ¨åŒåçš„ Namespaceã€‚

**å¯èƒ½åŸå›  3**ï¼šNamespace å‘½åä¸ç¬¦åˆè§„èŒƒã€‚ç¡®ä¿åç§°ä»¥å°å†™å­—æ¯å¼€å¤´ï¼ŒåªåŒ…å«å°å†™å­—æ¯å’Œè¿å­—ç¬¦ï¼Œä»¥å­—æ¯ç»“å°¾ã€‚

### ä¸ºä»€ä¹ˆæ— æ³•è¿ç§»å·¥ä½œç©ºé—´ï¼Ÿ

**å¯èƒ½åŸå›  1**ï¼šç›®æ ‡é¡¹ç›®æ²¡æœ‰å¯¹åº”é›†ç¾¤çš„èµ„æºæ± ã€‚éœ€è¦å…ˆä¸ºç›®æ ‡é¡¹ç›®åˆ†é…è¯¥é›†ç¾¤çš„èµ„æºã€‚

**å¯èƒ½åŸå›  2**ï¼šç›®æ ‡é¡¹ç›®é…é¢ä¸è¶³ã€‚éœ€è¦å¢åŠ ç›®æ ‡é¡¹ç›®çš„é…é¢æˆ–å‡å°‘å·¥ä½œç©ºé—´çš„èµ„æºå ç”¨ã€‚

### ç›‘æ§æ•°æ®ä¸ºä»€ä¹ˆæ˜¾ç¤ºä¸ºç©ºï¼Ÿ

**å¯èƒ½åŸå›  1**ï¼šé›†ç¾¤æœªé…ç½® Prometheusã€‚éœ€è¦åœ¨é›†ç¾¤çš„ä¸­é—´ä»¶ç®¡ç†ä¸­é…ç½®å¹¶å¯ç”¨ Prometheusã€‚

**å¯èƒ½åŸå›  2**ï¼šPrometheus è¿æ¥å¼‚å¸¸ã€‚æ£€æŸ¥ Prometheus æœåŠ¡çŠ¶æ€å’Œç½‘ç»œè¿é€šæ€§ã€‚

**å¯èƒ½åŸå›  3**ï¼šå·¥ä½œç©ºé—´å†…æ²¡æœ‰è¿è¡Œä¸­çš„ Podã€‚åªæœ‰è¿è¡Œä¸­çš„å·¥ä½œè´Ÿè½½æ‰ä¼šäº§ç”Ÿç›‘æ§æ•°æ®ã€‚

### åˆ é™¤å·¥ä½œç©ºé—´åæ•°æ®èƒ½å¦æ¢å¤ï¼Ÿ

å·¥ä½œç©ºé—´åˆ é™¤åï¼ŒNamespace åŠå…¶å†…éƒ¨èµ„æºä¼šè¢« Kubernetes çº§è”åˆ é™¤ï¼Œè¿™æ˜¯ä¸å¯é€†çš„æ“ä½œã€‚å¯¹äº PVC ä¸­çš„æ•°æ®ï¼Œå–å†³äºå­˜å‚¨ç±»çš„å›æ”¶ç­–ç•¥ï¼ˆDelete/Retainï¼‰ã€‚å¦‚æœä½¿ç”¨ Delete ç­–ç•¥ï¼Œæ•°æ®ä¼šè¢«ä¸€å¹¶åˆ é™¤ï¼›å¦‚æœä½¿ç”¨ Retain ç­–ç•¥ï¼Œåº•å±‚å­˜å‚¨å·ä¼šè¢«ä¿ç•™ã€‚

å»ºè®®åœ¨åˆ é™¤å‰åšå¥½æ•°æ®å¤‡ä»½ï¼Œé‡è¦æ•°æ®ä½¿ç”¨ Retain ç­–ç•¥çš„å­˜å‚¨ç±»ã€‚

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/12.åº”ç”¨å‘å¸ƒ.md
---

# åº”ç”¨ä¸­å¿ƒ

âœ¨ **ç‰¹æ€§:**

* ä»¥åº”ç”¨ä¸ºä¸­å¿ƒ: å‘Šåˆ«èµ„æºç¢ç‰‡åŒ–ç®¡ç†ï¼Œä¸€ç«™å¼ç®¡ç†åº”ç”¨å…¨ç”Ÿå‘½å‘¨æœŸ
* å¤šç‰ˆæœ¬ç®¡ç†: æ”¯æŒåº”ç”¨å¤šç‰ˆæœ¬å‘å¸ƒã€å›æ»šã€ç°åº¦å‘å¸ƒ
* æœåŠ¡èšåˆ: è‡ªåŠ¨å…³è” Serviceã€Ingressï¼Œæ— éœ€é¢‘ç¹åˆ‡æ¢é¡µé¢
* ä¾¿æ·è¿ç»´: Pod ç®¡ç†ã€å‰¯æœ¬ä¼¸ç¼©ã€é•œåƒæ›´æ–°ã€é…ç½®å˜æ›´ä¸€é”®å®Œæˆ
* å…¨ç±»å‹æ”¯æŒ: Deploymentã€StatefulSetã€DaemonSetã€CronJob å…¨è¦†ç›–

## è®¾è®¡ç†å¿µ

### ä¸ºä»€ä¹ˆéœ€è¦ä»¥åº”ç”¨ä¸ºä¸­å¿ƒï¼Ÿ

åœ¨ä¼ ç»Ÿçš„ Kubernetes ç®¡ç†æ–¹å¼ä¸­ï¼Œè¿ç»´äººå‘˜éœ€è¦åˆ†åˆ«ç®¡ç† Deploymentã€Serviceã€Ingressã€ConfigMap ç­‰å¤šç§èµ„æºã€‚å½“ä¸€ä¸ªä¸šåŠ¡åº”ç”¨åŒ…å«å¤šä¸ªç»„ä»¶æ—¶ï¼Œè¿ç»´äººå‘˜ä¸å¾—ä¸åœ¨ä¸åŒçš„èµ„æºé¡µé¢ä¹‹é—´é¢‘ç¹åˆ‡æ¢ï¼Œè¿™ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚

ä»¥ä¸€ä¸ªå…¸å‹çš„å¾®æœåŠ¡åº”ç”¨ä¸ºä¾‹ï¼Œå®ƒå¯èƒ½åŒ…å«ä»¥ä¸‹èµ„æºï¼šä¸€ä¸ª Deployment ç®¡ç† Pod å‰¯æœ¬ã€ä¸€ä¸ªæˆ–å¤šä¸ª Service æš´éœ²æœåŠ¡ç«¯å£ã€ä¸€ä¸ª Ingress æä¾›å¤–éƒ¨è®¿é—®å…¥å£ã€è‹¥å¹² ConfigMap å’Œ Secret å­˜å‚¨é…ç½®ã€‚åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼ŒæŸ¥çœ‹è¿™ä¸ªåº”ç”¨çš„çŠ¶æ€éœ€è¦è®¿é—®è‡³å°‘ 4-5 ä¸ªä¸åŒçš„é¡µé¢ã€‚

### ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„è§£å†³æ–¹æ¡ˆ

Kube Nova çš„åº”ç”¨ä¸­å¿ƒé‡‡ç”¨ã€Œä»¥åº”ç”¨ä¸ºä¸­å¿ƒã€çš„è®¾è®¡ç†å¿µï¼Œå°†ä¸åº”ç”¨ç›¸å…³çš„æ‰€æœ‰èµ„æºèšåˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„ç®¡ç†è§†å›¾ä¸­ã€‚è¿™ç§è®¾è®¡å¸¦æ¥äº†ä¸‰ä¸ªæ ¸å¿ƒä»·å€¼ï¼š

**ç¬¬ä¸€ï¼Œä¿¡æ¯èšåˆï¼Œä¸€ç›®äº†ç„¶ã€‚** åœ¨åº”ç”¨è¯¦æƒ…é¡µé¢ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åº”ç”¨çš„ Pod çŠ¶æ€ã€Service ç«¯å£ã€Ingress åœ°å€ã€èµ„æºä½¿ç”¨ç­‰æ‰€æœ‰å…³é”®ä¿¡æ¯ï¼Œæ— éœ€åœ¨å¤šä¸ªé¡µé¢ä¹‹é—´è·³è½¬ã€‚

**ç¬¬äºŒï¼Œæ“ä½œé›†ä¸­ï¼Œæå‡æ•ˆç‡ã€‚** é•œåƒæ›´æ–°ã€å‰¯æœ¬ä¼¸ç¼©ã€é…ç½®å˜æ›´ã€æœåŠ¡ç®¡ç†ç­‰å¸¸ç”¨æ“ä½œéƒ½é›†ä¸­åœ¨åº”ç”¨é¡µé¢å†…å®Œæˆï¼Œå¤§å¹…å‡å°‘æ“ä½œæ­¥éª¤ï¼Œæå‡è¿ç»´æ•ˆç‡ã€‚

**ç¬¬ä¸‰ï¼Œç‰ˆæœ¬ç®¡ç†ï¼Œè½»æ¾å›æ»šã€‚** æ¯æ¬¡åº”ç”¨å˜æ›´éƒ½ä¼šè®°å½•ä¸ºä¸€ä¸ªç‰ˆæœ¬ï¼Œæ”¯æŒå¿«é€ŸæŸ¥çœ‹å†å²ç‰ˆæœ¬ã€å¯¹æ¯”å·®å¼‚ã€ä¸€é”®å›æ»šï¼Œè®©åº”ç”¨å‘å¸ƒæ›´åŠ å®‰å…¨å¯æ§ã€‚

### åº”ç”¨ç±»å‹è¯´æ˜

åº”ç”¨ä¸­å¿ƒæ”¯æŒç®¡ç†ä»¥ä¸‹ç±»å‹çš„ Kubernetes å·¥ä½œè´Ÿè½½ï¼š

**Deploymentï¼ˆæ— çŠ¶æ€åº”ç”¨éƒ¨ç½²ï¼‰** æ˜¯æœ€å¸¸ç”¨çš„åº”ç”¨ç±»å‹ï¼Œæ”¯æŒæ»šåŠ¨æ›´æ–°å’Œæ°´å¹³æ‰©å±•ï¼Œé€‚ç”¨äº Web æœåŠ¡ã€API ç½‘å…³ã€å¾®æœåŠ¡ç­‰æ— çŠ¶æ€åº”ç”¨ã€‚å…¶ç‰¹ç‚¹æ˜¯å‰¯æœ¬ä¹‹é—´å®Œå…¨å¯¹ç­‰ï¼Œå¯ä»¥éšæ—¶æ‰©ç¼©å®¹ï¼Œæ”¯æŒæ»šåŠ¨æ›´æ–°ç­–ç•¥ã€‚

**StatefulSetï¼ˆæœ‰çŠ¶æ€åº”ç”¨éƒ¨ç½²ï¼‰** æä¾›ç¨³å®šçš„ç½‘ç»œæ ‡è¯†å’ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œé€‚ç”¨äºæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼å­˜å‚¨ç­‰æœ‰çŠ¶æ€åº”ç”¨ã€‚å…¶ç‰¹ç‚¹æ˜¯æ¯ä¸ª Pod æœ‰å›ºå®šçš„ç½‘ç»œæ ‡è¯†ï¼ˆå¦‚ pod-0ã€pod-1ï¼‰ï¼Œæ”¯æŒæœ‰åºéƒ¨ç½²å’Œåˆ é™¤ï¼Œå¯ä»¥ç»‘å®šæŒä¹…åŒ–å­˜å‚¨å·ã€‚

**DaemonSetï¼ˆå®ˆæŠ¤è¿›ç¨‹é›†ï¼‰** ç¡®ä¿åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œä¸€ä¸ª Pod å‰¯æœ¬ï¼Œé€‚ç”¨äºæ—¥å¿—æ”¶é›†ã€ç›‘æ§ä»£ç†ã€ç½‘ç»œæ’ä»¶ç­‰ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ã€‚å…¶ç‰¹ç‚¹æ˜¯å…¨èŠ‚ç‚¹éƒ¨ç½²ï¼Œæ–°èŠ‚ç‚¹åŠ å…¥æ—¶è‡ªåŠ¨è°ƒåº¦ï¼Œé€‚åˆéœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œçš„åŸºç¡€æœåŠ¡ã€‚

**CronJobï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰** æŒ‰ç…§æŒ‡å®šçš„æ—¶é—´è¡¨å‘¨æœŸæ€§è¿è¡Œä»»åŠ¡ï¼Œé€‚ç”¨äºå®šæ—¶å¤‡ä»½ã€æ•°æ®åŒæ­¥ã€æŠ¥è¡¨ç”Ÿæˆç­‰å‘¨æœŸæ€§ä»»åŠ¡ã€‚å…¶ç‰¹ç‚¹æ˜¯æ”¯æŒ Cron è¡¨è¾¾å¼å®šä¹‰æ‰§è¡Œå‘¨æœŸï¼Œä»»åŠ¡å®Œæˆå Pod è‡ªåŠ¨æ¸…ç†ã€‚

> \[!NOTE] ä¸ºä»€ä¹ˆä¸åŒ…å« Pod å’Œ Jobï¼Ÿ
> Pod å’Œ Job æ˜¯ä¸€æ¬¡æ€§æˆ–çŸ­ç”Ÿå‘½å‘¨æœŸçš„èµ„æºï¼Œä¸å…·å¤‡æŒç»­çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†éœ€æ±‚ã€‚Pod é€šå¸¸ç”±ä¸Šå±‚æ§åˆ¶å™¨ï¼ˆDeploymentã€StatefulSet ç­‰ï¼‰ç®¡ç†ï¼Œè€Œ Job åœ¨ä»»åŠ¡å®Œæˆåå³ç»ˆæ­¢ã€‚åº”ç”¨ä¸­å¿ƒèšç„¦äºéœ€è¦æŒç»­è¿ç»´çš„é•¿ç”Ÿå‘½å‘¨æœŸåº”ç”¨ï¼Œå› æ­¤ Pod å’Œ Job ç”±ä¸“é—¨çš„ç®¡ç†æ¨¡å—å¤„ç†ã€‚

***

## åº”ç”¨åˆ—è¡¨

**æ“ä½œè·¯å¾„**ï¼šä¸šåŠ¡ä¸­å¿ƒ â†’ åº”ç”¨ä¸­å¿ƒ

### é¡µé¢å¸ƒå±€

åº”ç”¨ä¸­å¿ƒé¡µé¢é‡‡ç”¨å·¦å³åˆ†æ å¸ƒå±€ï¼Œå·¦ä¾§ä¸ºæœåŠ¡åˆ—è¡¨ï¼Œå³ä¾§ä¸ºåº”ç”¨è¯¦æƒ…ã€‚

**é¡¶éƒ¨ç­›é€‰æ ** æä¾›å¤šç»´åº¦çš„ç­›é€‰æ¡ä»¶ï¼š

* **é›†ç¾¤**ï¼šé€‰æ‹©è¦æŸ¥çœ‹çš„ç›®æ ‡é›†ç¾¤
* **å·¥ä½œç©ºé—´**ï¼šé€‰æ‹©å·¥ä½œç©ºé—´ï¼ˆå¯¹åº” Kubernetes Namespaceï¼‰
* **æœåŠ¡**ï¼šé€‰æ‹©å…·ä½“çš„æœåŠ¡/åº”ç”¨
* **ç±»å‹**ï¼šæŒ‰åº”ç”¨ç±»å‹ç­›é€‰ï¼ˆå…¨éƒ¨ã€Deploymentã€StatefulSetã€DaemonSetã€CronJobï¼‰

### æœåŠ¡åˆ—è¡¨

å·¦ä¾§çš„æœåŠ¡åˆ—è¡¨å±•ç¤ºå½“å‰å·¥ä½œç©ºé—´å†…çš„æ‰€æœ‰åº”ç”¨ï¼ŒåŒ…æ‹¬ï¼š

**åº”ç”¨åç§°** æ˜¾ç¤ºåº”ç”¨çš„åç§°ï¼Œç‚¹å‡»å¯åˆ‡æ¢æŸ¥çœ‹ä¸åŒåº”ç”¨çš„è¯¦æƒ…ã€‚

**åº”ç”¨ç±»å‹æ ‡ç­¾** é€šè¿‡å½©è‰²æ ‡ç­¾æ ‡è¯†åº”ç”¨ç±»å‹ï¼š

* `deployment`ï¼ˆè“è‰²ï¼‰ï¼šæ— çŠ¶æ€åº”ç”¨
* `statefulset`ï¼ˆçº¢è‰²ï¼‰ï¼šæœ‰çŠ¶æ€åº”ç”¨
* `daemonset`ï¼ˆæ©™è‰²ï¼‰ï¼šå®ˆæŠ¤è¿›ç¨‹é›†
* `cronjob`ï¼ˆç´«è‰²ï¼‰ï¼šå®šæ—¶ä»»åŠ¡

**æœç´¢åŠŸèƒ½** æ”¯æŒæŒ‰åç§°æœç´¢åº”ç”¨ï¼Œå¿«é€Ÿå®šä½ç›®æ ‡æœåŠ¡ã€‚

**åˆ·æ–°æŒ‰é’®** ç‚¹å‡»å¯åˆ·æ–°æœåŠ¡åˆ—è¡¨ï¼Œè·å–æœ€æ–°çš„åº”ç”¨çŠ¶æ€ã€‚

***

## åŸºç¡€ä¿¡æ¯

åŸºç¡€ä¿¡æ¯é¡µé¢å±•ç¤ºåº”ç”¨çš„æ¦‚è§ˆä¿¡æ¯å’Œè®¿é—®åœ°å€ï¼Œæ˜¯äº†è§£åº”ç”¨çŠ¶æ€çš„å…¥å£ã€‚

### åº”ç”¨çŠ¶æ€æ¦‚è§ˆ

é¡µé¢é¡¶éƒ¨ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºåº”ç”¨çš„å…³é”®æŒ‡æ ‡ï¼š

**Pod æ€»æ•°** æ˜¾ç¤ºåº”ç”¨å½“å‰çš„ Pod å‰¯æœ¬æ€»æ•°ï¼Œåæ˜ åº”ç”¨çš„è§„æ¨¡ã€‚

**æ­£å¸¸ Pod** æ˜¾ç¤ºå¤„äº Running ä¸”å°±ç»ªçš„ Pod æ•°é‡ï¼Œä»¥åŠæ­£å¸¸ç‡ç™¾åˆ†æ¯”ã€‚100% è¡¨ç¤ºæ‰€æœ‰ Pod éƒ½åœ¨æ­£å¸¸è¿è¡Œã€‚

**å¼‚å¸¸ Pod** æ˜¾ç¤ºå¤„äºéæ­£å¸¸çŠ¶æ€ï¼ˆPendingã€Failedã€Unknown ç­‰ï¼‰çš„ Pod æ•°é‡ï¼Œä»¥åŠå¼‚å¸¸ç‡ã€‚0% æ˜¯ç†æƒ³çŠ¶æ€ã€‚

**Service æ•°é‡** æ˜¾ç¤ºä¸è¯¥åº”ç”¨å…³è”çš„ Service èµ„æºæ•°é‡ã€‚

**Ingress æ•°é‡** æ˜¾ç¤ºä¸è¯¥åº”ç”¨å…³è”çš„ Ingress èµ„æºæ•°é‡ã€‚

### æœåŠ¡è®¿é—®åœ°å€

æœåŠ¡è®¿é—®åœ°å€åŒºåŸŸèšåˆå±•ç¤ºäº†åº”ç”¨çš„æ‰€æœ‰è®¿é—®å…¥å£ï¼Œè¿™æ­£æ˜¯ã€Œä»¥åº”ç”¨ä¸ºä¸­å¿ƒã€ç†å¿µçš„ç›´æ¥ä½“ç°ã€‚è¿ç»´äººå‘˜æ— éœ€åˆ†åˆ«æŸ¥çœ‹ Service å’Œ Ingress èµ„æºï¼Œæ‰€æœ‰è®¿é—®ä¿¡æ¯éƒ½é›†ä¸­åœ¨è¿™é‡Œã€‚

**é›†ç¾¤å†…éƒ¨åœ°å€ï¼ˆClusterIPï¼‰** åˆ—å‡ºæ‰€æœ‰ ClusterIP ç±»å‹çš„ Service åœ°å€ï¼Œç”¨äºé›†ç¾¤å†…éƒ¨æœåŠ¡é—´è°ƒç”¨ã€‚åœ°å€æ ¼å¼ä¸º `http://{service-name}.{namespace}.svc.cluster.local:{port}`ã€‚æ ‡ç­¾ä¸Šçš„æ•°å­—è¡¨ç¤º Service æš´éœ²çš„ç«¯å£æ•°é‡ã€‚

**èŠ‚ç‚¹ç«¯å£åœ°å€ï¼ˆNodePortï¼‰** åˆ—å‡ºæ‰€æœ‰ NodePort ç±»å‹çš„ Service åœ°å€ï¼Œå¯é€šè¿‡ä»»æ„èŠ‚ç‚¹ IP åŠ ç«¯å£è®¿é—®ã€‚

**LoadBalancer è®¿é—®åœ°å€** åˆ—å‡ºæ‰€æœ‰ LoadBalancer ç±»å‹çš„ Service åœ°å€ï¼Œé€‚ç”¨äºäº‘ç¯å¢ƒï¼Œç”±äº‘å‚å•†æä¾›å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ã€‚

**Ingress è®¿é—®åœ°å€ï¼ˆHTTP/HTTPSï¼‰** åˆ—å‡ºæ‰€æœ‰ Ingress èµ„æºé…ç½®çš„åŸŸåè®¿é—®åœ°å€ï¼Œæ”¯æŒ HTTP å’Œ HTTPS åè®®ï¼Œæ˜¯åº”ç”¨å¯¹å¤–æš´éœ²çš„é¦–é€‰æ–¹å¼ã€‚

***

## ç‰ˆæœ¬ç®¡ç†

ç‰ˆæœ¬ç®¡ç†æ˜¯åº”ç”¨ä¸­å¿ƒçš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œæ”¯æŒåº”ç”¨çš„å¤šç‰ˆæœ¬ç®¡ç†ã€Pod è¿ç»´ã€å‰¯æœ¬ä¼¸ç¼©ã€é•œåƒæ›´æ–°ç­‰æ“ä½œã€‚

### ç‰ˆæœ¬æ¦‚è§ˆ

ç‰ˆæœ¬ç®¡ç†é¡µé¢é¡¶éƒ¨å±•ç¤ºåº”ç”¨çš„ç‰ˆæœ¬ä¿¡æ¯ï¼š

**å‘å¸ƒæ–°ç‰ˆæœ¬** ç‚¹å‡»ã€Œ+ å‘å¸ƒæ–°ç‰ˆæœ¬ã€æŒ‰é’®å¯ä»¥åˆ›å»ºåº”ç”¨çš„æ–°ç‰ˆæœ¬ï¼Œç”¨äºç°åº¦å‘å¸ƒæˆ–è“ç»¿éƒ¨ç½²åœºæ™¯ã€‚

**å½“å‰ç‰ˆæœ¬å¡ç‰‡** æ˜¾ç¤ºåº”ç”¨çš„å½“å‰ç¨³å®šç‰ˆæœ¬ï¼Œç»¿è‰²è¾¹æ¡†æ ‡è¯†ä¸ºã€Œç¨³å®šç‰ˆæœ¬ã€ã€‚ç‚¹å‡»ç‰ˆæœ¬å¡ç‰‡å¯å±•å¼€è¯¥ç‰ˆæœ¬çš„è¯¦ç»†ç®¡ç†åŠŸèƒ½ã€‚

### Pod ç®¡ç†

Pod ç®¡ç†é¡µç­¾å±•ç¤ºå½“å‰ç‰ˆæœ¬ä¸‹æ‰€æœ‰ Pod çš„è¯¦ç»†ä¿¡æ¯å’Œè¿ç»´æ“ä½œã€‚

#### Pod åˆ—è¡¨

Pod åˆ—è¡¨ä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºï¼ŒåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

**Pod åç§°** æ˜¾ç¤º Pod çš„å®Œæ•´åç§°ï¼Œç‚¹å‡»å¯æŸ¥çœ‹ Pod è¯¦æƒ…ã€‚

**çŠ¶æ€** æ˜¾ç¤º Pod çš„è¿è¡ŒçŠ¶æ€ï¼Œå¸¸è§çŠ¶æ€åŒ…æ‹¬ï¼š

* `Running`ï¼ˆç»¿è‰²ï¼‰ï¼šæ­£å¸¸è¿è¡Œä¸­
* `Pending`ï¼ˆé»„è‰²ï¼‰ï¼šç­‰å¾…è°ƒåº¦æˆ–èµ„æº
* `Failed`ï¼ˆçº¢è‰²ï¼‰ï¼šè¿è¡Œå¤±è´¥
* `Terminating`ï¼ˆç°è‰²ï¼‰ï¼šæ­£åœ¨ç»ˆæ­¢

**å°±ç»ª** æ˜¾ç¤º Pod å†…å®¹å™¨çš„å°±ç»ªçŠ¶æ€ï¼Œæ ¼å¼ä¸ºã€Œå°±ç»ªæ•°/æ€»æ•°ã€ï¼Œå¦‚ `3/3` è¡¨ç¤º 3 ä¸ªå®¹å™¨å…¨éƒ¨å°±ç»ªã€‚

**é‡å¯** æ˜¾ç¤º Pod çš„ç´¯è®¡é‡å¯æ¬¡æ•°ï¼Œé¢‘ç¹é‡å¯å¯èƒ½è¡¨ç¤ºåº”ç”¨å­˜åœ¨é—®é¢˜ã€‚

**èŠ‚ç‚¹** æ˜¾ç¤º Pod æ‰€åœ¨çš„èŠ‚ç‚¹åç§°ã€‚

**Pod IP** æ˜¾ç¤º Pod çš„é›†ç¾¤å†…éƒ¨ IP åœ°å€ã€‚

**è¿è¡Œæ—¶é•¿** æ˜¾ç¤º Pod ä»åˆ›å»ºåˆ°ç°åœ¨çš„è¿è¡Œæ—¶é•¿ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º Pod çš„åˆ›å»ºæ—¶é—´æˆ³ã€‚

#### Pod æ“ä½œ

æ¯ä¸ª Pod è¡Œæä¾›ä¾¿æ·çš„æ“ä½œå…¥å£ï¼š

**æ—¥å¿—** æŸ¥çœ‹ Pod å†…å®¹å™¨çš„å®æ—¶æ—¥å¿—è¾“å‡ºï¼Œæ”¯æŒå¤šå®¹å™¨åˆ‡æ¢ã€‚

**ç»ˆç«¯** æ‰“å¼€ Web ç»ˆç«¯ï¼Œç›´æ¥è¿›å…¥ Pod å†…æ‰§è¡Œå‘½ä»¤ï¼Œç”¨äºè°ƒè¯•å’Œæ’æŸ¥é—®é¢˜ã€‚

**æ–‡ä»¶** æµè§ˆå’Œç®¡ç† Pod å†…çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ã€‚

#### èµ„æºæ“ä½œ

ç‚¹å‡»ã€Œèµ„æºæ“ä½œã€ä¸‹æ‹‰èœå•ï¼Œå¯å¯¹æ•´ä¸ªåº”ç”¨è¿›è¡Œæ‰¹é‡æ“ä½œï¼š

**æŸ¥çœ‹ YAML** æŸ¥çœ‹åº”ç”¨çš„å®Œæ•´ YAML é…ç½®ï¼Œæ”¯æŒå¤åˆ¶å’Œä¸‹è½½ã€‚

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹åº”ç”¨èµ„æºçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ‡ç­¾ã€æ³¨è§£ã€äº‹ä»¶ç­‰ã€‚

**åœæ­¢å˜æ›´** æš‚åœæ­£åœ¨è¿›è¡Œçš„æ»šåŠ¨æ›´æ–°æ“ä½œã€‚

**æ¢å¤å˜æ›´** æ¢å¤è¢«æš‚åœçš„æ»šåŠ¨æ›´æ–°æ“ä½œã€‚

**é‡å¯èµ„æº** è§¦å‘åº”ç”¨çš„æ»šåŠ¨é‡å¯ï¼Œæ‰€æœ‰ Pod ä¼šè¢«ä¾æ¬¡é‡å»ºã€‚

**åœæ­¢èµ„æº** å°†åº”ç”¨çš„å‰¯æœ¬æ•°è®¾ç½®ä¸º 0ï¼Œåœæ­¢æ‰€æœ‰ Podã€‚

**å¯åŠ¨èµ„æº** æ¢å¤åº”ç”¨çš„å‰¯æœ¬æ•°ï¼Œé‡æ–°å¯åŠ¨ Podã€‚

### å‰¯æœ¬ç®¡ç†

å‰¯æœ¬ç®¡ç†é¡µç­¾ç”¨äºç®¡ç†åº”ç”¨çš„å‰¯æœ¬æ•°é‡å’Œè‡ªåŠ¨ä¼¸ç¼©ç­–ç•¥ã€‚

#### å½“å‰çŠ¶æ€

æ˜¾ç¤ºåº”ç”¨çš„å½“å‰å‰¯æœ¬çŠ¶æ€ï¼š

**å½“å‰å‰¯æœ¬æ•°** æ˜¾ç¤ºæ­£åœ¨è¿è¡Œçš„ Pod å‰¯æœ¬æ•°é‡ã€‚

**åº”ç”¨ç±»å‹** æ˜¾ç¤ºå·¥ä½œè´Ÿè½½ç±»å‹ï¼ˆDeploymentã€StatefulSet ç­‰ï¼‰ã€‚

**HPA çŠ¶æ€** æ˜¾ç¤ºæ°´å¹³è‡ªåŠ¨ä¼¸ç¼©ï¼ˆHPAï¼‰çš„é…ç½®çŠ¶æ€ï¼Œã€Œæœªé…ç½®ã€è¡¨ç¤ºæœªå¯ç”¨è‡ªåŠ¨ä¼¸ç¼©ã€‚

**VPA çŠ¶æ€** æ˜¾ç¤ºå‚ç›´è‡ªåŠ¨ä¼¸ç¼©ï¼ˆVPAï¼‰çš„é…ç½®çŠ¶æ€ã€‚

#### æ‰©ç¼©å®¹é…ç½®

**ç›®æ ‡å‰¯æœ¬æ•°** é€šè¿‡åŠ å‡æŒ‰é’®æˆ–ç›´æ¥è¾“å…¥æ•°å­—æ¥è°ƒæ•´ç›®æ ‡å‰¯æœ¬æ•°ã€‚

**å˜åŒ–è¶‹åŠ¿** å¯è§†åŒ–å±•ç¤ºä»å½“å‰å‰¯æœ¬æ•°åˆ°ç›®æ ‡å‰¯æœ¬æ•°çš„å˜åŒ–æ–¹å‘ï¼ˆå¢åŠ ã€å‡å°‘æˆ–æ— å˜åŒ–ï¼‰ã€‚

**åº”ç”¨æ›´æ”¹** ç‚¹å‡»ã€Œåº”ç”¨æ›´æ”¹ã€æŒ‰é’®æ‰§è¡Œæ‰©ç¼©å®¹æ“ä½œã€‚

**é‡ç½®** ç‚¹å‡»ã€Œé‡ç½®ã€æŒ‰é’®æ¢å¤ä¸ºå½“å‰å‰¯æœ¬æ•°ã€‚

#### æ‰©ç¼©å®¹è¯´æ˜

é¡µé¢å³ä¾§æä¾›æ‰©ç¼©å®¹æ“ä½œçš„è¯´æ˜ï¼š

**æ‰©å®¹ï¼ˆå¢åŠ å‰¯æœ¬ï¼‰** ç³»ç»Ÿä¼šåˆ›å»ºæ–°çš„ Podï¼Œé€æ­¥å¢åŠ åˆ°ç›®æ ‡æ•°é‡ã€‚æ–° Pod ä¼šè‡ªåŠ¨åŠ å…¥è´Ÿè½½å‡è¡¡ï¼Œå¼€å§‹æ¥æ”¶æµé‡ã€‚

**ç¼©å®¹ï¼ˆå‡å°‘å‰¯æœ¬ï¼‰** ç³»ç»Ÿä¼šä¼˜é›…åœ°ç»ˆæ­¢å¤šä½™çš„ Podï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡æ•°é‡ã€‚Pod ä¼šå…ˆä»è´Ÿè½½å‡è¡¡ä¸­ç§»é™¤ï¼Œç„¶åæ‰§è¡Œ PreStop é’©å­ï¼Œæœ€åç»ˆæ­¢ã€‚

> \[!WARNING] é‡è¦æç¤º
> ç¼©å®¹ä¼šå¯¼è‡´éƒ¨åˆ† Pod è¢«ç»ˆæ­¢ï¼Œè¯·ç¡®ä¿æœåŠ¡æœ‰è¶³å¤Ÿçš„å‰¯æœ¬å¤„ç†å½“å‰æµé‡ï¼Œé¿å…æœåŠ¡ä¸­æ–­ã€‚

### æ›´æ–°ç®¡ç†

æ›´æ–°ç®¡ç†é¡µç­¾ç”¨äºæ›´æ–°åº”ç”¨çš„å®¹å™¨é•œåƒå’Œæ›´æ–°ç­–ç•¥ã€‚

#### æ›´æ–°é•œåƒ

é•œåƒæ›´æ–°æ˜¯åº”ç”¨å‘å¸ƒçš„æ ¸å¿ƒæ“ä½œï¼Œæ”¯æŒä»¥ä¸‹é…ç½®ï¼š

**å®¹å™¨é€‰æ‹©** å½“åº”ç”¨åŒ…å«å¤šä¸ªå®¹å™¨æ—¶ï¼Œé€‰æ‹©è¦æ›´æ–°çš„ç›®æ ‡å®¹å™¨ã€‚

**å½“å‰é•œåƒ** æ˜¾ç¤ºå®¹å™¨å½“å‰ä½¿ç”¨çš„é•œåƒåœ°å€å’Œç‰ˆæœ¬æ ‡ç­¾ã€‚

**é•œåƒæœç´¢** æ”¯æŒæœç´¢å¹³å°é•œåƒä»“åº“ä¸­çš„é•œåƒï¼Œè¾“å…¥é•œåƒåç§°ï¼ˆå¦‚ nginxã€redisï¼‰è¿›è¡Œæœç´¢ã€‚

**é•œåƒé…ç½®** é…ç½®æ–°çš„é•œåƒåœ°å€ï¼š

* **é•œåƒä»“åº“**ï¼šé€‰æ‹©é•œåƒæ‰€åœ¨çš„ä»“åº“
* **é•œåƒåç§°**ï¼šè¾“å…¥æˆ–é€‰æ‹©é•œåƒåç§°
* **é•œåƒæ ‡ç­¾**ï¼šé€‰æ‹©é•œåƒç‰ˆæœ¬æ ‡ç­¾

#### æ›´æ–°ç­–ç•¥

é…ç½®åº”ç”¨çš„æ»šåŠ¨æ›´æ–°ç­–ç•¥ï¼ˆä»… Deployment æ”¯æŒï¼‰ï¼š

**æœ€å¤§ä¸å¯ç”¨ï¼ˆmaxUnavailableï¼‰** æ›´æ–°è¿‡ç¨‹ä¸­å…è®¸ä¸å¯ç”¨çš„æœ€å¤§ Pod æ•°é‡æˆ–ç™¾åˆ†æ¯”ã€‚

**æœ€å¤§è¶…é‡ï¼ˆmaxSurgeï¼‰** æ›´æ–°è¿‡ç¨‹ä¸­å…è®¸è¶…å‡ºæœŸæœ›å‰¯æœ¬æ•°çš„æœ€å¤§ Pod æ•°é‡æˆ–ç™¾åˆ†æ¯”ã€‚

#### å†å²ç‰ˆæœ¬

æŸ¥çœ‹åº”ç”¨çš„å†å²å‘å¸ƒç‰ˆæœ¬ï¼Œæ”¯æŒç‰ˆæœ¬å¯¹æ¯”å’Œä¸€é”®å›æ»šï¼š

**ç‰ˆæœ¬åˆ—è¡¨** æ˜¾ç¤ºæ‰€æœ‰å†å²ç‰ˆæœ¬çš„ä¿®è®¢å·ã€åˆ›å»ºæ—¶é—´ã€å˜æ›´å†…å®¹ã€‚

**ç‰ˆæœ¬å›æ»š** é€‰æ‹©ç›®æ ‡ç‰ˆæœ¬ï¼Œä¸€é”®å›æ»šåˆ°è¯¥ç‰ˆæœ¬çš„é…ç½®ã€‚

### é«˜çº§ç®¡ç†

é«˜çº§ç®¡ç†é¡µç­¾æä¾›å®¹å™¨çº§åˆ«çš„è¯¦ç»†é…ç½®ç®¡ç†ã€‚

#### ç¯å¢ƒå˜é‡

ç®¡ç†å®¹å™¨çš„ç¯å¢ƒå˜é‡é…ç½®ï¼š

**å®¹å™¨é€‰æ‹©** é€‰æ‹©è¦é…ç½®çš„ç›®æ ‡å®¹å™¨ã€‚

**ç¯å¢ƒå˜é‡åˆ—è¡¨** å±•ç¤ºå½“å‰é…ç½®çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼š

* **å˜é‡å**ï¼šç¯å¢ƒå˜é‡åç§°
* **æ¥æºç±»å‹**ï¼šå€¼çš„æ¥æºæ–¹å¼ï¼ˆç›´æ¥å€¼ã€ConfigMapã€Secretã€å­—æ®µå¼•ç”¨ï¼‰
* **å€¼/å¼•ç”¨**ï¼šå…·ä½“çš„å€¼æˆ–å¼•ç”¨é…ç½®

**æ‰¹é‡å¯¼å…¥** æ”¯æŒæ‰¹é‡å¯¼å…¥ç¯å¢ƒå˜é‡é…ç½®ã€‚

**æ·»åŠ å˜é‡** ç‚¹å‡»ã€Œ+ æ·»åŠ å˜é‡ã€æŒ‰é’®æ–°å¢ç¯å¢ƒå˜é‡ã€‚

#### å¥åº·æ£€æŸ¥

é…ç½®å®¹å™¨çš„å¥åº·æ£€æŸ¥æ¢é’ˆï¼š

**å­˜æ´»æ¢é’ˆï¼ˆLiveness Probeï¼‰** æ£€æµ‹å®¹å™¨æ˜¯å¦å­˜æ´»ï¼Œå¤±è´¥æ—¶é‡å¯å®¹å™¨ã€‚

**å°±ç»ªæ¢é’ˆï¼ˆReadiness Probeï¼‰** æ£€æµ‹å®¹å™¨æ˜¯å¦å°±ç»ªï¼Œå¤±è´¥æ—¶ä» Service ç«¯ç‚¹ç§»é™¤ã€‚

**å¯åŠ¨æ¢é’ˆï¼ˆStartup Probeï¼‰** æ£€æµ‹å®¹å™¨æ˜¯å¦å¯åŠ¨å®Œæˆï¼Œé€‚ç”¨äºå¯åŠ¨è¾ƒæ…¢çš„åº”ç”¨ã€‚

#### èµ„æºé…é¢

é…ç½®å®¹å™¨çš„èµ„æºè¯·æ±‚ï¼ˆrequestsï¼‰å’Œé™åˆ¶ï¼ˆlimitsï¼‰ï¼š

**CPU è¯·æ±‚/é™åˆ¶** è®¾ç½® CPU èµ„æºçš„è¯·æ±‚å€¼å’Œä¸Šé™ã€‚

**å†…å­˜è¯·æ±‚/é™åˆ¶** è®¾ç½®å†…å­˜èµ„æºçš„è¯·æ±‚å€¼å’Œä¸Šé™ã€‚

#### è°ƒåº¦ç®¡ç†

é…ç½® Pod çš„è°ƒåº¦ç­–ç•¥ï¼š

**èŠ‚ç‚¹é€‰æ‹©å™¨** é€šè¿‡æ ‡ç­¾é€‰æ‹© Pod è°ƒåº¦çš„ç›®æ ‡èŠ‚ç‚¹ã€‚

**äº²å’Œæ€§/åäº²å’Œæ€§** é…ç½®èŠ‚ç‚¹äº²å’Œæ€§å’Œ Pod äº²å’Œæ€§/åäº²å’Œæ€§è§„åˆ™ã€‚

**å®¹å¿åº¦** é…ç½® Pod å¯¹èŠ‚ç‚¹æ±¡ç‚¹çš„å®¹å¿è§„åˆ™ã€‚

#### å­˜å‚¨ç®¡ç†

ç®¡ç†å®¹å™¨çš„å­˜å‚¨å·æŒ‚è½½ï¼š

**å­˜å‚¨å·åˆ—è¡¨** å±•ç¤ºå·²æŒ‚è½½çš„å­˜å‚¨å·ï¼ˆPVCã€ConfigMapã€Secretã€EmptyDir ç­‰ï¼‰ã€‚

**æ·»åŠ å­˜å‚¨å·** æ·»åŠ æ–°çš„å­˜å‚¨å·æŒ‚è½½é…ç½®ã€‚

### äº‹ä»¶ç®¡ç†

äº‹ä»¶ç®¡ç†é¡µç­¾å±•ç¤ºåº”ç”¨ç›¸å…³çš„ Kubernetes äº‹ä»¶ï¼Œç”¨äºæ’æŸ¥é—®é¢˜å’Œäº†è§£åº”ç”¨çŠ¶æ€å˜åŒ–ã€‚

***

## æœåŠ¡ç®¡ç†

æœåŠ¡ç®¡ç†é¡µç­¾ç”¨äºç®¡ç†ä¸åº”ç”¨å…³è”çš„ Service èµ„æºã€‚

### åŠŸèƒ½è¯´æ˜

**æŸ¥çœ‹æœåŠ¡** åˆ—å‡ºä¸åº”ç”¨å…³è”çš„æ‰€æœ‰ Serviceï¼ŒåŒ…æ‹¬ç±»å‹ã€ç«¯å£ã€é€‰æ‹©å™¨ç­‰ä¿¡æ¯ã€‚

**åˆ›å»ºæœåŠ¡** ä¸ºåº”ç”¨åˆ›å»ºæ–°çš„ Serviceï¼Œæ”¯æŒ ClusterIPã€NodePortã€LoadBalancer ç±»å‹ã€‚

**ç¼–è¾‘æœåŠ¡** ä¿®æ”¹ç°æœ‰ Service çš„é…ç½®ï¼Œå¦‚ç«¯å£æ˜ å°„ã€æœåŠ¡ç±»å‹ç­‰ã€‚

**åˆ é™¤æœåŠ¡** åˆ é™¤ä¸å†éœ€è¦çš„ Service èµ„æºã€‚

***

## Ingress ç®¡ç†

Ingress ç®¡ç†é¡µç­¾ç”¨äºç®¡ç†åº”ç”¨çš„å¤–éƒ¨è®¿é—®å…¥å£ã€‚

### åŠŸèƒ½è¯´æ˜

**æŸ¥çœ‹ Ingress** åˆ—å‡ºä¸åº”ç”¨å…³è”çš„æ‰€æœ‰ Ingress è§„åˆ™ã€‚

**åˆ›å»º Ingress** ä¸ºåº”ç”¨åˆ›å»ºæ–°çš„ Ingressï¼Œé…ç½®åŸŸåã€è·¯å¾„ã€TLS è¯ä¹¦ç­‰ã€‚

**ç¼–è¾‘ Ingress** ä¿®æ”¹ç°æœ‰ Ingress çš„è·¯ç”±è§„åˆ™ã€‚

**åˆ é™¤ Ingress** åˆ é™¤ä¸å†éœ€è¦çš„ Ingress èµ„æºã€‚

***

## Flagger å‘å¸ƒ

Flagger å‘å¸ƒé¡µç­¾æ”¯æŒåŸºäº Flagger çš„æ¸è¿›å¼äº¤ä»˜èƒ½åŠ›ï¼Œå®ç°é‡‘ä¸é›€å‘å¸ƒã€A/B æµ‹è¯•ç­‰é«˜çº§å‘å¸ƒç­–ç•¥ã€‚

### åŠŸèƒ½è¯´æ˜

**é‡‘ä¸é›€å‘å¸ƒ** é€æ­¥å°†æµé‡ä»æ—§ç‰ˆæœ¬åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬ï¼Œæ ¹æ®æŒ‡æ ‡è‡ªåŠ¨æ¨è¿›æˆ–å›æ»šã€‚

**A/B æµ‹è¯•** åŸºäºè¯·æ±‚ç‰¹å¾ï¼ˆHeaderã€Cookie ç­‰ï¼‰å°†æµé‡è·¯ç”±åˆ°ä¸åŒç‰ˆæœ¬ã€‚

**è“ç»¿éƒ¨ç½²** ç»´æŠ¤ä¸¤ä¸ªç›¸åŒçš„ç¯å¢ƒï¼Œä¸€é”®åˆ‡æ¢æµé‡ã€‚

***

## æ“ä½œå®¡è®¡

æ“ä½œå®¡è®¡é¡µç­¾è®°å½•æ‰€æœ‰å¯¹åº”ç”¨çš„æ“ä½œå†å²ï¼Œä¾¿äºè¿½æº¯å’Œå®¡è®¡ã€‚

### å®¡è®¡è®°å½•

**æ“ä½œæ—¶é—´** æ˜¾ç¤ºæ“ä½œå‘ç”Ÿçš„æ—¶é—´æˆ³ã€‚

**æ“ä½œäºº** æ˜¾ç¤ºæ‰§è¡Œæ“ä½œçš„ç”¨æˆ·ã€‚

**æ“ä½œç±»å‹** æ˜¾ç¤ºæ“ä½œçš„ç±»å‹ï¼ˆåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ã€æ‰©ç¼©å®¹ç­‰ï¼‰ã€‚

**æ“ä½œè¯¦æƒ…** æ˜¾ç¤ºæ“ä½œçš„å…·ä½“å†…å®¹å’Œå˜æ›´è¯¦æƒ…ã€‚

***

## åˆ›å»ºå·¥ä½œè´Ÿè½½

åº”ç”¨ä¸­å¿ƒæ”¯æŒåˆ›å»ºå¤šç§ç±»å‹çš„å·¥ä½œè´Ÿè½½ã€‚

**æ“ä½œè·¯å¾„**ï¼šåº”ç”¨ä¸­å¿ƒ â†’ ç‚¹å‡»å³ä¸Šè§’ã€Œ+ã€æŒ‰é’®

### å·¥ä½œè´Ÿè½½ç±»å‹é€‰æ‹©

åˆ›å»ºå·¥ä½œè´Ÿè½½æ—¶ï¼Œé¦–å…ˆé€‰æ‹©å·¥ä½œè´Ÿè½½ç±»å‹ï¼š

**Deployment** æ— çŠ¶æ€åº”ç”¨éƒ¨ç½²ï¼Œæ”¯æŒæ»šåŠ¨æ›´æ–°å’Œæ°´å¹³æ‰©å±•ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬ Web æœåŠ¡ã€API æœåŠ¡ã€å¾®æœåŠ¡åº”ç”¨ã€‚å…³é”®ç‰¹æ€§æ˜¯æ— çŠ¶æ€ã€å‰¯æœ¬ç®¡ç†ã€æ»šåŠ¨æ›´æ–°ã€‚

**StatefulSet** æœ‰çŠ¶æ€åº”ç”¨éƒ¨ç½²ï¼Œæä¾›ç¨³å®šçš„ç½‘ç»œæ ‡è¯†å’ŒæŒä¹…åŒ–å­˜å‚¨ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼å­˜å‚¨ã€‚å…³é”®ç‰¹æ€§æ˜¯æœ‰çŠ¶æ€ã€ç¨³å®šæ ‡è¯†ã€æŒä¹…å­˜å‚¨ã€‚

**DaemonSet** åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œä¸€ä¸ª Pod å‰¯æœ¬ï¼Œé€‚åˆç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬æ—¥å¿—é‡‡é›†ã€ç›‘æ§ä»£ç†ã€ç½‘ç»œæ’ä»¶ã€‚å…³é”®ç‰¹æ€§æ˜¯èŠ‚ç‚¹å®ˆæŠ¤ã€å…¨èŠ‚ç‚¹éƒ¨ç½²ã€æ—¥å¿—/ç›‘æ§ã€‚

**CronJob** æŒ‰ç…§æŒ‡å®šçš„æ—¶é—´è¡¨å‘¨æœŸæ€§è¿è¡Œä»»åŠ¡ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬å®šæ—¶å¤‡ä»½ã€æ•°æ®åŒæ­¥ã€æŠ¥è¡¨ç”Ÿæˆã€‚å…³é”®ç‰¹æ€§æ˜¯å®šæ—¶æ‰§è¡Œã€å‘¨æœŸæ€§ã€Cron è¡¨è¾¾å¼ã€‚

**Job** ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œè¿è¡Œå®Œæˆåè‡ªåŠ¨é€€å‡ºã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬æ•°æ®è¿ç§»ã€æ‰¹å¤„ç†ä»»åŠ¡ã€‚å…³é”®ç‰¹æ€§æ˜¯ä¸€æ¬¡æ€§ã€æ‰¹å¤„ç†ã€ä»»åŠ¡å®Œæˆé€€å‡ºã€‚

**Pod** Kubernetes æœ€å°çš„å¯éƒ¨ç½²å•å…ƒï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬å¿«é€Ÿæµ‹è¯•ã€ä¸´æ—¶è°ƒè¯•ã€‚å…³é”®ç‰¹æ€§æ˜¯å•å®ä¾‹ã€é€‚åˆæµ‹è¯•ã€å¿«é€Ÿéƒ¨ç½²ã€‚

é€‰æ‹©ç±»å‹åï¼Œç‚¹å‡»ã€Œç¡®è®¤åˆ›å»ºã€æŒ‰é’®è¿›å…¥è¯¦ç»†é…ç½®é¡µé¢ã€‚

***

## ä¸åŒåº”ç”¨ç±»å‹çš„ä¾¿æ·æ“ä½œ

ä¸åŒç±»å‹çš„åº”ç”¨åœ¨ç‰ˆæœ¬ç®¡ç†ä¸­æä¾›çš„æ“ä½œç•¥æœ‰ä¸åŒï¼Œä»¥ä¸‹æ˜¯å„ç±»å‹çš„ç‰¹æœ‰æ“ä½œè¯´æ˜ã€‚

### Deployment ä¾¿æ·æ“ä½œ

Deployment æ˜¯åŠŸèƒ½æœ€å®Œæ•´çš„åº”ç”¨ç±»å‹ï¼Œæ”¯æŒä»¥ä¸‹ä¾¿æ·æ“ä½œï¼š

**æ»šåŠ¨æ›´æ–°** æ”¯æŒé…ç½® maxUnavailable å’Œ maxSurge ç­–ç•¥ï¼Œå®ç°é›¶åœæœºæ›´æ–°ã€‚

**å‰¯æœ¬ä¼¸ç¼©** æ”¯æŒæ‰‹åŠ¨è°ƒæ•´å‰¯æœ¬æ•°ï¼Œä»¥åŠé…ç½® HPA å®ç°è‡ªåŠ¨ä¼¸ç¼©ã€‚

**æš‚åœ/æ¢å¤** æ”¯æŒæš‚åœæ­£åœ¨è¿›è¡Œçš„æ»šåŠ¨æ›´æ–°ï¼Œç”¨äºè§‚å¯Ÿæ–°ç‰ˆæœ¬çŠ¶æ€ã€‚

**å›æ»š** æ”¯æŒä¸€é”®å›æ»šåˆ°ä»»æ„å†å²ç‰ˆæœ¬ã€‚

**é‡å¯** æ”¯æŒæ»šåŠ¨é‡å¯æ‰€æœ‰ Podï¼Œä¸æ”¹å˜é…ç½®ã€‚

### StatefulSet ä¾¿æ·æ“ä½œ

StatefulSet åœ¨ Deployment çš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹æœ‰çŠ¶æ€åº”ç”¨æä¾›é¢å¤–åŠŸèƒ½ï¼š

**æœ‰åºéƒ¨ç½²** Pod æŒ‰ç…§ 0ã€1ã€2... çš„é¡ºåºä¾æ¬¡åˆ›å»ºï¼Œç¡®ä¿ä¾èµ–å…³ç³»ã€‚

**æœ‰åºåˆ é™¤** ç¼©å®¹æ—¶æŒ‰ç…§é€†åºåˆ é™¤ï¼Œå…ˆåˆ é™¤ç¼–å·å¤§çš„ Podã€‚

**æŒä¹…å­˜å‚¨** è‡ªåŠ¨ä¸ºæ¯ä¸ª Pod åˆ›å»ºç‹¬ç«‹çš„ PVCï¼Œæ•°æ®æŒä¹…ä¿å­˜ã€‚

**ç¨³å®šç½‘ç»œ** æ¯ä¸ª Pod æœ‰å›ºå®šçš„ DNS åç§°ï¼Œé‡å»ºåä¿æŒä¸å˜ã€‚

### DaemonSet ä¾¿æ·æ“ä½œ

DaemonSet ç”¨äºå…¨èŠ‚ç‚¹éƒ¨ç½²åœºæ™¯ï¼Œæä¾›ä»¥ä¸‹ä¾¿æ·æ“ä½œï¼š

**å…¨èŠ‚ç‚¹éƒ¨ç½²** è‡ªåŠ¨åœ¨æ‰€æœ‰èŠ‚ç‚¹ï¼ˆæˆ–æŒ‡å®šèŠ‚ç‚¹ï¼‰ä¸Šéƒ¨ç½² Podã€‚

**èŠ‚ç‚¹æ„ŸçŸ¥** æ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤æ—¶è‡ªåŠ¨è°ƒåº¦ï¼ŒèŠ‚ç‚¹ç§»é™¤æ—¶è‡ªåŠ¨æ¸…ç†ã€‚

**æ›´æ–°ç­–ç•¥** æ”¯æŒ RollingUpdate å’Œ OnDelete ä¸¤ç§æ›´æ–°ç­–ç•¥ã€‚

**èŠ‚ç‚¹é€‰æ‹©** æ”¯æŒé€šè¿‡èŠ‚ç‚¹é€‰æ‹©å™¨æŒ‡å®šéƒ¨ç½²çš„ç›®æ ‡èŠ‚ç‚¹ã€‚

> \[!NOTE] DaemonSet ç‰¹æ®Šè¯´æ˜
> DaemonSet æ²¡æœ‰å‰¯æœ¬ç®¡ç†åŠŸèƒ½ï¼Œå› ä¸ºå…¶å‰¯æœ¬æ•°ç”±é›†ç¾¤èŠ‚ç‚¹æ•°å†³å®šã€‚æ‰©ç¼©å®¹é€šè¿‡è°ƒæ•´èŠ‚ç‚¹é€‰æ‹©å™¨å®ç°ã€‚

### CronJob ä¾¿æ·æ“ä½œ

CronJob ç”¨äºå®šæ—¶ä»»åŠ¡åœºæ™¯ï¼Œæä¾›ä»¥ä¸‹ä¾¿æ·æ“ä½œï¼š

**Cron è¡¨è¾¾å¼** ä½¿ç”¨æ ‡å‡† Cron è¡¨è¾¾å¼å®šä¹‰æ‰§è¡Œå‘¨æœŸï¼ˆå¦‚ `0 2 * * *` è¡¨ç¤ºæ¯å¤©å‡Œæ™¨ 2 ç‚¹ï¼‰ã€‚

**å¹¶å‘ç­–ç•¥** é…ç½®ä»»åŠ¡å¹¶å‘æ‰§è¡Œç­–ç•¥ï¼ˆAllowã€Forbidã€Replaceï¼‰ã€‚

**å†å²ä¿ç•™** é…ç½®ä¿ç•™çš„æˆåŠŸ/å¤±è´¥ä»»åŠ¡å†å²æ•°é‡ã€‚

**æ‰‹åŠ¨è§¦å‘** æ”¯æŒæ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ä»»åŠ¡æ‰§è¡Œï¼Œä¸å½±å“å®šæ—¶è®¡åˆ’ã€‚

**æš‚åœ/æ¢å¤** æ”¯æŒæš‚åœå®šæ—¶ä»»åŠ¡çš„è°ƒåº¦ï¼Œä¸åˆ é™¤å·²åˆ›å»ºçš„ Jobã€‚

***

## æœ€ä½³å®è·µ

### åº”ç”¨ç®¡ç†å»ºè®®

**åˆç†é€‰æ‹©åº”ç”¨ç±»å‹** æ ¹æ®åº”ç”¨çš„ç‰¹æ€§é€‰æ‹©åˆé€‚çš„å·¥ä½œè´Ÿè½½ç±»å‹ã€‚æ— çŠ¶æ€æœåŠ¡ä½¿ç”¨ Deploymentï¼Œæ•°æ®åº“ä½¿ç”¨ StatefulSetï¼Œç³»ç»Ÿç»„ä»¶ä½¿ç”¨ DaemonSetï¼Œå®šæ—¶ä»»åŠ¡ä½¿ç”¨ CronJobã€‚

**é…ç½®å¥åº·æ£€æŸ¥** ä¸ºåº”ç”¨é…ç½®é€‚å½“çš„å­˜æ´»æ¢é’ˆå’Œå°±ç»ªæ¢é’ˆï¼Œç¡®ä¿ Kubernetes èƒ½å¤Ÿæ­£ç¡®åˆ¤æ–­åº”ç”¨çŠ¶æ€ï¼Œå®ç°è‡ªåŠ¨æ•…éšœæ¢å¤å’Œä¼˜é›…æ»šåŠ¨æ›´æ–°ã€‚

**è®¾ç½®èµ„æºé…é¢** ä¸ºå®¹å™¨è®¾ç½®åˆç†çš„ CPU å’Œå†…å­˜è¯·æ±‚/é™åˆ¶ï¼Œé¿å…èµ„æºäº‰æŠ¢å’Œ OOM é—®é¢˜ã€‚

**ä½¿ç”¨æ»šåŠ¨æ›´æ–°** åˆ©ç”¨ Deployment çš„æ»šåŠ¨æ›´æ–°èƒ½åŠ›ï¼Œé…åˆå¥åº·æ£€æŸ¥ï¼Œå®ç°é›¶åœæœºå‘å¸ƒã€‚

### ç‰ˆæœ¬ç®¡ç†å»ºè®®

**è¯­ä¹‰åŒ–ç‰ˆæœ¬** ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆå¦‚ v1.2.3ï¼‰æ ‡è®°é•œåƒï¼Œä¾¿äºè¿½è¸ªå’Œå›æ»šã€‚

**ä¿ç•™å†å²ç‰ˆæœ¬** åˆç†é…ç½® revisionHistoryLimitï¼Œä¿ç•™è¶³å¤Ÿçš„å†å²ç‰ˆæœ¬ä»¥æ”¯æŒå›æ»šã€‚

**å‘å¸ƒå‰æµ‹è¯•** é‡å¤§å˜æ›´å‰åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œç¡®è®¤æ— è¯¯åå†å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒã€‚

### æœåŠ¡æš´éœ²å»ºè®®

**å†…éƒ¨æœåŠ¡ä½¿ç”¨ ClusterIP** ä»…ä¾›é›†ç¾¤å†…éƒ¨è°ƒç”¨çš„æœåŠ¡ä½¿ç”¨ ClusterIP ç±»å‹ã€‚

**å¤–éƒ¨è®¿é—®ä½¿ç”¨ Ingress** éœ€è¦å¯¹å¤–æš´éœ²çš„æœåŠ¡ä¼˜å…ˆä½¿ç”¨ Ingressï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚

**è°¨æ…ä½¿ç”¨ NodePort** NodePort ä¼šå ç”¨èŠ‚ç‚¹ç«¯å£èµ„æºï¼Œä»…åœ¨ç‰¹æ®Šåœºæ™¯ä½¿ç”¨ã€‚

***

## å¸¸è§é—®é¢˜

### Pod ä¸€ç›´å¤„äº Pending çŠ¶æ€æ€ä¹ˆåŠï¼Ÿ

**å¯èƒ½åŸå›  1**ï¼šèµ„æºä¸è¶³ã€‚æ£€æŸ¥å·¥ä½œç©ºé—´çš„é…é¢æ˜¯å¦å……è¶³ï¼Œä»¥åŠé›†ç¾¤æ˜¯å¦æœ‰å¯ç”¨èµ„æºã€‚

**å¯èƒ½åŸå›  2**ï¼šè°ƒåº¦çº¦æŸæ— æ³•æ»¡è¶³ã€‚æ£€æŸ¥èŠ‚ç‚¹é€‰æ‹©å™¨ã€äº²å’Œæ€§è§„åˆ™ã€å®¹å¿åº¦é…ç½®æ˜¯å¦æ­£ç¡®ã€‚

**å¯èƒ½åŸå›  3**ï¼šPVC æ— æ³•ç»‘å®šã€‚å¯¹äº StatefulSetï¼Œæ£€æŸ¥ PVC æ˜¯å¦èƒ½å¤ŸæˆåŠŸåˆ›å»ºå’Œç»‘å®šã€‚

### æ»šåŠ¨æ›´æ–°å¡ä½äº†æ€ä¹ˆå¤„ç†ï¼Ÿ

**æ£€æŸ¥æ–° Pod çŠ¶æ€** æŸ¥çœ‹æ–°åˆ›å»ºçš„ Pod æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼Œæ£€æŸ¥ Pod äº‹ä»¶å’Œæ—¥å¿—ã€‚

**æ£€æŸ¥å¥åº·æ£€æŸ¥** ç¡®è®¤å°±ç»ªæ¢é’ˆé…ç½®æ­£ç¡®ï¼Œæ–° Pod èƒ½å¤Ÿé€šè¿‡å¥åº·æ£€æŸ¥ã€‚

**æš‚åœæ›´æ–°** å¦‚æœéœ€è¦æ’æŸ¥é—®é¢˜ï¼Œå¯ä»¥å…ˆæš‚åœæ›´æ–°ï¼Œé˜²æ­¢ç»§ç»­åˆ›å»ºé—®é¢˜ Podã€‚

**å›æ»š** å¦‚æœé—®é¢˜æ— æ³•å¿«é€Ÿè§£å†³ï¼Œå»ºè®®å…ˆå›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬ã€‚

### å¦‚ä½•å®ç°é›¶åœæœºæ›´æ–°ï¼Ÿ

å®ç°é›¶åœæœºæ›´æ–°éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

**é…ç½®å°±ç»ªæ¢é’ˆ** ç¡®ä¿æ–° Pod åœ¨å®Œå…¨å°±ç»ªåæ‰æ¥æ”¶æµé‡ã€‚

**åˆç†é…ç½®æ›´æ–°ç­–ç•¥** maxUnavailable ä¸è¦è®¾ç½®è¿‡å¤§ï¼Œç¡®ä¿å§‹ç»ˆæœ‰è¶³å¤Ÿçš„ Pod å¤„ç†æµé‡ã€‚

**ä¼˜é›…ç»ˆæ­¢** ä¸ºå®¹å™¨é…ç½®é€‚å½“çš„ terminationGracePeriodSecondsï¼Œç¡®ä¿æ—§ Pod èƒ½å¤Ÿå¤„ç†å®Œç°æœ‰è¯·æ±‚ã€‚

**PreStop é’©å­** å¦‚æœéœ€è¦ï¼Œé…ç½® PreStop é’©å­æ‰§è¡Œæ¸…ç†æ“ä½œã€‚

---

---
url: /01.æŒ‡å—/40.å¼€å‘/01.å¼€å‘æŒ‡å—.md
---

# Kube-Nova å¼€å‘æŒ‡å—

## ç¯å¢ƒå‡†å¤‡

### åç«¯å¼€å‘ç¯å¢ƒ

#### Go è¯­è¨€ç¯å¢ƒ

Kube-Nova åç«¯åŸºäº Go è¯­è¨€å¼€å‘ï¼Œä½¿ç”¨ go-zero å¾®æœåŠ¡æ¡†æ¶ã€‚ä½ éœ€è¦å®‰è£… Go 1.22 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å®‰è£…å®Œæˆåï¼Œè¯·ç¡®ä¿ `$GOPATH/bin` å·²æ·»åŠ åˆ°ç³»ç»Ÿ PATH ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·åç»­å®‰è£…çš„ Go å·¥å…·æ‰èƒ½åœ¨å‘½ä»¤è¡Œä¸­ç›´æ¥è°ƒç”¨ã€‚

```bash
# éªŒè¯ Go å®‰è£…
go version

# ç¡®ä¿ GOPATH/bin åœ¨ PATH ä¸­
export PATH=$PATH:$(go env GOPATH)/bin
```

#### å®‰è£… goctl å·¥å…·

goctl æ˜¯ go-zero æ¡†æ¶çš„ä»£ç ç”Ÿæˆå·¥å…·ï¼Œç”¨äºæ ¹æ® API å®šä¹‰æ–‡ä»¶å’Œ Proto æ–‡ä»¶è‡ªåŠ¨ç”ŸæˆæœåŠ¡ä»£ç éª¨æ¶ã€‚è¿™æ˜¯å¼€å‘è¿‡ç¨‹ä¸­æœ€æ ¸å¿ƒçš„å·¥å…·ä¹‹ä¸€ã€‚

```bash
go install github.com/zeromicro/go-zero/tools/goctl@latest
```

å®‰è£…å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ `goctl --version` éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸã€‚æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://go-zero.dev/docs/tasks/installation/goctl

#### å®‰è£… protoc åŠç›¸å…³æ’ä»¶

protoc æ˜¯ Protocol Buffers çš„ç¼–è¯‘å™¨ï¼Œç”¨äºç¼–è¯‘ `.proto` æ–‡ä»¶ç”Ÿæˆ gRPC æœåŠ¡ä»£ç ã€‚go-zero æä¾›äº†ä¸€é”®å®‰è£…å‘½ä»¤ï¼Œå¯ä»¥åŒæ—¶å®‰è£… protocã€protoc-gen-go å’Œ protoc-gen-go-grpc ä¸‰ä¸ªç»„ä»¶ã€‚

```bash
goctl env check --install --verbose --force
```

è¿™ä¸ªå‘½ä»¤ä¼šæ£€æŸ¥å½“å‰ç¯å¢ƒï¼Œå¹¶è‡ªåŠ¨ä¸‹è½½å®‰è£…ç¼ºå¤±çš„ç»„ä»¶ã€‚`--force` å‚æ•°ç¡®ä¿å³ä½¿ç»„ä»¶å·²å­˜åœ¨ä¹Ÿä¼šé‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://go-zero.dev/docs/tasks/installation/protoc

### å‰ç«¯å¼€å‘ç¯å¢ƒ

#### Node.js ç¯å¢ƒ

å‰ç«¯é¡¹ç›®è¦æ±‚ Node.js ç‰ˆæœ¬ >= 20.19.0ï¼ŒåŒ…ç®¡ç†å™¨ä½¿ç”¨ pnpm >= 8.8.0ã€‚å»ºè®®ä½¿ç”¨ nvm ç®¡ç† Node.js ç‰ˆæœ¬ï¼Œä¾¿äºåœ¨ä¸åŒé¡¹ç›®é—´åˆ‡æ¢ã€‚

```bash
# éªŒè¯ Node.js ç‰ˆæœ¬
node --version

# å®‰è£… pnpmï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
npm install -g pnpm

# éªŒè¯ pnpm ç‰ˆæœ¬
pnpm --version
```

***

## ä»£ç ä»“åº“

### åç«¯ä»“åº“

| å¹³å°   | ä»“åº“åœ°å€                                              |
| ------ | ----------------------------------------------------- |
| GitHub | https://github.com/yanshicheng/kube-nova              |
| Gitee  | https://gitee.com/ikubeops/kube-nova                  |

```bash
# å…‹éš†ä»“åº“ï¼ˆé€‰æ‹©å…¶ä¸€ï¼‰
git clone https://github.com/yanshicheng/kube-nova.git
# æˆ–
git clone https://gitee.com/ikubeops/kube-nova.git

# è¿›å…¥é¡¹ç›®ç›®å½•å¹¶ä¸‹è½½ä¾èµ–
cd kube-nova
go mod tidy
```

### å‰ç«¯ä»“åº“

| å¹³å°   | ä»“åº“åœ°å€                                              |
| ------ | ----------------------------------------------------- |
| GitHub | https://github.com/yanshicheng/kube-nova-web          |
| Gitee  | https://gitee.com/ikubeops/kube-nova-web              |

```bash
# å…‹éš†ä»“åº“ï¼ˆé€‰æ‹©å…¶ä¸€ï¼‰
git clone https://github.com/yanshicheng/kube-nova-web.git
# æˆ–
git clone https://gitee.com/ikubeops/kube-nova-web.git

# è¿›å…¥é¡¹ç›®ç›®å½•å¹¶å®‰è£…ä¾èµ–
cd kube-nova-web
pnpm install
```

***

## åç«¯é¡¹ç›®ç»“æ„

ç†è§£é¡¹ç›®ç»“æ„å¯¹äºé«˜æ•ˆå¼€å‘è‡³å…³é‡è¦ã€‚Kube-Nova åç«¯é‡‡ç”¨å…¸å‹çš„ go-zero å¾®æœåŠ¡æ¶æ„ï¼Œæ ¸å¿ƒç›®å½•è¯´æ˜å¦‚ä¸‹ï¼š

```
kube-nova/
â”œâ”€â”€ application/          # åº”ç”¨æœåŠ¡ç›®å½•ï¼ˆæ ¸å¿ƒå¼€å‘åŒºåŸŸï¼‰
â”‚   â”œâ”€â”€ console-api/      # æ§åˆ¶å° API æœåŠ¡
â”‚   â”œâ”€â”€ console-rpc/      # æ§åˆ¶å° RPC æœåŠ¡
â”‚   â”œâ”€â”€ manager-api/      # ç®¡ç†ç«¯ API æœåŠ¡
â”‚   â”œâ”€â”€ manager-rpc/      # ç®¡ç†ç«¯ RPC æœåŠ¡
â”‚   â”œâ”€â”€ portal-api/       # é—¨æˆ· API æœåŠ¡
â”‚   â”œâ”€â”€ portal-rpc/       # é—¨æˆ· RPC æœåŠ¡
â”‚   â””â”€â”€ workload-api/     # å·¥ä½œè´Ÿè½½ API æœåŠ¡
â”œâ”€â”€ common/               # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ handler/          # é€šç”¨å¤„ç†å™¨
â”‚   â”œâ”€â”€ interceptors/     # gRPC æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ k8smanager/       # Kubernetes å®¢æˆ·ç«¯ç®¡ç†
â”‚   â”œâ”€â”€ middleware/       # HTTP ä¸­é—´ä»¶
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”œâ”€â”€ pkg/                  # å¯å¤ç”¨çš„åŒ…
â”‚   â”œâ”€â”€ casbinadapter/    # Casbin æƒé™é€‚é…å™¨
â”‚   â”œâ”€â”€ jwt/              # JWT è®¤è¯
â”‚   â””â”€â”€ storage/          # å­˜å‚¨ç›¸å…³
â”œâ”€â”€ template/             # goctl ä»£ç ç”Ÿæˆæ¨¡æ¿
â””â”€â”€ sql/                  # æ•°æ®åº“è„šæœ¬
```

åœ¨ go-zero çš„è®¾è®¡ç†å¿µä¸­ï¼ŒAPI æœåŠ¡è´Ÿè´£å¤„ç† HTTP è¯·æ±‚ï¼Œè€Œ RPC æœåŠ¡åˆ™æä¾›å†…éƒ¨çš„ gRPC è°ƒç”¨ã€‚API æœåŠ¡é€šå¸¸ä¼šè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ª RPC æœåŠ¡æ¥å®Œæˆä¸šåŠ¡é€»è¾‘ï¼Œè¿™ç§åˆ†å±‚è®¾è®¡ä½¿å¾—æœåŠ¡ä¹‹é—´çš„èŒè´£æ›´åŠ æ¸…æ™°ã€‚

***

## Makefile æŒ‡ä»¤è¯¦è§£

é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„ Makefile æŒ‡ä»¤æ¥ç®€åŒ–å¼€å‘æµç¨‹ã€‚è¿™äº›æŒ‡ä»¤å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šé€šç”¨æŒ‡ä»¤ã€ä»£ç ç”ŸæˆæŒ‡ä»¤ï¼ˆgen-xxxï¼‰å’ŒæœåŠ¡è¿è¡ŒæŒ‡ä»¤ï¼ˆrun-xxxï¼‰ã€‚

### é€šç”¨æŒ‡ä»¤

| æŒ‡ä»¤            | è¯´æ˜                                                         |
| --------------- | ------------------------------------------------------------ |
| `make tidy`     | æ‰§è¡Œ `go mod tidy`ï¼Œè‡ªåŠ¨æ›´æ–°å’Œæ¸…ç†ä¾èµ–                       |
| `make fmt`      | æ ¼å¼åŒ–æ‰€æœ‰ Go ä»£ç                                            |
| `make vet`      | é™æ€åˆ†æä»£ç ï¼Œæ£€æµ‹æ½œåœ¨é”™è¯¯                                   |
| `make lint`     | ä½¿ç”¨ golangci-lint è¿›è¡Œä»£ç è´¨é‡æ£€æŸ¥                          |
| `make test`     | è¿è¡Œå•å…ƒæµ‹è¯•                                                 |
| `make build`    | æ„å»ºå½“å‰å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¾“å‡ºåˆ° `dist/` ç›®å½•                |
| `make linux`    | äº¤å‰ç¼–è¯‘ Linux amd64 ç‰ˆæœ¬                                    |
| `make docker`   | æ„å»º Docker é•œåƒå¹¶æ¨é€åˆ° Harbor ä»“åº“                         |
| `make clean`    | æ¸…ç†æ„å»ºäº§ç‰©                                                 |
| `make help`     | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æŒ‡ä»¤çš„å¸®åŠ©ä¿¡æ¯                                   |

### ä»£ç ç”ŸæˆæŒ‡ä»¤ï¼ˆgen-xxxï¼‰

ä»£ç ç”ŸæˆæŒ‡ä»¤æ˜¯å¼€å‘è¿‡ç¨‹ä¸­çš„æ ¸å¿ƒå·¥å…·ã€‚å½“ä½ ä¿®æ”¹äº† `.api` æ–‡ä»¶æˆ– `.proto` æ–‡ä»¶åï¼Œéœ€è¦è¿è¡Œç›¸åº”çš„ç”ŸæˆæŒ‡ä»¤æ¥æ›´æ–°ä»£ç éª¨æ¶ã€‚

#### API æœåŠ¡ä»£ç ç”Ÿæˆ

API æœåŠ¡ä½¿ç”¨ `.api` æ–‡ä»¶å®šä¹‰ HTTP æ¥å£ã€‚goctl ä¼šæ ¹æ®è¿™ä¸ªå®šä¹‰æ–‡ä»¶ç”Ÿæˆè·¯ç”±ã€handlerã€types ç­‰ä»£ç ã€‚

| æŒ‡ä»¤                   | ä½œç”¨                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `make gen-portal-api`  | æ ¹æ® `portal.api` ç”Ÿæˆé—¨æˆ· API æœåŠ¡ä»£ç                       |
| `make gen-manager-api` | æ ¹æ® `manager.api` ç”Ÿæˆç®¡ç†ç«¯ API æœåŠ¡ä»£ç                    |
| `make gen-workload-api`| æ ¹æ® `workload.api` ç”Ÿæˆå·¥ä½œè´Ÿè½½ API æœåŠ¡ä»£ç                 |
| `make gen-console-api` | æ ¹æ® `console.api` ç”Ÿæˆæ§åˆ¶å° API æœåŠ¡ä»£ç                    |

ä»¥ `gen-portal-api` ä¸ºä¾‹ï¼Œå®ƒå®é™…æ‰§è¡Œçš„å‘½ä»¤æ˜¯ï¼š

```bash
goctl api go \
  --api=application/portal-api/portal.api \
  --dir=application/portal-api/ \
  --style=goZero \
  --home=./template
```

è¿™é‡Œçš„ `--home=./template` å‚æ•°æŒ‡å®šäº†è‡ªå®šä¹‰æ¨¡æ¿ç›®å½•ï¼Œä½¿ç”Ÿæˆçš„ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒã€‚`--style=goZero` è¡¨ç¤ºä½¿ç”¨é©¼å³°å‘½åé£æ ¼ã€‚

#### RPC æœåŠ¡ä»£ç ç”Ÿæˆ

RPC æœåŠ¡ä½¿ç”¨ `.proto` æ–‡ä»¶å®šä¹‰ gRPC æ¥å£ã€‚ç”Ÿæˆè¿‡ç¨‹ä¼šåŒæ—¶äº§ç”Ÿ protobuf æ¶ˆæ¯å®šä¹‰å’Œ gRPC æœåŠ¡ä»£ç ã€‚

| æŒ‡ä»¤                   | ä½œç”¨                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `make gen-portal-rpc`  | æ ¹æ® `portal.proto` ç”Ÿæˆé—¨æˆ· RPC æœåŠ¡ä»£ç                     |
| `make gen-manager-rpc` | æ ¹æ® `manager.proto` ç”Ÿæˆç®¡ç†ç«¯ RPC æœåŠ¡ä»£ç                  |
| `make gen-console-rpc` | æ ¹æ® `console.proto` ç”Ÿæˆæ§åˆ¶å° RPC æœåŠ¡ä»£ç                  |

ä»¥ `gen-portal-rpc` ä¸ºä¾‹ï¼Œå®ƒå®é™…æ‰§è¡Œçš„å‘½ä»¤æ˜¯ï¼š

```bash
goctl rpc protoc --style=goZero --home=./template \
  -I=application/portal-rpc/ \
  --go_out=application/portal-rpc/pb/ \
  --go_opt=module="github.com/yanshicheng/kube-nova/application/portal-rpc/pb" \
  --go-grpc_out=application/portal-rpc/pb/ \
  --go-grpc_opt=module="github.com/yanshicheng/kube-nova/application/portal-rpc/pb" \
  --zrpc_out=application/portal-rpc/ -m \
  application/portal-rpc/portal.proto
```

å‘½ä»¤å‚æ•°è¯´æ˜ï¼š`-I` æŒ‡å®š proto æ–‡ä»¶çš„æœç´¢è·¯å¾„ï¼›`--go_out` å’Œ `--go-grpc_out` æŒ‡å®šç”Ÿæˆçš„ Go ä»£ç è¾“å‡ºç›®å½•ï¼›`--zrpc_out` æŒ‡å®š go-zero æœåŠ¡ä»£ç è¾“å‡ºç›®å½•ï¼›`-m` è¡¨ç¤ºæ”¯æŒå¤šä¸ª proto æ–‡ä»¶ã€‚

### æœåŠ¡è¿è¡ŒæŒ‡ä»¤ï¼ˆrun-xxxï¼‰

å¼€å‘é˜¶æ®µä½¿ç”¨è¿™äº›æŒ‡ä»¤å¯ä»¥å¿«é€Ÿå¯åŠ¨å•ä¸ªæœåŠ¡è¿›è¡Œè°ƒè¯•ï¼Œæ— éœ€æ¯æ¬¡éƒ½å®Œæ•´æ„å»ºã€‚

| æŒ‡ä»¤                   | ä½œç”¨                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `make run-portal-api`  | å¯åŠ¨é—¨æˆ· API æœåŠ¡ï¼ˆç«¯å£è§é…ç½®æ–‡ä»¶ï¼‰                          |
| `make run-portal-rpc`  | å¯åŠ¨é—¨æˆ· RPC æœåŠ¡                                            |
| `make run-manager-api` | å¯åŠ¨ç®¡ç†ç«¯ API æœåŠ¡                                          |
| `make run-manager-rpc` | å¯åŠ¨ç®¡ç†ç«¯ RPC æœåŠ¡                                          |
| `make run-workload-api`| å¯åŠ¨å·¥ä½œè´Ÿè½½ API æœåŠ¡                                        |
| `make run-console-api` | å¯åŠ¨æ§åˆ¶å° API æœåŠ¡                                          |
| `make run-console-rpc` | å¯åŠ¨æ§åˆ¶å° RPC æœåŠ¡                                          |

ä»¥ `run-portal-api` ä¸ºä¾‹ï¼Œå®ƒå®é™…æ‰§è¡Œçš„å‘½ä»¤æ˜¯ï¼š

```bash
go run application/portal-api/portal.go -f application/portal-api/etc/portal-api.yaml
```

æ¯ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶ä½äºå¯¹åº”ç›®å½•çš„ `etc/` å­ç›®å½•ä¸­ï¼ŒåŒ…å«æœåŠ¡ç«¯å£ã€æ•°æ®åº“è¿æ¥ã€Redis é…ç½®ç­‰ä¿¡æ¯ã€‚å¯åŠ¨æœåŠ¡å‰è¯·ç¡®ä¿é…ç½®æ–‡ä»¶å·²æ­£ç¡®è®¾ç½®ã€‚

***

## å¼€å‘å·¥ä½œæµ

### æ–°å¢ API æ¥å£çš„å…¸å‹æµç¨‹

å½“ä½ éœ€è¦ä¸ºæŸä¸ªæœåŠ¡æ–°å¢ HTTP æ¥å£æ—¶ï¼Œåº”è¯¥éµå¾ªä»¥ä¸‹æ­¥éª¤ã€‚è¿™é‡Œä»¥åœ¨ portal-api æœåŠ¡ä¸­æ–°å¢æ¥å£ä¸ºä¾‹ï¼š

ç¬¬ä¸€æ­¥ï¼Œç¼–è¾‘ API å®šä¹‰æ–‡ä»¶ã€‚æ‰“å¼€ `application/portal-api/portal.api` æ–‡ä»¶ï¼ŒæŒ‰ç…§ go-zero çš„ API è¯­æ³•æ·»åŠ æ–°çš„æ¥å£å®šä¹‰ï¼ŒåŒ…æ‹¬è¯·æ±‚è·¯å¾„ã€æ–¹æ³•ã€è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æ„ã€‚

ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆä»£ç éª¨æ¶ã€‚è¿è¡Œ `make gen-portal-api` å‘½ä»¤ï¼Œgoctl ä¼šæ ¹æ®æ›´æ–°åçš„ API å®šä¹‰è‡ªåŠ¨ç”Ÿæˆæˆ–æ›´æ–°è·¯ç”±æ³¨å†Œã€handler å‡½æ•°ç­¾åå’Œç±»å‹å®šä¹‰ã€‚

ç¬¬ä¸‰æ­¥ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚åœ¨ç”Ÿæˆçš„ handler æ–‡ä»¶ä¸­ç¼–å†™å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚å¦‚æœéœ€è¦è°ƒç”¨ RPC æœåŠ¡ï¼Œå¯ä»¥åœ¨ `svc/servicecontext.go` ä¸­æ³¨å…¥ RPC å®¢æˆ·ç«¯ã€‚

ç¬¬å››æ­¥ï¼Œæµ‹è¯•éªŒè¯ã€‚è¿è¡Œ `make run-portal-api` å¯åŠ¨æœåŠ¡ï¼Œä½¿ç”¨ Postman æˆ– curl æµ‹è¯•æ–°å¢çš„æ¥å£ã€‚

### æ–°å¢ RPC æ–¹æ³•çš„å…¸å‹æµç¨‹

å½“ä½ éœ€è¦æ–°å¢å†…éƒ¨ gRPC è°ƒç”¨æ–¹æ³•æ—¶ï¼š

ç¬¬ä¸€æ­¥ï¼Œç¼–è¾‘ Proto å®šä¹‰æ–‡ä»¶ã€‚æ‰“å¼€å¯¹åº”æœåŠ¡çš„ `.proto` æ–‡ä»¶ï¼ˆå¦‚ `application/portal-rpc/portal.proto`ï¼‰ï¼Œæ·»åŠ æ–°çš„ message å®šä¹‰å’Œ service æ–¹æ³•ã€‚

ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆä»£ç éª¨æ¶ã€‚è¿è¡Œ `make gen-portal-rpc` å‘½ä»¤ï¼Œç”Ÿæˆ protobuf åºåˆ—åŒ–ä»£ç å’Œ gRPC æœåŠ¡éª¨æ¶ã€‚

ç¬¬ä¸‰æ­¥ï¼Œå®ç°æœåŠ¡é€»è¾‘ã€‚åœ¨ `internal/logic/` ç›®å½•ä¸‹æ‰¾åˆ°å¯¹åº”çš„ logic æ–‡ä»¶ï¼Œå®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚

ç¬¬å››æ­¥ï¼Œæµ‹è¯•éªŒè¯ã€‚è¿è¡Œ `make run-portal-rpc` å¯åŠ¨ RPC æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ grpcurl æˆ–ç¼–å†™æµ‹è¯•ç”¨ä¾‹è¿›è¡ŒéªŒè¯ã€‚

***

## å‰ç«¯å¼€å‘

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
cd kube-nova-web
pnpm install    # é¦–æ¬¡è¿è¡Œæˆ–ä¾èµ–æ›´æ–°åæ‰§è¡Œ
pnpm run dev    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­æ›´æ–°
```

å¼€å‘æœåŠ¡å™¨å¯åŠ¨åï¼Œé»˜è®¤ä¼šåœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªç«¯å£ï¼ˆé€šå¸¸æ˜¯ 5173 æˆ– 3000ï¼‰ï¼Œæµè§ˆå™¨è®¿é—®è¯¥åœ°å€å³å¯é¢„è§ˆå‰ç«¯ç•Œé¢ã€‚å¼€å‘æ¨¡å¼ä¸‹æ”¯æŒçƒ­æ¨¡å—æ›¿æ¢ï¼ˆHMRï¼‰ï¼Œä¿®æ”¹ä»£ç åé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
pnpm build:prod
```

æ„å»ºå®Œæˆåï¼Œäº§ç‰©ä¼šè¾“å‡ºåˆ° `dist/` ç›®å½•ï¼Œå¯ä»¥ç›´æ¥éƒ¨ç½²åˆ° Nginx æˆ–å…¶ä»–é™æ€æ–‡ä»¶æœåŠ¡å™¨ã€‚

***

## å¸¸è§é—®é¢˜

### goctl å‘½ä»¤æœªæ‰¾åˆ°

å¦‚æœè¿è¡Œ `make gen-xxx` æ—¶æç¤º `goctl: command not found`ï¼Œè¯´æ˜ `$GOPATH/bin` æœªåŠ å…¥ PATH ç¯å¢ƒå˜é‡ã€‚è¯·æ‰§è¡Œ `export PATH=$PATH:$(go env GOPATH)/bin` å¹¶å°†æ­¤è¡Œæ·»åŠ åˆ°ä½ çš„ shell é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `~/.bashrc` æˆ– `~/.zshrc`ï¼‰ä¸­ã€‚

### protoc ç›¸å…³é”™è¯¯

å¦‚æœç”Ÿæˆ RPC ä»£ç æ—¶å‡ºç° protoc ç›¸å…³é”™è¯¯ï¼Œè¯·é‡æ–°è¿è¡Œ `goctl env check --install --verbose --force` ç¡®ä¿æ‰€æœ‰ç»„ä»¶æ­£ç¡®å®‰è£…ã€‚

### ä¾èµ–ä¸‹è½½ç¼“æ…¢

å›½å†…ç”¨æˆ·å¯ä»¥è®¾ç½® Go æ¨¡å—ä»£ç†åŠ é€Ÿä¾èµ–ä¸‹è½½ï¼š

```bash
go env -w GOPROXY=https://goproxy.cn,direct
```

### æœåŠ¡å¯åŠ¨å¤±è´¥

è¯·æ£€æŸ¥å¯¹åº”æœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼ˆä½äº `etc/` ç›®å½•ï¼‰ä¸­çš„æ•°æ®åº“ã€Redisã€Etcd ç­‰è¿æ¥ä¿¡æ¯æ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠç›¸å…³åŸºç¡€æœåŠ¡æ˜¯å¦å·²å¯åŠ¨ã€‚

---

---
url: /@pages/archivesPage.md
---


---

---
url: /01.æŒ‡å—/01.ç®€ä»‹/02.å¿«é€Ÿå¼€å§‹.md
---

## éƒ¨ç½²æ¨¡å¼

ç›®å‰ä»…æ”¯æŒ Kubernetes éƒ¨ç½²ï¼Œå¹¶ä¸”æä¾›ä¸¤ç§éƒ¨ç½²æ¨¡å¼ `Operator` å’Œ `Yaml æ¸…å•` ã€‚å¦‚æœæƒ³ Docker Compose æˆ–è€…äºŒè¿›åˆ¶éƒ¨ç½²å¯è‡ªè¡Œä¿®æ”¹ã€‚

> \[!note] å¿…å¤‡æ¸…å•
> mysqlï¼Œredisï¼Œminioï¼ŒJaeger . å¦‚æœæœ¬åœ°å·²ç»æœ‰äº†ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±çš„ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥æŸ¥çœ‹ åŸºæœ¬ç¯å¢ƒéƒ¨ç½²ç« èŠ‚ï¼Œä½¿ç”¨è„šæœ¬ç»Ÿä¸€åˆå§‹åŒ–ã€‚

## åŸºæœ¬ç¯å¢ƒéƒ¨ç½²

> \[!WARNING] æç¤º
> å¦‚æœå·²ç»æœ‰ mysqlï¼Œredisï¼Œs3ï¼Œjaeger æ¨èä½¿ç”¨å†…éƒ¨çš„ï¼Œæ­¤éƒ¨ç½²æ–¹å¼ä»…ç”¨äºæ¼”ç¤ºã€‚
>
> å¹¶ä¸”éœ€è¦æå‰å‡†å¤‡å¥½ NFS æˆ–è€…é›†ç¾¤å†…æœ‰å¯ç”¨çš„ SCã€‚

ä»“åº“åœ°å€:

* [Gtee - ikubeops/kube-nova](https://gitee.com/ikubeops/kube-nova.git)
* [GitHub - yanshicheng/kube-nova](https://github.com/yanshicheng/kube-nova.git)

### å…‹éš†ä»“åº“

```bash
git clone https://github.com/ikubeops/kube-nova.git

# ä¿®æ”¹å…³é”®é…ç½®
vim scripts/basic-deploy.sh
# å­˜å‚¨æ¨¡å¼ï¼šstorageClass æˆ– nfs
STORAGE_MODE="storageClass" # éœ€è¦é›†ç¾¤å“ªå·²ç»é…ç½®äº† storageClass
 
 
# å¦‚æœé€‰æ‹© nfs æ¨¡å¼ï¼Œ`éœ€è¦å…ˆé…ç½® NFS æœåŠ¡å™¨`
# éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ–‡ä»¶: manifests/basic/pvc-nfs.yaml 
```

### NFS å­˜å‚¨ä¿®æ”¹ç¤ºä¾‹

```bash
# ä¿®æ”¹å…³é”®é…ç½®
vim scripts/basic-deploy.sh
# å­˜å‚¨æ¨¡å¼ï¼šstorageClass æˆ– nfs
STORAGE_MODE="nfs" # éœ€è¦é›†ç¾¤å“ªå·²ç»é…ç½®äº† storageClass

# ä¿®æ”¹pvc
vim manifests/basic/pvc-nfs.yaml
# ä¿®æ”¹ NFS æœåŠ¡å™¨åœ°å€å’Œè·¯å¾„
apiVersion: v1
kind: PersistentVolume
metadata:
  name: mysql-pv
spec:
  capacity:
    storage: 20Gi
  accessModes:
    - ReadWriteOnce
  nfs:
    server: 192.168.1.100  # ä¿®æ”¹ä¸ºæ‚¨çš„ NFS æœåŠ¡å™¨ IP
    path: /nfs/kube-nova/mysql  # ä¿®æ”¹ä¸ºå®é™…è·¯å¾„
```

### æ‰§è¡Œéƒ¨ç½²

```bash
bash scripts/basic-deploy.sh

# éƒ¨åˆ†æ—¥å¿—å¦‚ä¸‹:
==========================================
 Kube-Nova åŸºç¡€ç¯å¢ƒéƒ¨ç½²å®Œæˆ
==========================================

 MySQL è¿æ¥ä¿¡æ¯:
  é›†ç¾¤å†…è®¿é—®: mysql.kube-nova.svc.cluster.local:3306
  ç”¨æˆ·å: root
  å¯†ç : 8VlZ2lvIsKBCYSE3
  æ•°æ®åº“: kube_nova
  ç«¯å£è½¬å‘: kubectl port-forward -n kube-nova svc/mysql 3306:3306

 Redis è¿æ¥ä¿¡æ¯:
  é›†ç¾¤å†…è®¿é—®: redis.kube-nova.svc.cluster.local:6379
  å¯†ç : 2VOSiz0vhGtxaBJb
  ç«¯å£è½¬å‘: kubectl port-forward -n kube-nova svc/redis 6379:6379
  è¿æ¥æµ‹è¯•: redis-cli -h localhost -p 6379 -a 2VOSiz0vhGtxaBJb ping

 MinIO å¯¹è±¡å­˜å‚¨:
  é›†ç¾¤å†… API: minio-service.kube-nova.svc.cluster.local:9000
  é›†ç¾¤å†…æ§åˆ¶å°: minio-service.kube-nova.svc.cluster.local:9001
  è®¿é—®å¯†é’¥: kube-nova-admin
  å¯†é’¥: KubeNova@2024SecretKey!
  æ¡¶å: kube-nova (å…¬å¼€è®¿é—®)
  å·²ä¸Šä¼ å›¾ç‰‡: public/kube-nova.png
  ç«¯å£è½¬å‘:
    API:      kubectl port-forward -n kube-nova svc/minio-service 9000:9000
    æ§åˆ¶å°:    kubectl port-forward -n kube-nova svc/minio-service 9001:9001
  è®¿é—®æ§åˆ¶å°: http://localhost:9001

 Jaeger é“¾è·¯è¿½è¸ª:
  é›†ç¾¤å†… Collector: jaeger-collector.kube-nova.svc.cluster.local
  HTTP Collector: http://jaeger-collector:14268/api/traces
  gRPC Collector: jaeger-collector:14250
  OTLP gRPC: jaeger-collector:4317
  OTLP HTTP: http://jaeger-collector:4318
  UI NodePort: 30286
  è®¿é—® UI: http://<NodeIP>:30286
  ç«¯å£è½¬å‘: kubectl port-forward -n kube-nova svc/jaeger-ui 16686:16686
  è®¿é—® UI: http://localhost:16686

å­˜å‚¨é…ç½®:
  å­˜å‚¨æ¨¡å¼: storageClass
  è¯´æ˜: ä½¿ç”¨ Kubernetes StorageClass åŠ¨æ€ä¾›åº”

å¸¸ç”¨å‘½ä»¤:
  æŸ¥çœ‹æ‰€æœ‰èµ„æº:
    kubectl get all -n kube-nova
  æŸ¥çœ‹ PVC çŠ¶æ€:
    kubectl get pvc -n kube-nova
  æŸ¥çœ‹ Pod æ—¥å¿—:
    kubectl logs -n kube-nova <pod-name>
  è¿›å…¥ Pod:
    kubectl exec -it -n kube-nova <pod-name> -- sh
  åˆ é™¤æ‰€æœ‰èµ„æº:
    kubectl delete namespace kube-nova

==========================================


[âœ“]  éƒ¨ç½²å®Œæˆï¼æ‰€æœ‰æœåŠ¡å·²æˆåŠŸå¯åŠ¨ï¼
```

è„šæœ¬å°†è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

* ç¯å¢ƒæ£€æŸ¥ - æ£€æŸ¥ kubectlã€é›†ç¾¤è¿æ¥ã€å­˜å‚¨é…ç½®
* åˆ›å»ºå‘½åç©ºé—´ - åˆ›å»º `kube-nova` å‘½åç©ºé—´
* éƒ¨ç½² PVC - æ ¹æ®é€‰æ‹©çš„å­˜å‚¨æ¨¡å¼åˆ›å»ºæŒä¹…åŒ–å­˜å‚¨
* ç­‰å¾… PVC ç»‘å®š - ç­‰å¾…æ‰€æœ‰ PVC æˆåŠŸç»‘å®š
* éƒ¨ç½²åŸºç¡€æœåŠ¡ - ä¾æ¬¡éƒ¨ç½² MySQLã€Redisã€MinIOã€Jaeger
* ç­‰å¾…æœåŠ¡å°±ç»ª - ç­‰å¾…æ‰€æœ‰ Pod è¿›å…¥ Running çŠ¶æ€
* åˆå§‹åŒ– MinIO - åˆ›å»ºå­˜å‚¨æ¡¶å¹¶ä¸Šä¼ é»˜è®¤å›¾ç‰‡
* å¯¼å…¥æ•°æ®åº“ - åˆå§‹åŒ– MySQL æ•°æ®åº“è¡¨ç»“æ„å’ŒåŸºç¡€æ•°æ®
* æ˜¾ç¤ºè®¿é—®ä¿¡æ¯ - è¾“å‡ºæ‰€æœ‰æœåŠ¡çš„è®¿é—®åœ°å€å’Œå‡­è¯

### å·²æœ‰ç¯å¢ƒæ“ä½œå¦‚ä¸‹

**Mysql:** è¯·æ‰‹åŠ¨å¯¼å…¥ä»£ç ä»“åº“ä¸­ `sql/db.sql` åˆ°æ•°æ®åº“ä¸­ã€‚

**Minio:** ä¸Šä¼  `images/kube-nova.png` åˆ° å­˜å‚¨æ¡¶ `public/kube-nova.png`

## Operator éƒ¨ç½²

* [Gtee - ikubeops/kube-nova-operator](https://gitee.com/ikubeops/kube-nova-operator.git)
* [GitHub - yanshicheng/kube-nova-operator](https://github.com/yanshicheng/kube-nova-operator.git)

### å…‹éš†åœ°å€

æ ¹æ®ç½‘ç»œç¯å¢ƒå¯ä»¥è‡ªè¡Œé€‰æ‹©å…‹éš†ä»“åº“ã€‚

```bash
git clone https://gitee.com/ikubeops/kube-nova-operator.git
```

### éƒ¨ç½²æ§åˆ¶å™¨

```bash
cd kube-nova-operator/
kubectl apply -f dist/install.yaml 
```

### éƒ¨ç½² kube-nova

ç›®å‰æä¾›äº†ä¸‰ä¸ª yaml æ–‡ä»¶å¯æ ¹æ®éœ€æ±‚è‡ªè¡Œé€‰æ‹©

```bash
deploy/
â”œâ”€â”€ deploy-ingress.yaml
â”œâ”€â”€ ingress+htts.yaml
â””â”€â”€ nodeport.yaml
```

### é…ç½®æ–‡ä»¶

ä»‹ç» operator é…ç½®æ–‡ä»¶å‚æ•°ã€‚

### è®¿é—®

é»˜è®¤ç”¨æˆ·å:

* super\_admin
* Admin@123456

```bash
root@k8s-181:~/kube-nova/kube-nova-operator# kubectl  get kn -n kube-nova -w
NAME              é˜¶æ®µ    WEB   è®¿é—®åœ°å€                        è¿è¡Œæ—¶é•¿
kubenova-sample   å°±ç»ª    å°±ç»ª    http://172.16.1.183:30088   79s
```

![å¹³å°ç™»é™†](http://wiki-images.ikubeops.com/20260116151718570.png)

## Manifests éƒ¨ç½²

å¹³å°åŒæ—¶æä¾›äº† YAML æ¸…å•æ–¹å¼ï¼Œå¯è‡ªè¡Œæ ¹æ®éœ€æ±‚è¿›è¡Œä¿®æ”¹ã€‚

æ¸…å•åœ¨ `kube-nova` ä»“åº“ä¸­ï¼Œå¦‚ä¸‹

```bash
cd /kube-nova/manifests/base
tree
.
â”œâ”€â”€ 00-secret.yaml    # ä¸»è¦ä¿®æ”¹æ­¤æ–‡ä»¶
â”œâ”€â”€ 01-rbac.yaml
â”œâ”€â”€ 99-kube-nova-web.yaml
â”œâ”€â”€ console-api-configmap.yaml
â”œâ”€â”€ console-api-deployment.yaml
â”œâ”€â”€ console-api-service.yaml
â”œâ”€â”€ console-rpc-configmap.yaml
â”œâ”€â”€ console-rpc-deployment.yaml
â”œâ”€â”€ console-rpc-service.yaml
â”œâ”€â”€ manager-api-configmap.yaml
â”œâ”€â”€ manager-api-deployment.yaml
â”œâ”€â”€ manager-api-service.yaml
â”œâ”€â”€ manager-rpc-configmap.yaml
â”œâ”€â”€ manager-rpc-deployment.yaml
â”œâ”€â”€ manager-rpc-service.yaml
â”œâ”€â”€ portal-api-configmap.yaml
â”œâ”€â”€ portal-api-deployment.yaml
â”œâ”€â”€ portal-api-service.yaml
â”œâ”€â”€ portal-rpc-configmap.yaml
â”œâ”€â”€ portal-rpc-deployment.yaml
â”œâ”€â”€ portal-rpc-service.yaml
â”œâ”€â”€ workload-api-configmap.yaml
â”œâ”€â”€ workload-api-deployment.yaml
â””â”€â”€ workload-api-service.yaml
```

### Secret æ–‡ä»¶

ä¸»è¦ä¿®æ”¹ secret æ–‡ä»¶å³å¯ï¼Œæ‰€æœ‰æœåŠ¡çš„é…ç½®ä¼šé€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ã€‚

```yaml
---
apiVersion: v1
kind: Secret
metadata:
  name: kube-nova-secret
  namespace: kube-nova
type: Opaque
stringData:
  # å…¨å±€è¶…æ—¶
  DEFAULT_TIMEOUT: "30000"

  # MySQL åŸºç¡€å‚æ•°
  MYSQL_HOST: "mysql"
  MYSQL_PORT: "3306"
  MYSQL_DATABASE: "kube_nova"
  MYSQL_USER: "root"
  MYSQL_PASSWORD: "8VlZ2lvIsKBCYSE3"
  MYSQL_MAX_OPEN_CONNS: "100"
  MYSQL_MAX_IDLE_CONNS: "50"
  MYSQL_CONN_MAX_LIFETIME: "30m"

  # Redis åŸºç¡€å‚æ•°
  REDIS_HOST: "redis"
  REDIS_PORT: "6379"
  REDIS_PASSWORD: "2VOSiz0vhGtxaBJb"
  REDIS_TYPE: "node"
  REDIS_TLS: "false"
  REDIS_NONBLOCK: "true"
  REDIS_PING_TIMEOUT: "3s"

  # MinIO é…ç½®
  MINIO_ENDPOINT: "minio-service:9000"
  MINIO_ACCESS_KEY: "kube-nova-admin"
  MINIO_SECRET_KEY: "KubeNova@2024SecretKey!"
  MINIO_BUCKET: "kube-nova"
  MINIO_USE_TLS: "false"

  # JWT
  JWT_ACCESS_SECRET: "zk5Lp8m+0g7lvvLcnbUHPzQFEsRAmvNIn9tXdx0o80U="
  JWT_ACCESS_EXPIRE: "86400"
  JWT_REFRESH_SECRET: "zk5Lp8m+0g7lvvLcnbUHPzQFEsRAmvNIn9tXdx0o80U="
  JWT_REFRESH_EXPIRE: "604800"
  JWT_REFRESH_AFTER: "604800"

  # Webhook
  ALERTMANAGER_WEBHOOK_TOKEN: "mRwErqZaQVrxfyhiDQrdiQohAsONwSTtwhcmFXpCcaGavcINqorVoWINnSFFAijb"

  # Jaeger
  JAEGER_ENDPOINT: "http://jaeger-collector:14268/api/traces"
  TELEMETRY_SAMPLER: "1.0"
  TELEMETRY_BATCHER: "jaeger"

  # Portal
  PORTAL_NAME: "Kube-Nova äº‘åŸç”Ÿå¹³å°"
  PORTAL_URL: "http://www.yanshicheng.com:8888"
  DEMO_MODE: "true"

  # å…¶ä»–
  INJECT_IMAGE: "harbor.ikubeops.local/public/network-multitool:latest"
```

### åº”ç”¨é…ç½®æ–‡ä»¶

```python


```

---

---
url: /01.æŒ‡å—/ç›®å½•.md
---


---

---
url: /@pages/articleOverviewPage.md
---


---

---
url: /100.script/æ—¥è®°æ¨¡æ¿.md
---

```
 
åŒ—äº¬å¤©æ°”
å½“å‰æ¸©åº¦:27â„ƒ
å¤©æ°”:ä¸­é›¨
æ¸©åº¦èŒƒå›´:26 ~ 34â„ƒ
æ¹¿åº¦ï¼š77%
é£å‘ï¼šåŒ—é£ 2çº§
ç´«å¤–çº¿ï¼šæ— 
ç©ºæ°”è´¨é‡ï¼šä¼˜ PM: 22
æ—¥å‡º: 05:14 æ—¥è½: 19:27
```

## ä»Šæ—¥ä»»åŠ¡

### å·²å®Œæˆä»»åŠ¡

````dataviewjs
function callout(text, type) {
    const allText = `> [!${type}]\n` + text;
    const lines = allText.split('\n');
    return lines.join('\n>') + '\n'
};
const query = `
(done on {{DATE:YYYY-MM-DD}})
path includes WorkRecord/æ—¥æŠ¥

hide backlink
hide created date
`;

dv.paragraph('```tasks\n' + query + '\n```', 'todo');
````

### æœªå®Œæˆä»»åŠ¡

````dataviewjs
function callout(text, type) {
    const allText = `> [!${type}]\n` + text;
    const lines = allText.split('\n');
    return lines.join('\n>') + '\n'
};
const query = `
((created on {{DATE:YYYY-MM-DD}}) AND (done after {{DATE:YYYY-MM-DD}})) OR ((created on {{DATE:YYYY-MM-DD}}) AND (not done))
path includes WorkRecord/æ—¥æŠ¥

hide backlink
hide created date
`;

dv.paragraph('```tasks\n' + query + '\n```', 'todo');
````

### æ—¥å¿—

---

---
url: /@pages/tagsPage.md
---


---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/03.ç›‘æ§ç®¡ç†.md
---

> \[!NOTE]
> æš‚ä¸æ·±å…¥è®²è§£ç›‘æ§ç›¸å…³å†…å®¹
>
> å…·ä½“å¯ä»¥çœ‹:
>
> é›†ç¾¤ç›¸å…³: é›†ç¾¤ç®¡ç†
>
> podç›¸å…³: pod è¿ç»´
>
> namespace: å·¥ä½œç©ºé—´

---

---
url: /01.æŒ‡å—/01.ç®€ä»‹/01.ç®€ä»‹.md
---

# KubeNova é¡¹ç›®ä»‹ç»

## ä»€ä¹ˆæ˜¯ KubeNovaï¼Ÿ

KubeNova æ˜¯ä¸€ä¸ª**ä¼ä¸šçº§ Kubernetes å¤šé›†ç¾¤ç®¡ç†å¹³å°**ï¼Œä¸“ä¸ºéœ€è¦ç»Ÿä¸€ç®¡ç†å¤šä¸ª Kubernetes é›†ç¾¤çš„ä¼ä¸šå’Œå›¢é˜Ÿè®¾è®¡ã€‚å¹³å°ä»¥**é¡¹ç›®ä¸ºæ ¸å¿ƒè§†è§’**ï¼Œé€šè¿‡"é¡¹ç›® â†’ é›†ç¾¤é…é¢ â†’ å·¥ä½œç©ºé—´"ä¸‰çº§æ¶æ„ï¼Œå®ç°äº†å¤šç§Ÿæˆ·èµ„æºéš”ç¦»ä¸ç»Ÿä¸€ç®¡ç†ï¼Œè®©å¤æ‚çš„ Kubernetes è¿ç»´å˜å¾—ç®€å•é«˜æ•ˆã€‚
::: right
@YanShicheng
:::
::: tip æ„¿æ™¯
æ— è®ºæ˜¯ç®¡ç†å°‘é‡å¾®æœåŠ¡ï¼Œè¿˜æ˜¯è·¨å¤šé›†ç¾¤ç¼–æ’æ•°åƒå®¹å™¨ï¼ŒKubeNova éƒ½èƒ½æä¾›æ‰€éœ€çš„å¯æ‰©å±•æ€§ã€å¯é æ€§å’Œå¯è§‚æµ‹æ€§ã€‚
::: right
2026-01-15 @YanShicheng
:::

## ä»£ç ä»“åº“

| ä»“åº“       | GitHub                                                                              | Gitee                                                                        |
|----------|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------|
| åç«¯ä»£ç      | [yanshicheng/kube-nova](https://github.com/yanshicheng/kube-nova)                   | [ikubeops/kube-nova](https://gitee.com/ikubeops/kube-nova)                   |
| å‰ç«¯ä»£ç      | [yanshicheng/kube-nova-web](https://github.com/yanshicheng/kube-nova-web)           | [ikubeops/kube-nova-web](https://gitee.com/ikubeops/kube-nova-web)           |
| operator | [yanshicheng/kube-nova-operator](https://github.com/yanshicheng/kube-nova-operator) | [ikubeops/kube-nova-operator](https://gitee.com/ikubeops/kube-nova-operator) |

## Docker é•œåƒ

| æœåŠ¡æ¨¡å—               | Docker Hub                           | é˜¿é‡Œäº‘é•œåƒ                                                                   |
|--------------------|--------------------------------------|-------------------------------------------------------------------------|
| portal-api         | `ikubeops/portal-api:latest`         | `registry.cn-hangzhou.aliyuncs.com/kube-nova/portal-api:latest`         |
| portal-rpc         | `ikubeops/portal-rpc:latest`         | `registry.cn-hangzhou.aliyuncs.com/kube-nova/portal-rpc:latest`         |
| console-api        | `ikubeops/console-api:latest`        | `registry.cn-hangzhou.aliyuncs.com/kube-nova/console-api:latest`        |
| console-rpc        | `ikubeops/console-rpc:latest`        | `registry.cn-hangzhou.aliyuncs.com/kube-nova/console-rpc:latest`        |
| manager-api        | `ikubeops/manager-api:latest`        | `registry.cn-hangzhou.aliyuncs.com/kube-nova/manager-api:latest`        |
| manager-rpc        | `ikubeops/manager-rpc:latest`        | `registry.cn-hangzhou.aliyuncs.com/kube-nova/manager-rpc:latest`        |
| workload-api       | `ikubeops/workload-api:latest`       | `registry.cn-hangzhou.aliyuncs.com/kube-nova/workload-api:latest`       |
| kube-nova-web      | `ikubeops/kube-nova-web:latest`      | `registry.cn-hangzhou.aliyuncs.com/kube-nova/kube-nova-web:latest`      |
| kube-nova-operator | `ikubeops/kube-nova-operator:latest` | `registry.cn-hangzhou.aliyuncs.com/kube-nova/kube-nova-operator:latest` |

## æ¶æ„å›¾

![é¡¹ç›®æ¶æ„å›¾.png](https://images.ikubeops.com/static/20260118162212833.png)

## ä¸ºä»€ä¹ˆé€‰æ‹© KubeNovaï¼Ÿ

### é™ä½ Kubernetes ä½¿ç”¨é—¨æ§›

Kubernetes åŠŸèƒ½å¼ºå¤§ä½†å¤æ‚åº¦é«˜ï¼Œå¯¹äºå¼€å‘å’Œè¿ç»´å›¢é˜Ÿæ¥è¯´å­¦ä¹ æ›²çº¿é™¡å³­ã€‚KubeNova æä¾›äº†ç›´è§‚çš„ Web ç•Œé¢å’Œç®€åŒ–çš„ APIï¼Œè®©å›¢é˜Ÿèƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡å¼€å‘ï¼Œè€Œéåº•å±‚åŸºç¡€è®¾æ–½çš„å¤æ‚æ€§ã€‚

åŒæ—¶å¹³å°ä¹Ÿå¯ä»¥æé«˜å·¥ä½œæ•ˆç‡ï¼Œpod æ—¥å¿—ï¼Œäº¤äº’å¼ç»ˆç«¯ç­‰å¯ä»¥æœ‰æ•ˆå¸®åŠ©è¿ç»´åŒå­¦è¿›è¡Œä¾¿æ·çš„ç®¡ç†å·¥ä½œã€‚

### ç»Ÿä¸€å¤šé›†ç¾¤ç®¡ç†

ä¼ä¸šé€šå¸¸éœ€è¦ç®¡ç†å¤šä¸ª Kubernetes é›†ç¾¤ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼Œæˆ–è·¨åŒºåŸŸéƒ¨ç½²ï¼‰ã€‚KubeNova æä¾›å•ä¸€æ§åˆ¶å¹³é¢ï¼Œè®©æ‚¨å¯ä»¥ä»ä¸€ä¸ªç•Œé¢ç®¡ç†æ‰€æœ‰é›†ç¾¤ï¼Œå‘Šåˆ«åœ¨å¤šä¸ª kubectl ä¸Šä¸‹æ–‡ä¹‹é—´åˆ‡æ¢çš„çƒ¦æ¼ã€‚

### ä¼ä¸šçº§å¤šç§Ÿæˆ·æ”¯æŒ

é€šè¿‡ä¸‰çº§èµ„æºéš”ç¦»æ¶æ„å’Œå®Œæ•´çš„ RBAC æƒé™ä½“ç³»ï¼ŒKubeNova æ”¯æŒä¼ä¸šå†…éƒ¨å¤šä¸ªå›¢é˜Ÿå…±äº«åŸºç¡€è®¾æ–½ï¼ŒåŒæ—¶ç¡®ä¿èµ„æºéš”ç¦»å’Œå®‰å…¨è®¿é—®æ§åˆ¶ã€‚

### ç”Ÿäº§å°±ç»ªçš„è¿ç»´èƒ½åŠ›

KubeNova ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®¡ç†ç•Œé¢ï¼Œå®ƒæä¾›äº†å®Œæ•´çš„ç”Ÿäº§è¿ç»´èƒ½åŠ›ï¼ŒåŒ…æ‹¬äº”ç»´ç›‘æ§ã€æ™ºèƒ½å‘Šè­¦ã€ç°åº¦å‘å¸ƒã€å®¡è®¡æ—¥å¿—ç­‰ä¼ä¸šçº§ç‰¹æ€§ã€‚

## æ ¸å¿ƒç†å¿µ

KubeNova çš„è®¾è®¡éµå¾ªä»¥ä¸‹æ ¸å¿ƒç†å¿µï¼š

**ä»¥é¡¹ç›®ä¸ºä¸­å¿ƒ**ï¼šæ‰“ç ´ä¼ ç»Ÿä»¥é›†ç¾¤ä¸ºä¸­å¿ƒçš„ç®¡ç†æ¨¡å¼ï¼Œè®©ä¸šåŠ¡é¡¹ç›®æˆä¸ºèµ„æºç»„ç»‡çš„æ ¸å¿ƒå•å…ƒï¼Œæ›´è´´åˆä¼ä¸šå®é™…çš„ç»„ç»‡ç»“æ„å’Œå·¥ä½œæµç¨‹ã€‚

**ç®€åŒ–è€Œéç®€é™‹**ï¼šåœ¨å±è”½ Kubernetes åº•å±‚å¤æ‚æ€§çš„åŒæ—¶ï¼Œä¿ç•™å¯¹å®¹å™¨åŒ–å·¥ä½œè´Ÿè½½çš„ç²¾ç»†åŒ–æ§åˆ¶èƒ½åŠ›ã€‚å¹³å°æ‰€æœ‰èµ„æºå‡æ”¯æŒ YAML å¯¼å…¥ï¼Œè¡¨å•ä¸ YAML æ— ç¼è½¬æ¢ï¼Œæ»¡è¶³ä¸åŒç”¨æˆ·çš„æ“ä½œä¹ æƒ¯ã€‚

**äº‘åŸç”Ÿä¼˜å…ˆ**ï¼šåŸç”Ÿæ”¯æŒ Kubernetes éƒ¨ç½²ï¼Œä¸ Prometheusã€Alertmanagerã€Istio ç­‰äº‘åŸç”Ÿç”Ÿæ€æ— ç¼é›†æˆã€‚

***

# åŠŸèƒ½ç‰¹æ€§

## ä¸€ã€å¤šç§Ÿæˆ·ä¸èµ„æºç®¡ç†

### ä¸‰çº§èµ„æºéš”ç¦»æ¶æ„

KubeNova é‡‡ç”¨"é¡¹ç›® â†’ é›†ç¾¤é…é¢ â†’ å·¥ä½œç©ºé—´"çš„ä¸‰çº§æ¶æ„ï¼Œä¸ºæä¾›çµæ´»çš„èµ„æºéš”ç¦»æ–¹æ¡ˆï¼š

**é¡¹ç›®ï¼ˆProjectï¼‰** æ˜¯æœ€é«˜çº§åˆ«çš„èµ„æºéš”ç¦»å•å…ƒï¼Œå¯¹åº”ä¼ä¸šçš„ä¸šåŠ¡çº¿ã€äº§å“æˆ–å›¢é˜Ÿã€‚æ¯ä¸ªé¡¹ç›®å¯ä»¥åˆ†é…ä¸“å±çš„ç®¡ç†å‘˜å’Œæˆå‘˜ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„èµ„æºé…é¢å’Œè®¡è´¹ç»Ÿè®¡ã€‚

**é›†ç¾¤é…é¢ï¼ˆCluster Quotaï¼‰** å®šä¹‰äº†é¡¹ç›®åœ¨ç‰¹å®šé›†ç¾¤ä¸­å¯ä½¿ç”¨çš„èµ„æºä¸Šé™ï¼ŒåŒ…æ‹¬ CPUã€å†…å­˜ã€GPU ç­‰è®¡ç®—èµ„æºï¼Œä»¥åŠ Pod æ•°é‡ã€Service æ•°é‡ç­‰å¯¹è±¡é…é¢ã€‚æ”¯æŒèµ„æºè¶…åˆ†é…ç½®ï¼Œåœ¨ä¿è¯èµ„æºå®‰å…¨çš„å‰æä¸‹æé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚

**å·¥ä½œç©ºé—´ï¼ˆWorkspaceï¼‰** æ˜¯é¡¹ç›®å†…çš„é€»è¾‘éš”ç¦»å•å…ƒï¼Œå¯¹åº” Kubernetes çš„ Namespaceã€‚æ¯ä¸ªå·¥ä½œç©ºé—´å¯ä»¥è¿›ä¸€æ­¥ç»†åˆ†èµ„æºé…é¢ï¼Œå¹¶æ”¯æŒ LimitRange é…ç½®ï¼Œå®ç° Pod å’Œ Container çº§åˆ«çš„èµ„æºé™åˆ¶ã€‚

### èµ„æºè¶…åˆ†ï¼ˆOvercommitï¼‰

æ”¯æŒ CPUã€å†…å­˜ã€GPU çš„è¶…åˆ†é…ç½®ï¼Œå…è®¸ä¸ºé¡¹ç›®åˆ†é…è¶…è¿‡é›†ç¾¤ç‰©ç†å®¹é‡çš„èµ„æºé…é¢ã€‚é€šè¿‡åˆç†çš„è¶…åˆ†æ¯”ä¾‹é…ç½®ï¼Œå¯ä»¥æ˜¾è‘—æé«˜é›†ç¾¤èµ„æºåˆ©ç”¨ç‡ï¼Œé™ä½åŸºç¡€è®¾æ–½æˆæœ¬ã€‚å¹³å°æä¾›è¶…åˆ†æ”¶ç›Šåˆ†æåŠŸèƒ½ï¼Œç›´è§‚å±•ç¤ºè¶…åˆ†å¸¦æ¥çš„èµ„æºèŠ‚çº¦å’ŒæŠ•èµ„å›æŠ¥ã€‚

### å®Œæ•´çš„ RBAC æƒé™ä½“ç³»

åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ï¼Œå®ç°ç”¨æˆ·ã€è§’è‰²ã€æƒé™ä¸‰å±‚æ¶æ„ã€‚æ”¯æŒèœå•æƒé™ä¸ API æƒé™çš„ç‹¬ç«‹ç®¡æ§ï¼Œè§’è‰²å¯ç»‘å®šå¤šç§æƒé™ç»„åˆã€‚ç”¨æˆ·å¯å…³è”å¤šä¸ªè§’è‰²ï¼Œæƒé™è‡ªåŠ¨èšåˆã€‚å‰ç«¯èœå•æ ¹æ®è§’è‰²æƒé™åŠ¨æ€æ¸²æŸ“ï¼Œåç«¯æ¥å£å®ç°è¯·æ±‚çº§åˆ«çš„æƒé™æ ¡éªŒã€‚

## äºŒã€å¤šé›†ç¾¤ç®¡ç†

### é›†ç¾¤æ¥å…¥

æ”¯æŒå¤šç§é›†ç¾¤æ¥å…¥æ–¹å¼ï¼Œé€‚åº”ä¸åŒçš„å®‰å…¨ç­–ç•¥å’Œè¿ç»´åœºæ™¯ï¼š

* **Kubeconfig**ï¼šç›´æ¥ä½¿ç”¨ kubeconfig æ–‡ä»¶æ¥å…¥ï¼Œé€‚åˆè‡ªå»ºé›†ç¾¤
* **Token**ï¼šä½¿ç”¨ ServiceAccount Token æ¥å…¥ï¼Œé€‚åˆå—é™ç¯å¢ƒ
* **è¯ä¹¦è®¤è¯**ï¼šä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦æ¥å…¥ï¼Œé€‚åˆé«˜å®‰å…¨è¦æ±‚åœºæ™¯
* **InCluster**: é›†ç¾¤å†…éƒ¨é€šè¿‡ sa å¯ç›´æ¥çº³ç®¡ã€‚

### é›†ç¾¤èµ„æºè§†å›¾

æä¾›é›†ç¾¤èµ„æºçš„å…¨å±€è§†å›¾ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹åˆ—è¡¨ã€èµ„æºä½¿ç”¨ç‡ã€é…é¢åˆ†é…æƒ…å†µç­‰ã€‚æ”¯æŒèŠ‚ç‚¹æ ‡ç­¾ã€æ±¡ç‚¹ã€æ³¨è§£çš„ç®¡ç†ï¼Œä»¥åŠèŠ‚ç‚¹å°é”ã€é©±é€ç­‰è¿ç»´æ“ä½œã€‚

### ç½‘ç»œä¸å­˜å‚¨

è‡ªåŠ¨å‘ç°é›†ç¾¤çš„ç½‘ç»œé…ç½®å’Œå‘½åç©ºé—´åˆ—è¡¨ã€‚æ”¯æŒ StorageClassã€PersistentVolumeã€PersistentVolumeClaim çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

## ä¸‰ã€å·¥ä½œè´Ÿè½½ç®¡ç†

### å…¨ç±»å‹å·¥ä½œè´Ÿè½½æ”¯æŒ

è¦†ç›– Kubernetes æ‰€æœ‰å·¥ä½œè´Ÿè½½ç±»å‹ï¼š

* **Deployment**ï¼šæ— çŠ¶æ€åº”ç”¨ç®¡ç†ï¼Œæ”¯æŒæ»šåŠ¨æ›´æ–°ä¸ç‰ˆæœ¬å›æ»š
* **StatefulSet**ï¼šæœ‰çŠ¶æ€åº”ç”¨ç¼–æ’ï¼Œæä¾›ç¨³å®šç½‘ç»œæ ‡è¯†ä¸æŒä¹…åŒ–å­˜å‚¨
* **DaemonSet**ï¼šèŠ‚ç‚¹çº§å®ˆæŠ¤è¿›ç¨‹ç®¡ç†ï¼Œç¡®ä¿é›†ç¾¤å…¨è¦†ç›–
* **Job / CronJob**ï¼šæ‰¹å¤„ç†ä»»åŠ¡ä¸å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒ–ï¼Œå®Œæ•´ç”Ÿå‘½å‘¨æœŸæ§åˆ¶
* **Pod**ï¼šç›´æ¥ Pod æ“ä½œï¼Œæ”¯æŒè°ƒè¯•ã€ä¸´æ—¶å®¹å™¨æ³¨å…¥ç­‰é«˜çº§æ’éšœ

### åº”ç”¨å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†

æä¾›å¯åœã€é‡å¯ã€æ‰©ç¼©å®¹ã€æ»šåŠ¨æ›´æ–°ç­‰æ ‡å‡†æ“ä½œã€‚å®Œæ•´çš„ç‰ˆæœ¬å†å²è¿½è¸ªï¼Œæ”¯æŒä¸€é”®å›æ»šåˆ°ä»»æ„å†å²ç‰ˆæœ¬ã€‚é•œåƒæ‰¹é‡æ›´æ–°åŠŸèƒ½ï¼Œç®€åŒ–å¤šæœåŠ¡åŒæ—¶å‡çº§çš„æµç¨‹ã€‚

### åº”ç”¨ç¼–æ’èƒ½åŠ›

**ç¯å¢ƒå˜é‡æ³¨å…¥**ï¼šæ”¯æŒå­—é¢é‡ã€ConfigMapã€Secretã€å­—æ®µå¼•ç”¨ç­‰å¤šç§æ¥æºçš„ç¯å¢ƒå˜é‡æ³¨å…¥ã€‚

**å¥åº·æ£€æŸ¥**ï¼šå®Œæ•´æ”¯æŒ Livenessã€Readinessã€Startup ä¸‰ç§æ¢é’ˆçš„é…ç½®å’Œç®¡ç†ã€‚

**è°ƒåº¦ç­–ç•¥**ï¼šæä¾›èŠ‚ç‚¹é€‰æ‹©å™¨ã€èŠ‚ç‚¹äº²å’Œæ€§ã€Pod äº²å’Œ/åäº²å’Œã€æ±¡ç‚¹å®¹å¿ã€æ‹“æ‰‘åˆ†å¸ƒçº¦æŸç­‰é«˜çº§è°ƒåº¦èƒ½åŠ›ã€‚

**å­˜å‚¨å·é…ç½®**ï¼šæ”¯æŒ EmptyDirã€HostPathã€ConfigMapã€Secretã€PVCã€NFS ç­‰å¤šç§å·ç±»å‹çš„é…ç½®å’ŒæŒ‚è½½ã€‚

## å››ã€é…ç½®ä¸ç½‘ç»œ

### é…ç½®ç®¡ç†

**ConfigMap**ï¼šåº”ç”¨é…ç½®ç®¡ç†ï¼Œæ”¯æŒä½¿ç”¨è¿½è¸ªå’Œä¾èµ–åˆ†æã€‚

**Secret**ï¼šæ•æ„Ÿæ•°æ®å®‰å…¨ç®¡ç†ï¼Œæ”¯æŒç±»å‹è¿‡æ»¤å’Œå¼•ç”¨è¿½è¸ªã€‚

### æœåŠ¡å‘ç°ä¸æµé‡ç®¡ç†

**Service**ï¼šæ”¯æŒ ClusterIPã€NodePortã€LoadBalancerã€ExternalName ç­‰æœåŠ¡ç±»å‹ï¼Œæä¾› Endpoint å¯è§†åŒ–ã€‚

**Ingress**ï¼šHTTP/HTTPS è·¯ç”±ç®¡ç†ï¼Œæ”¯æŒ TLS è¯ä¹¦ç®¡ç†å’Œ IngressClass é…ç½®ã€‚

## äº”ã€å¼¹æ€§ä¼¸ç¼©

### æ°´å¹³ Pod è‡ªåŠ¨ä¼¸ç¼©ï¼ˆHPAï¼‰

åŸºäºèµ„æºçš„ä¼¸ç¼©ï¼ˆCPUã€å†…å­˜ï¼‰ï¼Œæ”¯æŒè‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆPodsã€Objectã€Externalï¼‰ã€‚å¯é…ç½®å®¹å™¨çº§èµ„æºæŒ‡æ ‡ï¼Œæä¾›ä¼¸ç¼©è¡Œä¸ºå’Œç¨³å®šçª—å£çš„ç²¾ç»†åŒ–æ§åˆ¶ã€‚

### å‚ç›´ Pod è‡ªåŠ¨ä¼¸ç¼©ï¼ˆVPAï¼‰

è‡ªåŠ¨èµ„æºæ¨èï¼Œæ ¹æ®å†å²ä½¿ç”¨æƒ…å†µä¼˜åŒ–èµ„æºé…ç½®ã€‚æ”¯æŒå®¹å™¨çº§èµ„æºç­–ç•¥ï¼Œæä¾› Offã€Initialã€Recreateã€Auto å¤šç§æ›´æ–°æ¨¡å¼ã€‚å¯é…ç½®èµ„æºè¾¹ç•Œï¼Œç¡®ä¿èµ„æºè°ƒæ•´åœ¨å®‰å…¨èŒƒå›´å†…ã€‚

## å…­ã€ç°åº¦å‘å¸ƒ

### Flagger é›†æˆ

åŸç”Ÿé›†æˆ Flaggerï¼Œæä¾›è‡ªåŠ¨åŒ–çš„æ¸è¿›å¼å‘å¸ƒèƒ½åŠ›ï¼š

**é‡‘ä¸é›€å‘å¸ƒ**ï¼šæ¸è¿›å¼æµé‡åˆ‡æ¢ï¼Œè‡ªåŠ¨åŒ–æŒ‡æ ‡åˆ†æï¼Œå®æ—¶ç›‘æ§æ–°ç‰ˆæœ¬å¥åº·çŠ¶å†µã€‚

**A/B æµ‹è¯•**ï¼šåŸºäº Header çš„æµé‡è·¯ç”±ï¼Œæ”¯æŒç‰¹æ€§éªŒè¯å’Œç”¨æˆ·ä½“éªŒå¯¹æ¯”ã€‚

**è“ç»¿éƒ¨ç½²**ï¼šé›¶åœæœºå‘å¸ƒï¼Œæ”¯æŒå³æ—¶å›æ»šï¼Œé™ä½å‘å¸ƒé£é™©ã€‚

**è‡ªåŠ¨å›æ»š**ï¼šåŸºäºæŒ‡æ ‡çš„æ•…éšœæ£€æµ‹ä¸æ¢å¤ï¼Œå‘ç°é—®é¢˜è‡ªåŠ¨å›æ»šåˆ°ç¨³å®šç‰ˆæœ¬ã€‚

**Webhook é›†æˆ**ï¼šæ”¯æŒè‡ªå®šä¹‰éªŒè¯é—¨ç¦å’Œé€šçŸ¥ï¼Œä¸ CI/CD æµæ°´çº¿æ— ç¼å¯¹æ¥ã€‚

## ä¸ƒã€æ™ºèƒ½å‘Šè­¦

### å¤šæ¸ é“é€šçŸ¥

æ”¯æŒ 8 ç§ä¸»æµé€šçŸ¥æ¸ é“ï¼Œæ»¡è¶³ä¸åŒå›¢é˜Ÿçš„åä½œä¹ æƒ¯ï¼š

* **é’‰é’‰**ï¼šé’‰é’‰æœºå™¨äºº Webhook
* **ä¼ä¸šå¾®ä¿¡**ï¼šä¼ä¸šå¾®ä¿¡æœºå™¨äºº
* **é£ä¹¦**ï¼šé£ä¹¦æœºå™¨äºº Webhook
* **é‚®ä»¶**ï¼šSMTP é‚®ä»¶é€šçŸ¥
* **çŸ­ä¿¡**ï¼šçŸ­ä¿¡ç½‘å…³é›†æˆ
* **è¯­éŸ³ç”µè¯**ï¼šè¯­éŸ³å‘¼å«é€šçŸ¥
* **Webhook**ï¼šè‡ªå®šä¹‰ HTTP å›è°ƒ
* **ç«™å†…ä¿¡**ï¼šå¹³å°å†…ç½®æ¶ˆæ¯ç³»ç»Ÿ

### æ™ºèƒ½è·¯ç”±

**å‘Šè­¦åˆ†çº§**ï¼šæŒ‰ä¸¥é‡çº§åˆ«ï¼ˆInfo/Warning/Criticalï¼‰é…ç½®ä¸åŒé€šçŸ¥æ¸ é“ï¼Œç¡®ä¿å…³é”®å‘Šè­¦åŠæ—¶è§¦è¾¾ã€‚

**å‘Šè­¦åˆ†ç»„**ï¼šæ”¯æŒè‡ªå®šä¹‰å‘Šè­¦åˆ†ç»„ï¼Œæ·±åº¦å®šåˆ¶åˆ†ç»„å‘Šè­¦è§„åˆ™ã€‚

**æ ‡ç­¾è¿‡æ»¤**ï¼šåŸºäºå‘Šè­¦æ ‡ç­¾çš„æ™ºèƒ½åŒ¹é…ä¸è·¯ç”±ï¼Œå®ç°ç²¾å‡†çš„å‘Šè­¦åˆ†å‘ã€‚

### Alertmanager é›†æˆ

ä¸ Prometheus Alertmanager åŸç”Ÿé›†æˆï¼Œè‡ªåŠ¨è§£æå‘Šè­¦æ ‡ç­¾ï¼Œå…³è”é›†ç¾¤ã€é¡¹ç›®ã€å·¥ä½œç©ºé—´ã€‚å®Œæ•´çš„å‘Šè­¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆfiring â†’ resolvedï¼‰ï¼Œå‘é€è®°å½•å…¨é“¾è·¯è¿½è¸ªã€‚

> \[!warning]
> éœ€è¦æŒ‰ç…§å¹³å°è§„åˆ™è¿›è¡Œæ¥å…¥ã€‚

## å…«ã€ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### å…¨æ–¹ä½ç›‘æ§ä½“ç³»

**Pod ç›‘æ§**ï¼šèµ„æºä½¿ç”¨ç‡ã€ç½‘ç»œæµé‡ã€å­˜å‚¨ I/Oã€å¥åº·çŠ¶æ€å…¨æ–¹ä½ç›‘æ§ã€‚

**Node ç›‘æ§**ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€ç³»ç»ŸæŒ‡æ ‡çš„å®æ—¶ç›‘æ§å’Œå†å²åˆ†æã€‚

**Namespace ç›‘æ§**ï¼šé…é¢ä½¿ç”¨æƒ…å†µã€å·¥ä½œè´Ÿè½½çŠ¶æ€ã€èµ„æº Top æ’è¡Œã€‚

**é›†ç¾¤ç›‘æ§**ï¼šæ§åˆ¶é¢ï¼ˆAPI Serverã€etcdã€Schedulerã€Controller Managerï¼‰å¥åº·çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡ï¼Œé›†ç¾¤èµ„æºå®¹é‡è§„åˆ’ã€‚

**Ingress ç›‘æ§**ï¼šå…¥å£æµé‡ã€è¯·æ±‚æ€§èƒ½ã€é”™è¯¯ç‡ã€TLS è¯ä¹¦çŠ¶æ€ç›‘æ§ã€‚

.....

### Prometheus é›†æˆ

è‡ªåŠ¨é…ç½® Prometheus è¿æ¥ï¼Œæ”¯æŒ Basic Authã€Tokenã€API Key å¤šç§è®¤è¯æ–¹å¼ã€‚PrometheusRule å‘Šè­¦è§„åˆ™ç®¡ç†ï¼ŒProbe é»‘ç›’ç›‘æ§é…ç½®ã€‚

## ä¹ã€Pod è¿ç»´å·¥å…·

### æ—¥å¿—ç®¡ç†

å®æ—¶æ—¥å¿—æµæŸ¥çœ‹ï¼Œæ”¯æŒå¤šå®¹å™¨æ—¥å¿—èšåˆã€‚å†å²æ—¥å¿—æŸ¥è¯¢ï¼Œæ”¯æŒæ—¶é—´èŒƒå›´å’Œå…³é”®å­—è¿‡æ»¤ã€‚æ—¥å¿—ä¸‹è½½åŠŸèƒ½ï¼Œä¾¿äºç¦»çº¿åˆ†æå’Œå½’æ¡£ã€‚

### äº¤äº’å¼ç»ˆç«¯

Web ç»ˆç«¯ç›´æ¥è¿æ¥å®¹å™¨ï¼Œæ‰§è¡Œå‘½ä»¤è¿›è¡Œè°ƒè¯•å’Œæ’éšœã€‚æ”¯æŒå¤šå®¹å™¨é€‰æ‹©ï¼Œä¸´æ—¶å®¹å™¨æ³¨å…¥ã€‚

### æ–‡ä»¶ç®¡ç†

å®¹å™¨æ–‡ä»¶ç³»ç»Ÿæµè§ˆï¼Œæ”¯æŒæ–‡ä»¶å’Œç›®å½•çš„æŸ¥çœ‹ã€‚æ–‡ä»¶ç¼–è¾‘ã€ä¸Šä¼ ã€ä¸‹è½½åŠŸèƒ½ï¼Œæ”¯æŒæ–‡ä»¶å‹ç¼©å’Œè§£å‹ã€‚

## åã€é•œåƒä»“åº“ç®¡ç†

### Harbor é›†æˆ

æ”¯æŒå¤šä¸ª Harbor ä»“åº“çš„ç»Ÿä¸€ç®¡ç†ï¼Œå®ç°é¡¹ç›®çº§æƒé™éš”ç¦»ã€‚

### é•œåƒç”Ÿå‘½å‘¨æœŸ

å®Œæ•´çš„é•œåƒç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬é•œåƒæ¸…ç†ç­–ç•¥ï¼ˆGCï¼‰ã€ä¿ç•™ç­–ç•¥é…ç½®ã€è·¨ä»“åº“é•œåƒå¤åˆ¶ã€‚

## åä¸€ã€å®¡è®¡ä¸åˆè§„

### å››çº§å®¡è®¡æ—¥å¿—

å®Œæ•´çš„æ“ä½œå®¡è®¡ä½“ç³»ï¼Œè¦†ç›–é›†ç¾¤ã€é¡¹ç›®ã€å·¥ä½œç©ºé—´ã€åº”ç”¨å››ä¸ªå±‚çº§ã€‚

### å¤šç»´åº¦æŸ¥è¯¢

æ”¯æŒæŒ‰æ—¶é—´ã€æ“ä½œè€…ã€æ“ä½œç±»å‹ã€èµ„æºç±»å‹ç­‰å¤šç»´åº¦æŸ¥è¯¢å’Œè¿‡æ»¤ã€‚æ‰€æœ‰æ“ä½œè®°å½•æ”¯æŒè¿½æº¯ï¼Œæ»¡è¶³ä¼ä¸šåˆè§„è¦æ±‚ã€‚

## åäºŒã€Istio æœåŠ¡ç½‘æ ¼ï¼ˆè§„åˆ’ä¸­ï¼‰

### æµé‡æ²»ç†

æœåŠ¡ç½‘æ ¼å¯è§†åŒ–ç®¡ç†ï¼Œæä¾›æµé‡è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœæ³¨å…¥ç­‰èƒ½åŠ›ã€‚

### å®‰å…¨ç­–ç•¥

mTLS åŠ å¯†é€šä¿¡ï¼Œè®¿é—®æ§åˆ¶ç­–ç•¥ç®¡ç†ã€‚

### å¯è§‚æµ‹æ€§

åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªï¼ŒæœåŠ¡æ‹“æ‰‘å¯è§†åŒ–ã€‚

***

## æŠ€æœ¯æ ˆ

### åç«¯

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ |
|------|---------|
| å¼€å‘è¯­è¨€ | Go 1.25.5+ |
| å¾®æœåŠ¡æ¡†æ¶ | Go-Zero v1.9.4 |
| æ•°æ®åº“ | MySQL 8.0+ |
| ç¼“å­˜ | Redis 7.0+ |
| è®¤è¯æœºåˆ¶ | JWTï¼ˆåŒä»¤ç‰Œæœºåˆ¶ï¼‰ |
| API åè®® | RESTful HTTP + gRPC |

### å‰ç«¯

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ |
|------|---------|
| æ¡†æ¶ | Vue 3.x |
| UI æ¡†æ¶ | Art Design Pro |

### åŸºç¡€è®¾æ–½

| ç»„ä»¶ | è¦æ±‚ |
|------|------|
| Kubernetes | 1.21+ |
| Prometheus | å¯é€‰ï¼Œç”¨äºç›‘æ§ |
| Alertmanager | å¯é€‰ï¼Œç”¨äºå‘Šè­¦ |
| Harbor | å¯é€‰ï¼Œç”¨äºé•œåƒç®¡ç† |
| Istio | å¯é€‰ï¼Œç”¨äºæœåŠ¡ç½‘æ ¼ |

***

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/05.è´¹ç”¨ç®¡ç†.md
---

> \[!DANGER]
> æ³¨æ„: è´¹ç”¨é…ç½®ä¸èµ·åˆ°å®é™…çš„ä½œç”¨ã€‚
>
> åªåšäºä¼ä¸šå†…éƒ¨èµ„æºæˆæœ¬ç®¡ç†çš„ç²—ç•¥ç»Ÿè®¡ã€‚

è´¹ç”¨é…ç½®ï¼Œå¯ä»¥é€šè¿‡é›†ç¾¤ç®¡ç† - è´¹ç”¨é…ç½®è‡ªå®šä¹‰è´¹ç”¨é…ç½®åˆ—è¡¨

è´¹ç”¨å¯ä»¥ç»‘å®šåœ¨é¡¹ç›®é›†ç¾¤èµ„æºä¸Šä¹Ÿå¯ä»¥ç»‘å®šåœ¨é›†ç¾¤ä¸­ã€‚å…·ä½“å¦‚ä¸‹å›¾

![image.png](https://images.ikubeops.com/static/20260117223446330.png)

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/13.é…ç½®ç®¡ç†.md
---

# é…ç½®ç®¡ç†

âœ¨ **ç‰¹æ€§:**

* ç»Ÿä¸€é…ç½®ä¸­å¿ƒ: ConfigMapã€Secretã€Serviceã€Ingress ç­‰èµ„æºé›†ä¸­ç®¡ç†
* å¯è§†åŒ–ç¼–è¾‘: å‘Šåˆ«å‘½ä»¤è¡Œï¼Œè¡¨å•åŒ–åˆ›å»ºå’Œç¼–è¾‘ Kubernetes èµ„æº
* å¼•ç”¨è¿½è¸ª: ä¸€é”®æŸ¥çœ‹èµ„æºè¢«å“ªäº›å·¥ä½œè´Ÿè½½å¼•ç”¨
* YAML å¯¼å‡º: æ”¯æŒä¸‹è½½èµ„æºçš„å®Œæ•´ YAML é…ç½®
* RBAC ç®¡ç†: ServiceAccountã€Roleã€RoleBinding æƒé™é…ç½®

## æ¦‚è¿°

é…ç½®ç®¡ç†æ˜¯ Kube Nova ä¸­ç”¨äºç®¡ç† Kubernetes é…ç½®ç±»èµ„æºçš„ç»Ÿä¸€å…¥å£ã€‚åœ¨ Kubernetes ä¸­ï¼Œåº”ç”¨çš„è¿è¡Œä¸ä»…ä¾èµ–å·¥ä½œè´Ÿè½½æœ¬èº«ï¼Œè¿˜éœ€è¦å„ç§é…ç½®èµ„æºçš„æ”¯æ’‘ï¼ŒåŒ…æ‹¬é…ç½®æ•°æ®ã€å¯†é’¥å‡­è¯ã€ç½‘ç»œæœåŠ¡ã€å­˜å‚¨å·ã€è®¿é—®æƒé™ç­‰ã€‚

ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œè¿ç»´äººå‘˜éœ€è¦ä½¿ç”¨ kubectl å‘½ä»¤æˆ–ç¼–å†™ YAML æ–‡ä»¶æ¥ç®¡ç†è¿™äº›èµ„æºï¼Œä¸ä»…æ“ä½œç¹çï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚é…ç½®ç®¡ç†æ¨¡å—å°†è¿™äº›èµ„æºè¿›è¡Œå¯è§†åŒ–å°è£…ï¼Œé€šè¿‡ç›´è§‚çš„è¡¨å•ç•Œé¢å®Œæˆèµ„æºçš„åˆ›å»ºã€ç¼–è¾‘ã€æŸ¥çœ‹å’Œåˆ é™¤æ“ä½œï¼Œå¤§å¹…é™ä½äº† Kubernetes çš„ä½¿ç”¨é—¨æ§›ã€‚

**æ“ä½œè·¯å¾„**ï¼šä¸šåŠ¡ä¸­å¿ƒ â†’ é…ç½®ç®¡ç†

### é¡µé¢å¸ƒå±€

é…ç½®ç®¡ç†é¡µé¢é¡¶éƒ¨æä¾›ç­›é€‰æ¡ä»¶ï¼Œç”¨äºå®šä½ç›®æ ‡èµ„æºï¼š

**é›†ç¾¤é€‰æ‹©** é€‰æ‹©è¦ç®¡ç†çš„ç›®æ ‡é›†ç¾¤ï¼Œä¸åŒé›†ç¾¤çš„èµ„æºç›¸äº’ç‹¬ç«‹ã€‚

**å·¥ä½œç©ºé—´é€‰æ‹©** é€‰æ‹©å·¥ä½œç©ºé—´ï¼ˆå¯¹åº” Kubernetes Namespaceï¼‰ï¼Œé…ç½®èµ„æºéƒ½æ˜¯å‘½åç©ºé—´çº§åˆ«çš„èµ„æºã€‚

é¡µé¢ä¸»ä½“åŒºåŸŸé€šè¿‡æ ‡ç­¾é¡µåˆ‡æ¢ä¸åŒçš„èµ„æºç±»å‹ï¼šConfigMapã€Secretã€Serviceã€Ingressã€PVCã€ServiceAccountã€Roleã€RoleBindingã€‚æ¯ä¸ªæ ‡ç­¾é¡µéƒ½æä¾›ç‹¬ç«‹çš„èµ„æºåˆ—è¡¨å’Œç®¡ç†åŠŸèƒ½ã€‚

***

## ConfigMap ç®¡ç†

ConfigMap æ˜¯ Kubernetes ä¸­ç”¨äºå­˜å‚¨éæ•æ„Ÿé…ç½®æ•°æ®çš„èµ„æºå¯¹è±¡ã€‚å®ƒå¯ä»¥å­˜å‚¨é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°ç­‰é…ç½®ä¿¡æ¯ï¼Œå¹¶ä»¥é”®å€¼å¯¹çš„å½¢å¼ä¾› Pod ä½¿ç”¨ã€‚

### ä½¿ç”¨åœºæ™¯

ConfigMap é€‚ç”¨äºå­˜å‚¨åº”ç”¨ç¨‹åºçš„é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼ˆéå¯†ç éƒ¨åˆ†ï¼‰ã€åº”ç”¨é…ç½®æ–‡ä»¶ã€ç‰¹æ€§å¼€å…³ã€æ—¥å¿—çº§åˆ«è®¾ç½®ç­‰ã€‚é€šè¿‡å°†é…ç½®ä¸å®¹å™¨é•œåƒåˆ†ç¦»ï¼Œå¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€æ›´æ–°ï¼Œè€Œæ— éœ€é‡æ–°æ„å»ºé•œåƒã€‚

### èµ„æºåˆ—è¡¨

ConfigMap åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º ConfigMap çš„åç§°ï¼Œå¦‚ `coredns`ã€`kube-proxy` ç­‰ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º ConfigMap æ‰€å±çš„å‘½åç©ºé—´ã€‚

**æ•°æ®é¡¹** æ˜¾ç¤º ConfigMap ä¸­åŒ…å«çš„é”®å€¼å¯¹æ•°é‡ï¼Œç‚¹å‡»å¯æŸ¥çœ‹å…·ä½“å†…å®¹ã€‚

**è¿è¡Œæ—¶é•¿** æ˜¾ç¤º ConfigMap ä»åˆ›å»ºåˆ°ç°åœ¨çš„æ—¶é•¿ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º ConfigMap çš„åˆ›å»ºæ—¶é—´æˆ³ã€‚

### æ“ä½œåŠŸèƒ½

ç‚¹å‡»æ¯è¡Œå³ä¾§çš„æ“ä½œèœå•ï¼Œå¯æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ ConfigMap çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…ƒæ•°æ®ã€æ ‡ç­¾ã€æ³¨è§£å’Œæ‰€æœ‰æ•°æ®é¡¹å†…å®¹ã€‚

**ç¼–è¾‘** ä¿®æ”¹ ConfigMap çš„æ•°æ®é¡¹ï¼Œæ”¯æŒæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤é”®å€¼å¯¹ã€‚ç¼–è¾‘åå¼•ç”¨è¯¥ ConfigMap çš„ Pod ä¼šè‡ªåŠ¨æ„ŸçŸ¥å˜åŒ–ï¼ˆéœ€è¦åº”ç”¨æ”¯æŒé…ç½®çƒ­åŠ è½½ï¼‰ã€‚

**æŸ¥çœ‹å¼•ç”¨** æŸ¥çœ‹å“ªäº›å·¥ä½œè´Ÿè½½ï¼ˆDeploymentã€StatefulSet ç­‰ï¼‰å¼•ç”¨äº†è¯¥ ConfigMapã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œåœ¨åˆ é™¤æˆ–ä¿®æ”¹ ConfigMap å‰ï¼Œå¯ä»¥å…ˆç¡®è®¤å½±å“èŒƒå›´ã€‚

**ä¸‹è½½ YAML** å°† ConfigMap å¯¼å‡ºä¸º YAML æ–‡ä»¶ï¼Œä¾¿äºå¤‡ä»½ã€è¿ç§»æˆ–ç‰ˆæœ¬ç®¡ç†ã€‚

**åˆ é™¤** åˆ é™¤ ConfigMapã€‚åˆ é™¤å‰è¯·ç¡®è®¤æ²¡æœ‰å·¥ä½œè´Ÿè½½æ­£åœ¨å¼•ç”¨ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ Pod å¯åŠ¨å¤±è´¥ã€‚

### åˆ›å»º ConfigMap

ç‚¹å‡»ã€Œæ–°å¢ã€æŒ‰é’®åˆ›å»ºæ–°çš„ ConfigMapï¼š

**åç§°** è¾“å…¥ ConfigMap çš„åç§°ï¼Œéœ€ç¬¦åˆ Kubernetes å‘½åè§„èŒƒã€‚

**æ•°æ®é¡¹** æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹ã€‚é”®æ˜¯æ•°æ®é¡¹çš„åç§°ï¼Œå€¼å¯ä»¥æ˜¯ç®€å•å­—ç¬¦ä¸²æˆ–å®Œæ•´çš„é…ç½®æ–‡ä»¶å†…å®¹ã€‚

> \[!TIP] é…ç½®æ–‡ä»¶å­˜å‚¨æŠ€å·§
> å¦‚æœéœ€è¦å­˜å‚¨å®Œæ•´çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ nginx.confï¼‰ï¼Œå¯ä»¥å°†æ–‡ä»¶åä½œä¸ºé”®ï¼Œæ–‡ä»¶å†…å®¹ä½œä¸ºå€¼ã€‚ä¾‹å¦‚ï¼šé”®ä¸º `nginx.conf`ï¼Œå€¼ä¸ºå®Œæ•´çš„ Nginx é…ç½®å†…å®¹ã€‚

***

## Secret ç®¡ç†

Secret æ˜¯ Kubernetes ä¸­ç”¨äºå­˜å‚¨æ•æ„Ÿä¿¡æ¯çš„èµ„æºå¯¹è±¡ã€‚ä¸ ConfigMap ä¸åŒï¼ŒSecret çš„æ•°æ®ä¼šè¿›è¡Œ Base64 ç¼–ç å­˜å‚¨ï¼Œå¹¶ä¸”åœ¨ etcd ä¸­å¯ä»¥é…ç½®åŠ å¯†å­˜å‚¨ï¼Œæä¾›æ›´é«˜çš„å®‰å…¨æ€§ã€‚

### Secret ç±»å‹

Kubernetes æ”¯æŒå¤šç§ç±»å‹çš„ Secretï¼Œå¹³å°ä¼šé€šè¿‡æ ‡ç­¾æ ‡è¯†ä¸åŒç±»å‹ï¼š

**Opaque** é€šç”¨ç±»å‹ï¼Œç”¨äºå­˜å‚¨ä»»æ„çš„ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®ï¼Œæ˜¯æœ€å¸¸ç”¨çš„ç±»å‹ã€‚

**SA Tokenï¼ˆkubernetes.io/service-account-tokenï¼‰** ServiceAccount çš„è®¿é—®ä»¤ç‰Œï¼Œç”± Kubernetes è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†ã€‚

**Docker Configï¼ˆkubernetes.io/dockerconfigjsonï¼‰** Docker é•œåƒä»“åº“çš„è®¤è¯ä¿¡æ¯ï¼Œç”¨äºæ‹‰å–ç§æœ‰é•œåƒã€‚

**TLSï¼ˆkubernetes.io/tlsï¼‰** TLS è¯ä¹¦å’Œç§é’¥ï¼Œç”¨äº Ingress çš„ HTTPS é…ç½®ã€‚

**Basic Authï¼ˆkubernetes.io/basic-authï¼‰** åŸºæœ¬è®¤è¯ä¿¡æ¯ï¼ŒåŒ…å«ç”¨æˆ·åå’Œå¯†ç ã€‚

### èµ„æºåˆ—è¡¨

Secret åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º Secret çš„åç§°ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º Secret æ‰€å±çš„å‘½åç©ºé—´ã€‚

**ç±»å‹** æ˜¾ç¤º Secret çš„ç±»å‹æ ‡ç­¾ï¼Œä¾¿äºå¿«é€Ÿè¯†åˆ«ç”¨é€”ã€‚

**æ•°æ®é¡¹æ•°é‡** æ˜¾ç¤º Secret ä¸­åŒ…å«çš„æ•°æ®é¡¹æ•°é‡ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º Secret çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ Secret çš„å®Œæ•´ä¿¡æ¯ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæ•æ„Ÿæ•°æ®é»˜è®¤ä»¥æ©ç å½¢å¼æ˜¾ç¤ºï¼Œå¯é€‰æ‹©æ˜¾ç¤ºæ˜æ–‡ã€‚

**ç¼–è¾‘** ä¿®æ”¹ Secret çš„æ•°æ®é¡¹ã€‚ç¼–è¾‘æ—¶å¯ä»¥ç›´æ¥è¾“å…¥æ˜æ–‡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œ Base64 ç¼–ç ã€‚

**æŸ¥çœ‹å¼•ç”¨** æŸ¥çœ‹å“ªäº›å·¥ä½œè´Ÿè½½å¼•ç”¨äº†è¯¥ Secretã€‚

**ä¸‹è½½ YAML** å¯¼å‡º Secret çš„ YAML é…ç½®ã€‚æ³¨æ„ï¼šå¯¼å‡ºçš„ YAML ä¸­æ•°æ®æ˜¯ Base64 ç¼–ç çš„ã€‚

**åˆ é™¤** åˆ é™¤ Secretã€‚

### åˆ›å»º Secret

ç‚¹å‡»ã€Œæ–°å¢ã€æŒ‰é’®åˆ›å»ºæ–°çš„ Secretï¼š

**åç§°** è¾“å…¥ Secret çš„åç§°ã€‚

**ç±»å‹** é€‰æ‹© Secret çš„ç±»å‹ã€‚ä¸åŒç±»å‹ä¼šæœ‰ä¸åŒçš„æ•°æ®é¡¹æ¨¡æ¿ã€‚

**æ•°æ®é¡¹** æ ¹æ®æ‰€é€‰ç±»å‹å¡«å†™æ•°æ®é¡¹ã€‚è¾“å…¥æ˜æ–‡å³å¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç¼–ç ã€‚

> \[!WARNING] å®‰å…¨æç¤º
> è™½ç„¶ Secret æä¾›äº†åŸºæœ¬çš„å®‰å…¨ä¿æŠ¤ï¼Œä½† Base64 ç¼–ç å¹¶éåŠ å¯†ã€‚å¯¹äºé«˜åº¦æ•æ„Ÿçš„æ•°æ®ï¼Œå»ºè®®ç»“åˆå¤–éƒ¨å¯†é’¥ç®¡ç†ç³»ç»Ÿï¼ˆå¦‚ HashiCorp Vaultï¼‰ä½¿ç”¨ï¼Œæˆ–å¯ç”¨ etcd åŠ å¯†ã€‚

***

## Service ç®¡ç†

Service æ˜¯ Kubernetes ä¸­ç”¨äºå®šä¹‰ Pod è®¿é—®ç­–ç•¥çš„æŠ½è±¡å±‚ã€‚ç”±äº Pod çš„ IP åœ°å€æ˜¯åŠ¨æ€åˆ†é…çš„ï¼ŒService æä¾›äº†ç¨³å®šçš„è®¿é—®å…¥å£ï¼Œé€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨å°†æµé‡è·¯ç”±åˆ°åç«¯ Podã€‚

### Service ç±»å‹

**ClusterIP** é»˜è®¤ç±»å‹ï¼Œä»…åœ¨é›†ç¾¤å†…éƒ¨å¯è®¿é—®ã€‚åˆ†é…ä¸€ä¸ªé›†ç¾¤å†…éƒ¨ IP åœ°å€ï¼Œå…¶ä»– Pod å¯ä»¥é€šè¿‡è¯¥ IP æˆ–æœåŠ¡åè®¿é—®ã€‚

**NodePort** åœ¨ ClusterIP çš„åŸºç¡€ä¸Šï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå¼€æ”¾ä¸€ä¸ªé™æ€ç«¯å£ï¼ˆèŒƒå›´ 30000-32767ï¼‰ã€‚å¯ä»¥é€šè¿‡ `<èŠ‚ç‚¹IP>:<NodePort>` ä»é›†ç¾¤å¤–éƒ¨è®¿é—®ã€‚

**LoadBalancer** åœ¨ NodePort çš„åŸºç¡€ä¸Šï¼Œç”±äº‘å‚å•†æä¾›å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ã€‚é€‚ç”¨äºäº‘ç¯å¢ƒï¼Œä¼šåˆ†é…ä¸€ä¸ªå¤–éƒ¨å¯è®¿é—®çš„ IP åœ°å€ã€‚

**ExternalName** å°†æœåŠ¡æ˜ å°„åˆ°å¤–éƒ¨ DNS åç§°ï¼Œä¸åˆ›å»ºä»£ç†ï¼Œç”¨äºè®¿é—®é›†ç¾¤å¤–éƒ¨æœåŠ¡ã€‚

### èµ„æºåˆ—è¡¨

Service åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º Service çš„åç§°ï¼Œå¦‚ `kube-dns`ã€`metrics-server` ç­‰ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º Service æ‰€å±çš„å‘½åç©ºé—´ã€‚

**ç±»å‹** æ˜¾ç¤º Service çš„ç±»å‹ï¼ˆClusterIPã€NodePortã€LoadBalancerï¼‰ã€‚

**é›†ç¾¤ IP** æ˜¾ç¤ºåˆ†é…çš„é›†ç¾¤å†…éƒ¨ IP åœ°å€ã€‚

**å¤–éƒ¨ IP** å¯¹äº LoadBalancer ç±»å‹ï¼Œæ˜¾ç¤ºå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨çš„ IP åœ°å€ã€‚

**ç«¯å£** æ˜¾ç¤º Service æš´éœ²çš„ç«¯å£åˆ—è¡¨ï¼Œæ ¼å¼ä¸º `ç«¯å£/åè®®`ï¼Œå¦‚ `53/UDP,53/TCP,9153/TCP`ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º Service çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ Service çš„å®Œæ•´é…ç½®ï¼ŒåŒ…æ‹¬é€‰æ‹©å™¨ã€ç«¯å£æ˜ å°„ã€ä¼šè¯äº²å’Œæ€§ç­‰ã€‚

**ç¼–è¾‘** ä¿®æ”¹ Service çš„é…ç½®ï¼Œå¦‚ç«¯å£æ˜ å°„ã€æœåŠ¡ç±»å‹ç­‰ã€‚

**æŸ¥çœ‹ Endpoints** æŸ¥çœ‹ Service åç«¯å…³è”çš„ Pod ç«¯ç‚¹åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ¯ä¸ªç«¯ç‚¹çš„ IP å’Œç«¯å£ã€‚è¿™å¯¹äºæ’æŸ¥æœåŠ¡è¿æ¥é—®é¢˜éå¸¸æœ‰ç”¨ã€‚

**ä¸‹è½½ YAML** å¯¼å‡º Service çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ Serviceã€‚

### åˆ›å»º Service

ç‚¹å‡»ã€Œæ–°å¢ã€æŒ‰é’®åˆ›å»ºæ–°çš„ Serviceï¼š

**åç§°** è¾“å…¥ Service çš„åç§°ã€‚

**ç±»å‹** é€‰æ‹© Service ç±»å‹ã€‚

**é€‰æ‹©å™¨** é…ç½®æ ‡ç­¾é€‰æ‹©å™¨ï¼Œå®šä¹‰å“ªäº› Pod å±äºè¯¥ Service çš„åç«¯ã€‚

**ç«¯å£é…ç½®** é…ç½®ç«¯å£æ˜ å°„ï¼ŒåŒ…æ‹¬æœåŠ¡ç«¯å£ã€ç›®æ ‡ç«¯å£ã€åè®®ç­‰ã€‚

***

## Ingress ç®¡ç†

Ingress æ˜¯ Kubernetes ä¸­ç”¨äºç®¡ç†å¤–éƒ¨ HTTP/HTTPS æµé‡è®¿é—®çš„èµ„æºã€‚å®ƒæä¾›äº†åŸºäºåŸŸåå’Œè·¯å¾„çš„è·¯ç”±è§„åˆ™ï¼Œå¯ä»¥å°†å¤–éƒ¨è¯·æ±‚è·¯ç”±åˆ°ä¸åŒçš„ Serviceã€‚

### æ ¸å¿ƒæ¦‚å¿µ

**Ingress Controller** Ingress èµ„æºæœ¬èº«åªæ˜¯ä¸€ç»„è·¯ç”±è§„åˆ™çš„å®šä¹‰ï¼Œéœ€è¦ Ingress Controllerï¼ˆå¦‚ Nginx Ingressã€Traefikï¼‰æ¥å®é™…å¤„ç†æµé‡ã€‚

**Host** å®šä¹‰åŸŸåè§„åˆ™ï¼Œæ”¯æŒç²¾ç¡®åŒ¹é…å’Œé€šé…ç¬¦åŒ¹é…ã€‚

**Path** å®šä¹‰ URL è·¯å¾„è§„åˆ™ï¼Œæ”¯æŒå‰ç¼€åŒ¹é…å’Œç²¾ç¡®åŒ¹é…ã€‚

**TLS** é…ç½® HTTPS è¯ä¹¦ï¼Œå®ç°åŠ å¯†ä¼ è¾“ã€‚

### èµ„æºåˆ—è¡¨

Ingress åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º Ingress çš„åç§°ã€‚

**çŠ¶æ€** æ˜¾ç¤º Ingress çš„å¥åº·çŠ¶æ€ï¼ˆæ­£å¸¸/å¼‚å¸¸ï¼‰ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º Ingress æ‰€å±çš„å‘½åç©ºé—´ã€‚

**Ingress Class** æ˜¾ç¤ºä½¿ç”¨çš„ Ingress Controller ç±»å‹ï¼Œå¦‚ `nginx`ã€‚

**ä¸»æœº/è§„åˆ™** æ˜¾ç¤ºé…ç½®çš„åŸŸåå’Œè·¯ç”±è§„åˆ™æ•°é‡ã€‚ç‚¹å‡»åŸŸåå¯ç›´æ¥è®¿é—®ã€‚

**LoadBalancer åœ°å€** æ˜¾ç¤º Ingress Controller çš„å¤–éƒ¨è®¿é—®åœ°å€ã€‚

**ç«¯å£/TLS** æ˜¾ç¤ºç›‘å¬çš„ç«¯å£ï¼ˆ80/443ï¼‰ä»¥åŠæ˜¯å¦é…ç½®äº† TLSã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º Ingress çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ Ingress çš„å®Œæ•´é…ç½®ï¼ŒåŒ…æ‹¬æ‰€æœ‰è·¯ç”±è§„åˆ™ã€TLS é…ç½®ã€æ³¨è§£ç­‰ã€‚

**ç¼–è¾‘** ä¿®æ”¹ Ingress çš„è·¯ç”±è§„åˆ™å’Œé…ç½®ã€‚

**ä¸‹è½½ YAML** å¯¼å‡º Ingress çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ Ingressã€‚

### åˆ›å»º Ingress

ç‚¹å‡»ã€Œæ–°å¢ Ingressã€æŒ‰é’®åˆ›å»ºæ–°çš„ Ingressï¼š

**åç§°** è¾“å…¥ Ingress çš„åç§°ã€‚

**Ingress Class** é€‰æ‹©è¦ä½¿ç”¨çš„ Ingress Controllerã€‚

**è·¯ç”±è§„åˆ™** é…ç½®åŸŸåå’Œè·¯å¾„è§„åˆ™ï¼š

* **Host**ï¼šè¾“å…¥åŸŸåï¼Œå¦‚ `app.example.com`
* **Path**ï¼šè¾“å…¥è·¯å¾„ï¼Œå¦‚ `/api`
* **Path Type**ï¼šé€‰æ‹©åŒ¹é…ç±»å‹ï¼ˆPrefix/Exact/ImplementationSpecificï¼‰
* **Backend Service**ï¼šé€‰æ‹©åç«¯ Service å’Œç«¯å£

**TLS é…ç½®** é…ç½® HTTPS è¯ä¹¦ï¼š

* **Hosts**ï¼šé€‰æ‹©éœ€è¦å¯ç”¨ TLS çš„åŸŸå
* **Secret**ï¼šé€‰æ‹©åŒ…å«è¯ä¹¦çš„ Secret

***

## PVC ç®¡ç†

PVCï¼ˆPersistentVolumeClaimï¼‰æ˜¯ Kubernetes ä¸­ç”¨äºç”³è¯·æŒä¹…åŒ–å­˜å‚¨çš„èµ„æºã€‚é€šè¿‡ PVCï¼ŒPod å¯ä»¥ä½¿ç”¨æŒä¹…åŒ–å­˜å‚¨å·æ¥ä¿å­˜æ•°æ®ï¼Œå³ä½¿ Pod è¢«åˆ é™¤é‡å»ºï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚

### æ ¸å¿ƒæ¦‚å¿µ

**StorageClass** å­˜å‚¨ç±»å®šä¹‰äº†å­˜å‚¨çš„ç±»å‹å’Œé…ç½®å‚æ•°ï¼Œå¦‚ `nfs-default`ã€`csi-disk` ç­‰ã€‚ä¸åŒçš„å­˜å‚¨ç±»æä¾›ä¸åŒçš„å­˜å‚¨èƒ½åŠ›ã€‚

**Access Modes** è®¿é—®æ¨¡å¼å®šä¹‰äº†å­˜å‚¨å·çš„è®¿é—®æ–¹å¼ï¼š

* **ReadWriteOnce (RWO)**ï¼šå•èŠ‚ç‚¹è¯»å†™
* **ReadOnlyMany (ROX)**ï¼šå¤šèŠ‚ç‚¹åªè¯»
* **ReadWriteMany (RWX)**ï¼šå¤šèŠ‚ç‚¹è¯»å†™

**Volume Mode** å·æ¨¡å¼å®šä¹‰äº†å­˜å‚¨çš„ä½¿ç”¨æ–¹å¼ï¼š

* **Filesystem**ï¼šä½œä¸ºæ–‡ä»¶ç³»ç»ŸæŒ‚è½½
* **Block**ï¼šä½œä¸ºåŸå§‹å—è®¾å¤‡æŒ‚è½½

### èµ„æºåˆ—è¡¨

PVC åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º PVC çš„åç§°ï¼Œå¦‚ `mysql-pvc`ã€`redis-pvc` ç­‰ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º PVC æ‰€å±çš„å‘½åç©ºé—´ã€‚

**çŠ¶æ€** æ˜¾ç¤º PVC çš„ç»‘å®šçŠ¶æ€ï¼š

* `Bound`ï¼ˆç»¿è‰²ï¼‰ï¼šå·²æˆåŠŸç»‘å®šåˆ° PV
* `Pending`ï¼ˆé»„è‰²ï¼‰ï¼šç­‰å¾…ç»‘å®š
* `Lost`ï¼ˆçº¢è‰²ï¼‰ï¼šç»‘å®šçš„ PV å·²ä¸¢å¤±

**ç»‘å®šçš„ PV** æ˜¾ç¤º PVC ç»‘å®šçš„ PersistentVolume åç§°ï¼Œç‚¹å‡»å¯æŸ¥çœ‹ PV è¯¦æƒ…ã€‚

**å®¹é‡** æ˜¾ç¤ºç”³è¯·çš„å­˜å‚¨å®¹é‡ï¼Œå¦‚ `10Gi`ã€`5Gi`ã€‚

**è®¿é—®æ¨¡å¼** æ˜¾ç¤ºå­˜å‚¨å·çš„è®¿é—®æ¨¡å¼ã€‚

**å­˜å‚¨ç±»** æ˜¾ç¤ºä½¿ç”¨çš„å­˜å‚¨ç±»åç§°ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º PVC çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ PVC çš„å®Œæ•´é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚

**å…³è”ä¿¡æ¯** æŸ¥çœ‹å“ªäº› Pod æ­£åœ¨ä½¿ç”¨è¯¥ PVCï¼Œä»¥åŠç»‘å®šçš„ PV è¯¦æƒ…ã€‚

**ç¼–è¾‘** ä¿®æ”¹ PVC çš„é…ç½®ã€‚æ³¨æ„ï¼šæŸäº›å­—æ®µï¼ˆå¦‚å®¹é‡ã€è®¿é—®æ¨¡å¼ï¼‰åœ¨åˆ›å»ºåå¯èƒ½æ— æ³•ä¿®æ”¹ã€‚

**ä¸‹è½½ YAML** å¯¼å‡º PVC çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ PVCã€‚å¦‚æœ PVC æ­£åœ¨è¢« Pod ä½¿ç”¨ï¼Œåˆ é™¤æ“ä½œä¼šè¢«é˜»å¡ï¼Œç›´åˆ° Pod é‡Šæ”¾è¯¥ PVCã€‚

### åˆ›å»º PVC

ç‚¹å‡»ã€Œæ–°å¢ PVCã€æŒ‰é’®åˆ›å»ºæ–°çš„ PVCï¼š

**åç§°** è¾“å…¥ PVC çš„åç§°ã€‚

**å­˜å‚¨ç±»** é€‰æ‹©å­˜å‚¨ç±»ã€‚å¦‚æœé›†ç¾¤é…ç½®äº†é»˜è®¤å­˜å‚¨ç±»ï¼Œå¯ä»¥ç•™ç©ºä½¿ç”¨é»˜è®¤å€¼ã€‚

**è®¿é—®æ¨¡å¼** é€‰æ‹©è®¿é—®æ¨¡å¼ï¼Œéœ€è¦å­˜å‚¨ç±»æ”¯æŒæ‰€é€‰æ¨¡å¼ã€‚

**å®¹é‡** è¾“å…¥ç”³è¯·çš„å­˜å‚¨å®¹é‡ã€‚

> \[!NOTE] PVC æ‰©å®¹
> éƒ¨åˆ†å­˜å‚¨ç±»æ”¯æŒåœ¨çº¿æ‰©å®¹ã€‚å¦‚æœéœ€è¦å¢åŠ  PVC å®¹é‡ï¼Œå¯ä»¥ç¼–è¾‘ PVC ä¿®æ”¹å®¹é‡å€¼ï¼ˆåªèƒ½å¢åŠ ï¼Œä¸èƒ½å‡å°‘ï¼‰ã€‚æ‰©å®¹æ˜¯å¦æ”¯æŒä»¥åŠæ˜¯å¦éœ€è¦é‡å¯ Podï¼Œå–å†³äºå­˜å‚¨ç±»çš„é…ç½®ã€‚

***

## ServiceAccount ç®¡ç†

ServiceAccount æ˜¯ Kubernetes ä¸­ç”¨äº Pod èº«ä»½è®¤è¯çš„èµ„æºã€‚æ¯ä¸ª Pod éƒ½ä¼šå…³è”ä¸€ä¸ª ServiceAccountï¼Œç”¨äºè®¿é—® Kubernetes API å’Œå…¶ä»–éœ€è¦è®¤è¯çš„æœåŠ¡ã€‚

### ä½¿ç”¨åœºæ™¯

ServiceAccount ä¸»è¦ç”¨äºä»¥ä¸‹åœºæ™¯ï¼šä¸ºåº”ç”¨æä¾›è®¿é—® Kubernetes API çš„å‡­è¯ï¼Œé…åˆ RBAC å®ç°ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ï¼Œä»¥åŠä¸º Pod æä¾›æ‹‰å–ç§æœ‰é•œåƒçš„å‡­è¯ï¼ˆé€šè¿‡ imagePullSecretsï¼‰ã€‚

### èµ„æºåˆ—è¡¨

ServiceAccount åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º ServiceAccount çš„åç§°ã€‚æ¯ä¸ªå‘½åç©ºé—´éƒ½æœ‰ä¸€ä¸ªåä¸º `default` çš„é»˜è®¤ ServiceAccountã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º ServiceAccount æ‰€å±çš„å‘½åç©ºé—´ã€‚

**Secrets æ•°é‡** æ˜¾ç¤ºå…³è”çš„ Secret æ•°é‡ï¼ŒåŒ…æ‹¬ API è®¿é—®ä»¤ç‰Œç­‰ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º ServiceAccount çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ ServiceAccount çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…³è”çš„ Secret å’Œ ImagePullSecretã€‚

**ç¼–è¾‘** ä¿®æ”¹ ServiceAccount çš„é…ç½®ï¼Œå¦‚æ·»åŠ  ImagePullSecretã€‚

**ä¸‹è½½ YAML** å¯¼å‡º ServiceAccount çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ ServiceAccountã€‚æ³¨æ„ï¼šåˆ é™¤åä½¿ç”¨è¯¥ ServiceAccount çš„ Pod å°†æ— æ³•æ­£å¸¸è®¿é—® APIã€‚

### åˆ›å»º ServiceAccount

ç‚¹å‡»ã€Œæ–°å¢ ServiceAccountã€æŒ‰é’®åˆ›å»ºæ–°çš„ ServiceAccountï¼š

**åç§°** è¾“å…¥ ServiceAccount çš„åç§°ã€‚

**ImagePullSecrets** å¯é€‰ï¼Œé…ç½®ç”¨äºæ‹‰å–ç§æœ‰é•œåƒçš„ Secretã€‚

***

## Role ç®¡ç†

Role æ˜¯ Kubernetes RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰ä¸­å®šä¹‰æƒé™çš„èµ„æºã€‚Role å®šä¹‰äº†ä¸€ç»„æƒé™è§„åˆ™ï¼ŒæŒ‡å®šäº†å¯ä»¥å¯¹å“ªäº›èµ„æºæ‰§è¡Œå“ªäº›æ“ä½œã€‚

### æ ¸å¿ƒæ¦‚å¿µ

**Role vs ClusterRole** Role æ˜¯å‘½åç©ºé—´çº§åˆ«çš„èµ„æºï¼Œåªèƒ½æˆæƒè®¿é—®åŒä¸€å‘½åç©ºé—´å†…çš„èµ„æºã€‚ClusterRole æ˜¯é›†ç¾¤çº§åˆ«çš„èµ„æºï¼Œå¯ä»¥æˆæƒè®¿é—®é›†ç¾¤èŒƒå›´çš„èµ„æºæˆ–è·¨å‘½åç©ºé—´çš„èµ„æºã€‚

**æƒé™è§„åˆ™** æ¯æ¡è§„åˆ™åŒ…å«ä¸‰ä¸ªè¦ç´ ï¼š

* **apiGroups**ï¼šAPI ç»„ï¼Œå¦‚ `""` è¡¨ç¤ºæ ¸å¿ƒ APIï¼Œ`apps` è¡¨ç¤ºåº”ç”¨ API
* **resources**ï¼šèµ„æºç±»å‹ï¼Œå¦‚ `pods`ã€`deployments`ã€`services`
* **verbs**ï¼šæ“ä½œåŠ¨è¯ï¼Œå¦‚ `get`ã€`list`ã€`create`ã€`update`ã€`delete`

### èµ„æºåˆ—è¡¨

Role åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º Role çš„åç§°ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º Role æ‰€å±çš„å‘½åç©ºé—´ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º Role çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ Role çš„å®Œæ•´æƒé™è§„åˆ™åˆ—è¡¨ã€‚

**å…³è”ä¿¡æ¯** æŸ¥çœ‹å“ªäº› RoleBinding å¼•ç”¨äº†è¯¥ Roleï¼Œä»¥åŠç»‘å®šçš„ä¸»ä½“ï¼ˆç”¨æˆ·ã€ç»„ã€ServiceAccountï¼‰ã€‚

**ç¼–è¾‘** ä¿®æ”¹ Role çš„æƒé™è§„åˆ™ã€‚

**ä¸‹è½½ YAML** å¯¼å‡º Role çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ Roleã€‚åˆ é™¤å‰è¯·ç¡®è®¤æ²¡æœ‰ RoleBinding æ­£åœ¨å¼•ç”¨ã€‚

### åˆ›å»º Role

ç‚¹å‡»ã€Œæ–°å¢ Roleã€æŒ‰é’®åˆ›å»ºæ–°çš„ Roleï¼š

**åç§°** è¾“å…¥ Role çš„åç§°ã€‚

**æƒé™è§„åˆ™** æ·»åŠ ä¸€æ¡æˆ–å¤šæ¡æƒé™è§„åˆ™ï¼Œå®šä¹‰å¯è®¿é—®çš„èµ„æºå’Œæ“ä½œã€‚

***

## RoleBinding ç®¡ç†

RoleBinding ç”¨äºå°† Role ä¸­å®šä¹‰çš„æƒé™æˆäºˆç»™ç”¨æˆ·ã€ç»„æˆ– ServiceAccountã€‚å®ƒå»ºç«‹äº†ã€Œè°ã€ï¼ˆSubjectï¼‰å¯ä»¥ã€Œåšä»€ä¹ˆã€ï¼ˆRoleï¼‰çš„å…³è”å…³ç³»ã€‚

### æ ¸å¿ƒæ¦‚å¿µ

**Subject** æƒé™çš„æˆäºˆå¯¹è±¡ï¼Œå¯ä»¥æ˜¯ï¼š

* **User**ï¼šç”¨æˆ·ï¼Œé€šå¸¸å¯¹åº”è¯ä¹¦ä¸­çš„ CN å­—æ®µ
* **Group**ï¼šç”¨æˆ·ç»„ï¼Œé€šå¸¸å¯¹åº”è¯ä¹¦ä¸­çš„ O å­—æ®µ
* **ServiceAccount**ï¼šæœåŠ¡è´¦æˆ·

**RoleRef** å¼•ç”¨çš„ Role æˆ– ClusterRoleã€‚RoleBinding å¯ä»¥å¼•ç”¨åŒä¸€å‘½åç©ºé—´çš„ Roleï¼Œä¹Ÿå¯ä»¥å¼•ç”¨é›†ç¾¤çº§åˆ«çš„ ClusterRoleï¼ˆæƒé™èŒƒå›´ä»é™äºå½“å‰å‘½åç©ºé—´ï¼‰ã€‚

### èµ„æºåˆ—è¡¨

RoleBinding åˆ—è¡¨å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**åç§°** æ˜¾ç¤º RoleBinding çš„åç§°ã€‚

**å‘½åç©ºé—´** æ˜¾ç¤º RoleBinding æ‰€å±çš„å‘½åç©ºé—´ã€‚

**ç»‘å®šçš„è§’è‰²** æ˜¾ç¤ºå¼•ç”¨çš„ Role æˆ– ClusterRole åç§°ã€‚

**åˆ›å»ºæ—¶é—´** æ˜¾ç¤º RoleBinding çš„åˆ›å»ºæ—¶é—´ã€‚

### æ“ä½œåŠŸèƒ½

**æŸ¥çœ‹è¯¦æƒ…** æŸ¥çœ‹ RoleBinding çš„å®Œæ•´é…ç½®ï¼ŒåŒ…æ‹¬å¼•ç”¨çš„è§’è‰²å’Œæ‰€æœ‰ä¸»ä½“ã€‚

**ç¼–è¾‘** ä¿®æ”¹ RoleBinding çš„ä¸»ä½“åˆ—è¡¨ã€‚æ³¨æ„ï¼šroleRef å­—æ®µåœ¨åˆ›å»ºåä¸å¯ä¿®æ”¹ã€‚

**ä¸‹è½½ YAML** å¯¼å‡º RoleBinding çš„ YAML é…ç½®ã€‚

**åˆ é™¤** åˆ é™¤ RoleBindingã€‚åˆ é™¤åç›¸å…³ä¸»ä½“å°†å¤±å»è¯¥è§’è‰²çš„æƒé™ã€‚

### åˆ›å»º RoleBinding

ç‚¹å‡»ã€Œæ–°å¢ RoleBindingã€æŒ‰é’®åˆ›å»ºæ–°çš„ RoleBindingï¼š

**åç§°** è¾“å…¥ RoleBinding çš„åç§°ã€‚

**è§’è‰²å¼•ç”¨** é€‰æ‹©è¦ç»‘å®šçš„ Role æˆ– ClusterRoleã€‚

**ä¸»ä½“** æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªä¸»ä½“ï¼ŒæŒ‡å®šæƒé™çš„æˆäºˆå¯¹è±¡ã€‚

***

## æœ€ä½³å®è·µ

### ConfigMap å’Œ Secret ä½¿ç”¨å»ºè®®

**åˆ†ç¦»é…ç½®å’Œä»£ç ** å°†åº”ç”¨é…ç½®å¤–ç½®åˆ° ConfigMapï¼Œå®ç°é…ç½®ä¸é•œåƒçš„è§£è€¦ã€‚è¿™æ ·å¯ä»¥åœ¨ä¸é‡æ–°æ„å»ºé•œåƒçš„æƒ…å†µä¸‹æ›´æ–°é…ç½®ã€‚

**æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ Secret** å¯†ç ã€API å¯†é’¥ã€è¯ä¹¦ç­‰æ•æ„Ÿä¿¡æ¯åŠ¡å¿…ä½¿ç”¨ Secret å­˜å‚¨ï¼Œä¸è¦æ”¾åœ¨ ConfigMap æˆ–é•œåƒä¸­ã€‚

**åˆç†æ‹†åˆ†é…ç½®** å°†ç›¸å…³çš„é…ç½®é¡¹ç»„ç»‡åˆ°åŒä¸€ä¸ª ConfigMap ä¸­ï¼Œä½†é¿å…å•ä¸ª ConfigMap è¿‡å¤§ã€‚å»ºè®®æŒ‰åŠŸèƒ½æ¨¡å—æˆ–æ›´æ–°é¢‘ç‡æ‹†åˆ†ã€‚

**é…ç½®çƒ­åŠ è½½** å¦‚æœåº”ç”¨æ”¯æŒé…ç½®çƒ­åŠ è½½ï¼Œå¯ä»¥åˆ©ç”¨ ConfigMap æŒ‚è½½ä¸ºæ–‡ä»¶çš„æ–¹å¼ï¼Œå®ç°é…ç½®çš„åŠ¨æ€æ›´æ–°ã€‚

### Service é…ç½®å»ºè®®

**é€‰æ‹©åˆé€‚çš„ç±»å‹** å†…éƒ¨æœåŠ¡ä½¿ç”¨ ClusterIPï¼Œéœ€è¦å¤–éƒ¨è®¿é—®ä¼˜å…ˆä½¿ç”¨ Ingress + ClusterIP çš„ç»„åˆï¼Œè°¨æ…ä½¿ç”¨ NodePort å’Œ LoadBalancerã€‚

**åˆç†é…ç½®ç«¯å£** ä½¿ç”¨æœ‰æ„ä¹‰çš„ç«¯å£å‘½åï¼ˆå¦‚ `http`ã€`grpc`ï¼‰ï¼Œä¾¿äº Istio ç­‰æœåŠ¡ç½‘æ ¼è¯†åˆ«åè®®ç±»å‹ã€‚

**å¥åº·æ£€æŸ¥ç«¯ç‚¹** ä¸º Service åç«¯çš„ Pod é…ç½®å¥åº·æ£€æŸ¥ï¼Œç¡®ä¿æµé‡åªè·¯ç”±åˆ°å¥åº·çš„å®ä¾‹ã€‚

### å­˜å‚¨ç®¡ç†å»ºè®®

**é€‰æ‹©åˆé€‚çš„å­˜å‚¨ç±»** æ ¹æ®åº”ç”¨çš„ I/O ç‰¹æ€§é€‰æ‹©å­˜å‚¨ç±»å‹ã€‚æ•°æ®åº“ç­‰é«˜ I/O åº”ç”¨ä½¿ç”¨ SSD å­˜å‚¨ï¼Œæ—¥å¿—ç­‰ä½é¢‘è®¿é—®æ•°æ®å¯ä½¿ç”¨ HDD å­˜å‚¨ã€‚

**åˆç†è§„åˆ’å®¹é‡** æ ¹æ®æ•°æ®å¢é•¿é¢„æœŸåˆç†ç”³è¯·å®¹é‡ï¼Œæ—¢è¦é¿å…æµªè´¹ï¼Œä¹Ÿè¦ä¸ºå¢é•¿ç•™æœ‰ä½™é‡ã€‚

**å®šæœŸå¤‡ä»½** æŒä¹…åŒ–å­˜å‚¨è™½ç„¶æ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œä½†ä»éœ€è¦å®šæœŸå¤‡ä»½ä»¥é˜²æ­¢è¯¯åˆ é™¤æˆ–æ•°æ®æŸåã€‚

### RBAC é…ç½®å»ºè®®

**æœ€å°æƒé™åŸåˆ™** åªæˆäºˆå¿…è¦çš„æœ€å°æƒé™ï¼Œé¿å…ä½¿ç”¨è¿‡äºå®½æ³›çš„æƒé™ï¼ˆå¦‚ `*`ï¼‰ã€‚

**ä½¿ç”¨ ServiceAccount** ä¸ºæ¯ä¸ªåº”ç”¨åˆ›å»ºç‹¬ç«‹çš„ ServiceAccountï¼Œå¹¶é…ç½®ä¸“å±çš„æƒé™ï¼Œé¿å…ä½¿ç”¨ default ServiceAccountã€‚

**å®šæœŸå®¡è®¡** å®šæœŸå®¡æŸ¥ Role å’Œ RoleBinding é…ç½®ï¼Œæ¸…ç†ä¸å†éœ€è¦çš„æƒé™æˆæƒã€‚

***

## å¸¸è§é—®é¢˜

### ConfigMap æ›´æ–°å Pod ä¸ºä»€ä¹ˆæ²¡æœ‰æ„ŸçŸ¥åˆ°ï¼Ÿ

ConfigMap æ›´æ–°åï¼ŒPod æ„ŸçŸ¥å˜åŒ–çš„æ–¹å¼å–å†³äºæŒ‚è½½æ–¹å¼ã€‚å¦‚æœé€šè¿‡ç¯å¢ƒå˜é‡å¼•ç”¨ï¼ŒPod ä¸ä¼šè‡ªåŠ¨æ„ŸçŸ¥å˜åŒ–ï¼Œéœ€è¦é‡å¯ Podã€‚å¦‚æœé€šè¿‡ Volume æŒ‚è½½ä¸ºæ–‡ä»¶ï¼ŒKubernetes ä¼šåœ¨å‡ åˆ†é’Ÿå†…è‡ªåŠ¨æ›´æ–°æ–‡ä»¶å†…å®¹ï¼Œä½†åº”ç”¨æ˜¯å¦èƒ½æ„ŸçŸ¥å–å†³äºåº”ç”¨æœ¬èº«çš„å®ç°ã€‚

### PVC ä¸€ç›´å¤„äº Pending çŠ¶æ€æ€ä¹ˆåŠï¼Ÿ

PVC Pending é€šå¸¸æœ‰ä»¥ä¸‹åŸå› ï¼šå­˜å‚¨ç±»ä¸å­˜åœ¨æˆ–é…ç½®é”™è¯¯ï¼Œå­˜å‚¨åç«¯å®¹é‡ä¸è¶³ï¼Œè®¿é—®æ¨¡å¼ä¸è¢«å­˜å‚¨ç±»æ”¯æŒï¼Œæˆ–è€…æ²¡æœ‰å¯ç”¨çš„ PV æ»¡è¶³ PVC çš„è¦æ±‚ã€‚å¯ä»¥é€šè¿‡ `kubectl describe pvc` æŸ¥çœ‹è¯¦ç»†çš„äº‹ä»¶ä¿¡æ¯æ¥å®šä½é—®é¢˜ã€‚

### å¦‚ä½•æŸ¥çœ‹ ServiceAccount çš„ Tokenï¼Ÿ

åœ¨ Kubernetes 1.24 ä¹‹åï¼ŒServiceAccount ä¸å†è‡ªåŠ¨åˆ›å»º Token Secretã€‚å¦‚éœ€è·å– Tokenï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç±»å‹ä¸º `kubernetes.io/service-account-token` çš„ Secret å¹¶å…³è”åˆ° ServiceAccountï¼Œæˆ–è€…ä½¿ç”¨ `kubectl create token` å‘½ä»¤ç”Ÿæˆä¸´æ—¶ Tokenã€‚

### Ingress é…ç½®åæ— æ³•è®¿é—®æ€ä¹ˆæ’æŸ¥ï¼Ÿ

æ’æŸ¥æ­¥éª¤åŒ…æ‹¬ï¼šç¡®è®¤ Ingress Controller æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œæ£€æŸ¥ Ingress è§„åˆ™æ˜¯å¦æ­£ç¡®é…ç½®ï¼Œç¡®è®¤åç«¯ Service å’Œ Pod æ˜¯å¦æ­£å¸¸ï¼Œæ£€æŸ¥åŸŸåè§£ææ˜¯å¦æ­£ç¡®æŒ‡å‘ Ingress Controller çš„åœ°å€ï¼Œä»¥åŠæŸ¥çœ‹ Ingress Controller çš„æ—¥å¿—å®šä½å…·ä½“é”™è¯¯ã€‚

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/06.é•œåƒç®¡åº“.md
---

# é•œåƒä»“åº“ç®¡ç†

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Kube Nova å¹³å°ä¸­ç®¡ç†å®¹å™¨é•œåƒä»“åº“ï¼ŒåŒ…æ‹¬ä»“åº“é…ç½®ã€é¡¹ç›®ç®¡ç†ã€åˆ¶å“ç®¡ç†å’Œåƒåœ¾å›æ”¶ç­‰åŠŸèƒ½ã€‚

é•œåƒä»“åº“ç®¡ç†åŠŸèƒ½ç”¨äºç®¡ç†å’Œé…ç½®å®¹å™¨é•œåƒä»“åº“ï¼Œæ”¯æŒå¯¹æ¥ Harbor ç­‰ä¸»æµé•œåƒä»“åº“æœåŠ¡ã€‚é€šè¿‡ç»Ÿä¸€ç®¡ç†é•œåƒä»“åº“ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æµè§ˆé¡¹ç›®ã€æŸ¥çœ‹é•œåƒåˆ¶å“ã€ç®¡ç†å­˜å‚¨ç©ºé—´ç­‰ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é•œåƒä»“åº“

âœ¨ **ç‰¹æ€§:**

* å…¬å…±ä»“åº“ä»“æœ¨å…¨å±€å¯è®¿é—®(é›†ç¾¤è¦å…ˆç»‘å®š harbor å®ä¾‹)
* ç§æœ‰ä»“åº“é¡¹ç›®å¯ç»‘å®šå¹³å°é¡¹ç›®ï¼Œå®ç°ä»“åº“éš”ç¦»
* Harbor å¯ç»‘å®šé›†ç¾¤ï¼Œå®ç°é›†ç¾¤ harbor éš”ç¦»

***

## åˆ›å»ºé•œåƒä»“åº“

ç‚¹å‡»ã€Œåˆ›å»ºä»“åº“ã€æŒ‰é’®æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡†ï¼Œé…ç½®ä»¥ä¸‹ä¿¡æ¯ï¼š

### åŸºæœ¬é…ç½®

**ä»“åº“åç§°**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥ä»“åº“çš„æ˜¾ç¤ºåç§°ï¼Œç”¨äºåœ¨å¹³å°ä¸­æ ‡è¯†è¯¥ä»“åº“ã€‚

**ä»“åº“ç±»å‹**ï¼ˆå¿…å¡«ï¼‰ï¼šé€‰æ‹©ä»“åº“ç±»å‹ï¼Œç›®å‰æ”¯æŒ Harborã€‚

**ç¯å¢ƒç±»å‹**ï¼ˆå¿…å¡«ï¼‰ï¼šé€‰æ‹©ä»“åº“æ‰€å±çš„ç¯å¢ƒï¼Œå¯é€‰å¼€å‘ã€æµ‹è¯•ã€é¢„å‘ã€ç”Ÿäº§å››ç§ç¯å¢ƒç±»å‹ã€‚

**ä»“åº“åœ°å€**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥ä»“åº“çš„è®¿é—®åœ°å€ï¼Œä¾‹å¦‚ `https://harbor.example.com`ã€‚

### è®¤è¯é…ç½®

**ç”¨æˆ·å**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥è®¿é—®ä»“åº“çš„ç”¨æˆ·åã€‚

**å¯†ç **ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥è®¿é—®ä»“åº“çš„å¯†ç ã€‚

**è·³è¿‡è¯ä¹¦éªŒè¯**ï¼šå¦‚æœä»“åº“ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œè¯·å¼€å¯æ­¤é€‰é¡¹ã€‚å¼€å¯åå°†è·³è¿‡ TLS è¯ä¹¦éªŒè¯ã€‚

**CA è¯ä¹¦**ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœä¸è·³è¿‡è¯ä¹¦éªŒè¯ï¼Œå¯ä»¥ç²˜è´´ CA è¯ä¹¦å†…å®¹ç”¨äºéªŒè¯ä»“åº“çš„ TLS è¯ä¹¦ã€‚

### å…¶ä»–é…ç½®

**çŠ¶æ€**ï¼šè®¾ç½®ä»“åº“çš„å¯ç”¨çŠ¶æ€ï¼Œå¯é€‰ç¦ç”¨æˆ–å¯ç”¨ã€‚ç¦ç”¨åè¯¥ä»“åº“å°†ä¸å¯ç”¨äºé•œåƒæ‹‰å–ç­‰æ“ä½œã€‚

**æè¿°**ï¼ˆå¯é€‰ï¼‰ï¼šè¾“å…¥ä»“åº“çš„æè¿°ä¿¡æ¯ã€‚

é…ç½®å®Œæˆåï¼Œå»ºè®®ç‚¹å‡»ã€Œæµ‹è¯•è¿æ¥ã€éªŒè¯ä»“åº“è¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œç¡®è®¤æ— è¯¯åç‚¹å‡»ã€Œåˆ›å»ºã€å®Œæˆåˆ›å»ºã€‚

***

## ä»“åº“åˆ—è¡¨

ä»“åº“åˆ—è¡¨é¡µé¢å±•ç¤ºæ‰€æœ‰å·²é…ç½®çš„é•œåƒä»“åº“ï¼Œæ”¯æŒå¡ç‰‡è§†å›¾å’Œåˆ—è¡¨è§†å›¾ä¸¤ç§å±•ç¤ºæ–¹å¼ã€‚

### ä»“åº“å¡ç‰‡ä¿¡æ¯

æ¯ä¸ªä»“åº“ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

**ä»“åº“æ ‡è¯†**ï¼šä»“åº“åç§°ã€çŠ¶æ€ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰ã€ä»“åº“åœ°å€ï¼ˆå¯å¤åˆ¶ï¼‰ã€‚

**ä»“åº“æ ‡ç­¾**ï¼šæ˜¾ç¤ºä»“åº“ç±»å‹ï¼ˆå¦‚ Harborï¼‰ã€ç¯å¢ƒç±»å‹ï¼ˆå¦‚ å¼€å‘ï¼‰ã€è¯ä¹¦éªŒè¯çŠ¶æ€ï¼ˆå¦‚ è·³è¿‡éªŒè¯ï¼‰ã€‚

**ç»Ÿè®¡ä¿¡æ¯**ï¼šé¡¹ç›®æ•°é‡ã€ä»“åº“æ•°é‡ï¼ˆé•œåƒä»“åº“æ€»æ•°ï¼‰ã€å­˜å‚¨ä½¿ç”¨é‡ã€‚

**ç®¡ç†ä¿¡æ¯**ï¼šç®¡ç†å‘˜ç”¨æˆ·åã€åˆ›å»ºæ—¶é—´ã€‚

### æœç´¢ä¸ç­›é€‰

é¡µé¢é¡¶éƒ¨æä¾›å¤šç»´åº¦ç­›é€‰åŠŸèƒ½ï¼šæŒ‰åç§°æœç´¢ä»“åº“ã€æŒ‰ç¯å¢ƒç±»å‹ç­›é€‰ã€æŒ‰ä»“åº“ç±»å‹ç­›é€‰ã€æŒ‰çŠ¶æ€ç­›é€‰ã€‚

### ä»“åº“æ“ä½œ

æ¯ä¸ªä»“åº“å¡ç‰‡åº•éƒ¨æä¾›ä»¥ä¸‹æ“ä½œï¼š

**ç®¡ç†**ï¼šè¿›å…¥ä»“åº“çš„é¡¹ç›®ç®¡ç†é¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹å’Œç®¡ç†ä»“åº“ä¸­çš„æ‰€æœ‰é¡¹ç›®ã€‚

**ç»‘å®š**ï¼šå°†ä»“åº“ç»‘å®šåˆ°ç‰¹å®šçš„é›†ç¾¤æˆ–é¡¹ç›®ï¼Œä½¿å…¶å¯ä»¥è¢«ä½¿ç”¨ã€‚

**æ›´å¤šæ“ä½œ**ï¼ˆç‚¹å‡»ä¸‰ç‚¹èœå•ï¼‰ï¼šç¼–è¾‘ä»“åº“é…ç½®ã€åˆ é™¤ä»“åº“ç­‰ã€‚

***

## é¡¹ç›®ç®¡ç†

ç‚¹å‡»ä»“åº“å¡ç‰‡çš„ã€Œç®¡ç†ã€æŒ‰é’®è¿›å…¥é¡¹ç›®ç®¡ç†é¡µé¢ã€‚é¡¹ç›®ç®¡ç†é¡µé¢åŒ…å«å…­ä¸ªæ ‡ç­¾é¡µï¼šé¡¹ç›®è¯¦æƒ…ã€é¡¹ç›®ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€åƒåœ¾å›æ”¶ã€ä¿ç•™ç­–ç•¥ã€å¤åˆ¶ç­–ç•¥ã€‚

### é¡¹ç›®è¯¦æƒ…

é¡¹ç›®è¯¦æƒ…æ ‡ç­¾é¡µå±•ç¤ºä»“åº“çš„æ•´ä½“æ¦‚è§ˆä¿¡æ¯ã€‚

**ç»Ÿè®¡æ¦‚è§ˆ**å±•ç¤ºå››ä¸ªæ ¸å¿ƒæŒ‡æ ‡ï¼šé¡¹ç›®æ€»æ•°ï¼ˆä»“åº“ä¸­çš„é¡¹ç›®æ•°é‡ï¼‰ã€ä»“åº“æ€»æ•°ï¼ˆæ‰€æœ‰é¡¹ç›®ä¸­çš„é•œåƒä»“åº“æ€»æ•°ï¼‰ã€ç§æœ‰é¡¹ç›®ï¼ˆè®¿é—®æƒé™ä¸ºç§æœ‰çš„é¡¹ç›®æ•°é‡ï¼‰ã€å…¬å¼€é¡¹ç›®ï¼ˆè®¿é—®æƒé™ä¸ºå…¬å¼€çš„é¡¹ç›®æ•°é‡ï¼‰ã€‚

**å­˜å‚¨ä¿¡æ¯**å±•ç¤ºä»“åº“çš„å­˜å‚¨ä½¿ç”¨æƒ…å†µï¼šæ€»å®¹é‡ã€å·²ä½¿ç”¨ç©ºé—´ã€å¯ç”¨ç©ºé—´ã€ä½¿ç”¨ç‡ã€‚å­˜å‚¨ä¿¡æ¯ä»¥ç¯å½¢å›¾ç›´è§‚å±•ç¤ºä½¿ç”¨æ¯”ä¾‹ã€‚

**åŸºæœ¬ä¿¡æ¯**å±•ç¤ºä»“åº“çš„é…ç½®è¯¦æƒ…ï¼ŒåŒ…æ‹¬ä»“åº“åœ°å€ã€ç±»å‹ã€è®¤è¯æ–¹å¼ç­‰ã€‚

### é¡¹ç›®ç®¡ç†

é¡¹ç›®ç®¡ç†æ ‡ç­¾é¡µå±•ç¤ºä»“åº“ä¸­æ‰€æœ‰é¡¹ç›®çš„åˆ—è¡¨ã€‚

**åˆ—è¡¨å­—æ®µ**åŒ…æ‹¬ï¼šé¡¹ç›®åç§°ï¼ˆå¸¦ ID æ ‡è¯†ï¼‰ã€è®¿é—®æƒé™ï¼ˆå…¬å¼€/ç§æœ‰ï¼‰ã€å·²ç”¨é…é¢ï¼ˆå½“å‰å­˜å‚¨ä½¿ç”¨é‡ï¼‰ã€é…é¢é™åˆ¶ï¼ˆå­˜å‚¨é…é¢ä¸Šé™ï¼Œæ— é™åˆ¶è¡¨ç¤ºä¸é™åˆ¶ï¼‰ã€æ‹¥æœ‰è€…ã€ä»“åº“æ•°é‡ã€æ“ä½œã€‚

**é¡¹ç›®æ“ä½œ**æ ¹æ®é¡¹ç›®ç±»å‹æœ‰æ‰€ä¸åŒï¼š

å¯¹äºå…¬å¼€é¡¹ç›®ï¼šåˆ†é…ç”¨æˆ·ï¼ˆç®¡ç†é¡¹ç›®æˆå‘˜æƒé™ï¼‰ã€æŸ¥çœ‹ï¼ˆè¿›å…¥åˆ¶å“ç®¡ç†é¡µé¢ï¼‰ã€ç¼–è¾‘ã€é…é¢ç®¡ç†ã€åˆ é™¤ã€‚

å¯¹äºç§æœ‰é¡¹ç›®ï¼šé¢å¤–æ˜¾ç¤ºã€Œç»‘å®šé¡¹ç›®ã€æŒ‰é’®ï¼Œç”¨äºå°†ä»“åº“é¡¹ç›®ä¸å¹³å°é¡¹ç›®å…³è”ã€‚

**åˆ›å»ºé¡¹ç›®**ï¼šç‚¹å‡»é¡µé¢å³ä¸Šè§’ã€Œåˆ›å»ºé¡¹ç›®ã€æŒ‰é’®å¯ä»¥åœ¨ä»“åº“ä¸­åˆ›å»ºæ–°é¡¹ç›®ã€‚

### ç”¨æˆ·ç®¡ç†

ç”¨æˆ·ç®¡ç†æ ‡ç­¾é¡µç”¨äºç®¡ç†ä»“åº“çš„ç”¨æˆ·å’Œæƒé™ã€‚å¯ä»¥æ·»åŠ ç”¨æˆ·ã€åˆ†é…è§’è‰²ã€ç®¡ç†è®¿é—®æƒé™ç­‰ã€‚

### åƒåœ¾å›æ”¶

åƒåœ¾å›æ”¶åŠŸèƒ½ç”¨äºæ¸…ç†æœªä½¿ç”¨çš„é•œåƒå±‚å’Œåˆ¶å“ï¼Œé‡Šæ”¾å­˜å‚¨ç©ºé—´ã€‚

**ä»»åŠ¡åˆ—è¡¨**å±•ç¤ºåƒåœ¾å›æ”¶ä»»åŠ¡çš„æ‰§è¡Œå†å²ï¼ŒåŒ…æ‹¬ï¼šä»»åŠ¡åç§°ã€ä»»åŠ¡ç±»å‹ï¼ˆSCHEDULE è¡¨ç¤ºå®šæ—¶ä»»åŠ¡ï¼‰ã€çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥/è¿è¡Œä¸­ï¼‰ã€åˆ é™¤æ— æ ‡ç­¾é•œåƒï¼ˆæ˜¯/å¦ï¼‰ã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€æ“ä½œï¼ˆè¯¦æƒ…ã€æ—¥å¿—ï¼‰ã€‚

**æ“ä½œåŠŸèƒ½**ï¼š

ã€Œç«‹å³æ‰§è¡Œ GCã€æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡åƒåœ¾å›æ”¶ä»»åŠ¡ã€‚

ã€Œè°ƒåº¦é…ç½®ã€é…ç½®å®šæ—¶åƒåœ¾å›æ”¶çš„æ‰§è¡Œè®¡åˆ’ï¼Œä¾‹å¦‚æ¯å¤©å‡Œæ™¨æ‰§è¡Œã€‚

ã€Œåˆ·æ–°ã€åˆ·æ–°ä»»åŠ¡åˆ—è¡¨ã€‚

### ä¿ç•™ç­–ç•¥

ä¿ç•™ç­–ç•¥ç”¨äºé…ç½®é•œåƒçš„è‡ªåŠ¨æ¸…ç†è§„åˆ™ï¼Œä¾‹å¦‚ä¿ç•™æœ€è¿‘ N ä¸ªç‰ˆæœ¬ã€ä¿ç•™æœ€è¿‘ N å¤©çš„é•œåƒç­‰ã€‚é€šè¿‡åˆç†é…ç½®ä¿ç•™ç­–ç•¥ï¼Œå¯ä»¥è‡ªåŠ¨æ¸…ç†æ—§ç‰ˆæœ¬é•œåƒï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚

### å¤åˆ¶ç­–ç•¥

å¤åˆ¶ç­–ç•¥ç”¨äºé…ç½®é•œåƒåœ¨ä¸åŒä»“åº“ä¹‹é—´çš„åŒæ­¥è§„åˆ™ã€‚å¯ä»¥è®¾ç½®æºä»“åº“ã€ç›®æ ‡ä»“åº“ã€å¤åˆ¶è§¦å‘æ¡ä»¶ï¼ˆæ‰‹åŠ¨/å®šæ—¶/äº‹ä»¶è§¦å‘ï¼‰ç­‰ï¼Œå®ç°é•œåƒçš„è·¨ä»“åº“åˆ†å‘ã€‚

***

## åˆ¶å“ç®¡ç†

åœ¨é¡¹ç›®ç®¡ç†é¡µé¢ç‚¹å‡»é¡¹ç›®çš„ã€ŒæŸ¥çœ‹ã€æŒ‰é’®ï¼Œè¿›å…¥åˆ¶å“ç®¡ç†é¡µé¢ã€‚

### ä»“åº“åˆ—è¡¨

åˆ¶å“ç®¡ç†é¡µé¢å±•ç¤ºé¡¹ç›®ä¸­çš„æ‰€æœ‰é•œåƒä»“åº“ï¼Œæ”¯æŒå¡ç‰‡è§†å›¾å’Œåˆ—è¡¨è§†å›¾ã€‚

**ä»“åº“å¡ç‰‡ä¿¡æ¯**åŒ…æ‹¬ï¼šä»“åº“åç§°ï¼ˆæ ¼å¼ä¸º `é¡¹ç›®å/é•œåƒå`ï¼Œå¦‚ `argocd/dex`ï¼‰ã€æè¿°ä¿¡æ¯ã€åˆ¶å“æ•°é‡ï¼ˆè¯¥ä»“åº“ä¸­çš„é•œåƒæ ‡ç­¾æ•°é‡ï¼‰ã€æ‹‰å–æ¬¡æ•°ï¼ˆé•œåƒè¢«æ‹‰å–çš„æ€»æ¬¡æ•°ï¼‰ã€æœ€åæ›´æ–°æ—¶é—´ã€‚

**ä»“åº“æ“ä½œ**ï¼šç‚¹å‡»ã€ŒæŸ¥çœ‹ã€æŒ‰é’®æŸ¥çœ‹ä»“åº“ä¸­çš„æ‰€æœ‰åˆ¶å“ï¼ˆé•œåƒæ ‡ç­¾ï¼‰ã€‚

### åˆ¶å“åˆ—è¡¨

ç‚¹å‡»ä»“åº“çš„ã€ŒæŸ¥çœ‹ã€æŒ‰é’®ï¼Œæ‰“å¼€åˆ¶å“åˆ—è¡¨å¯¹è¯æ¡†ï¼Œå±•ç¤ºè¯¥ä»“åº“ä¸­çš„æ‰€æœ‰é•œåƒæ ‡ç­¾ã€‚

**åˆ—è¡¨å­—æ®µ**åŒ…æ‹¬ï¼šæ ‡ç­¾ï¼ˆé•œåƒç‰ˆæœ¬å·ï¼Œå¦‚ v2.38.0ã€v2.41.1ï¼‰ã€ç±»å‹ï¼ˆIMAGE è¡¨ç¤ºå®¹å™¨é•œåƒï¼‰ã€æ‘˜è¦ï¼ˆé•œåƒçš„ SHA256 æ‘˜è¦ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ï¼‰ã€å¤§å°ï¼ˆé•œåƒæ–‡ä»¶å¤§å°ï¼‰ã€æ¨é€æ—¶é—´ã€æ‹‰å–æ¬¡æ•°ã€æ“ä½œã€‚

**åˆ¶å“æ“ä½œ**ï¼š

ã€Œå¤åˆ¶ã€å¤åˆ¶é•œåƒçš„å®Œæ•´æ‹‰å–åœ°å€åˆ°å‰ªè´´æ¿ï¼Œæ–¹ä¾¿åœ¨éƒ¨ç½²æ—¶ä½¿ç”¨ã€‚

ã€Œåˆ é™¤ã€åˆ é™¤è¯¥é•œåƒæ ‡ç­¾ã€‚åˆ é™¤åæ— æ³•æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œã€‚

***

## ä»“åº“ç»‘å®š

ä»“åº“ç»‘å®šåŠŸèƒ½ç”¨äºå°†é•œåƒä»“åº“ä¸ Kube Nova å¹³å°ä¸­çš„é›†ç¾¤æˆ–é¡¹ç›®å…³è”ï¼Œä½¿é›†ç¾¤èƒ½å¤Ÿä»è¯¥ä»“åº“æ‹‰å–é•œåƒã€‚

### ç»‘å®šåˆ°é›†ç¾¤

å°†ä»“åº“ç»‘å®šåˆ°é›†ç¾¤åï¼Œè¯¥é›†ç¾¤ä¸­çš„å·¥ä½œè´Ÿè½½å¯ä»¥ä½¿ç”¨æ­¤ä»“åº“ä¸­çš„é•œåƒã€‚ç»‘å®šæ—¶ä¼šè‡ªåŠ¨åœ¨é›†ç¾¤ä¸­åˆ›å»ºå¯¹åº”çš„ Secretï¼Œç”¨äºé•œåƒæ‹‰å–è®¤è¯ã€‚

### ç»‘å®šåˆ°é¡¹ç›®

å°†ä»“åº“ä¸­çš„é¡¹ç›®ä¸å¹³å°é¡¹ç›®å…³è”åï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„å‘½åç©ºé—´ä¸­ç›´æ¥ä½¿ç”¨è¯¥ä»“åº“çš„é•œåƒï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®é•œåƒæ‹‰å–å¯†é’¥ã€‚

***

## æœ€ä½³å®è·µ

### ç¯å¢ƒéš”ç¦»

å»ºè®®æŒ‰ç¯å¢ƒç±»å‹é…ç½®ä¸åŒçš„é•œåƒä»“åº“ï¼Œå¼€å‘ç¯å¢ƒä½¿ç”¨å¼€å‘ä»“åº“ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç”Ÿäº§ä»“åº“ï¼Œé¿å…å¼€å‘é•œåƒè¯¯éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

### å­˜å‚¨ç®¡ç†

å®šæœŸæ‰§è¡Œåƒåœ¾å›æ”¶æ¸…ç†æ— ç”¨é•œåƒå±‚ã€‚é…ç½®åˆç†çš„ä¿ç•™ç­–ç•¥è‡ªåŠ¨æ¸…ç†æ—§ç‰ˆæœ¬é•œåƒã€‚ç›‘æ§å­˜å‚¨ä½¿ç”¨æƒ…å†µï¼ŒåŠæ—¶æ‰©å®¹æˆ–æ¸…ç†ã€‚

### å®‰å…¨é…ç½®

ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨æ­£è§„ CA ç­¾å‘çš„è¯ä¹¦ï¼Œé¿å…è·³è¿‡è¯ä¹¦éªŒè¯ã€‚ä¸ºä¸åŒç”¨é€”åˆ›å»ºä¸åŒçš„ä»“åº“è´¦æˆ·ï¼Œéµå¾ªæœ€å°æƒé™åŸåˆ™ã€‚ç§æœ‰é¡¹ç›®åº”é™åˆ¶è®¿é—®æƒé™ï¼Œåªå¯¹å¿…è¦çš„ç”¨æˆ·å¼€æ”¾ã€‚

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/01.é›†ç¾¤ç®¡ç†.md
---

# é›†ç¾¤ç®¡ç†

âœ¨ **ç‰¹æ€§:**

* å¤šç§è®¤è¯æ–¹å¼: kubeconfig, token, è¯ä¹¦ï¼Œ inCluster
* é›†ç¾¤æ•´ä½“å…¨æ–¹ä½ç›‘æ§é¢æ¿
* èµ„æºç®¡ç†
* åŒæ­¥åŠŸèƒ½

## é›†ç¾¤æ·»åŠ 

Kube Nova æ”¯æŒå°†ç°æœ‰çš„ Kubernetes é›†ç¾¤æ·»åŠ åˆ°ç®¡ç†å¹³å°ä¸­è¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤ç®¡ç† â†’ æ–°å¢é›†ç¾¤

æ·»åŠ é›†ç¾¤çš„æµç¨‹åˆ†ä¸ºä¸ƒä¸ªæ­¥éª¤ï¼šé€‰æ‹©é›†ç¾¤ç±»å‹ â†’ åŸºç¡€ä¿¡æ¯ â†’ è®¤è¯é…ç½® â†’ è´¹ç”¨é…ç½® â†’ ç›‘æ§é…ç½® â†’ ç®¡æ§é…ç½® â†’ å®Œæˆã€‚

### æ­¥éª¤ä¸€ï¼šé€‰æ‹©é›†ç¾¤ç±»å‹

åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œæ‚¨éœ€è¦é…ç½®é›†ç¾¤çš„åŸºæœ¬ç±»å‹å’Œéƒ¨ç½²ä¿¡æ¯ã€‚

**é›†ç¾¤ç±»å‹** é€‰é¡¹åŒ…æ‹¬ä¸‰ç§ï¼šã€Œæ ‡å‡†é›†ç¾¤ã€é€‚ç”¨äºå¸¸è§„å·¥ä½œè´Ÿè½½ï¼Œæä¾›å®Œæ•´åŠŸèƒ½ï¼›ã€Œè¾¹ç¼˜é›†ç¾¤ã€éƒ¨ç½²åœ¨è¾¹ç¼˜èŠ‚ç‚¹ï¼Œå…·æœ‰ä½å»¶è¿Ÿé«˜æ€§èƒ½ç‰¹ç‚¹ï¼›ã€Œæ— æœåŠ¡å™¨ã€æŒ‰éœ€ä»˜è´¹ï¼Œæ”¯æŒè‡ªåŠ¨ä¼¸ç¼©ï¼Œå…è¿ç»´ã€‚

**è¿è¡Œç¯å¢ƒ** ç”¨äºæ ‡è¯†é›†ç¾¤ç”¨é€”ï¼Œå¯é€‰æ‹©ï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€é¢„å‘å¸ƒç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒã€‚

**åŸºç¡€è®¾æ–½æä¾›å•†**  AWSã€Azureã€Google Cloudã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ï¼Œä»¥åŠè‡ªå»ºé›†ç¾¤ã€‚

### æ­¥éª¤äºŒï¼šåŸºç¡€ä¿¡æ¯

é…ç½®é›†ç¾¤çš„åŸºæœ¬æ ‡è¯†å’Œæ˜¾ç¤ºä¿¡æ¯ã€‚

**é›†ç¾¤åç§°**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥é›†ç¾¤çš„å”¯ä¸€æ ‡è¯†åç§°ï¼Œä¾‹å¦‚ `prod-k8s-cluster`ã€‚

**é›†ç¾¤æè¿°**ï¼ˆå¯é€‰ï¼‰ï¼šæè¿°é›†ç¾¤çš„ç”¨é€”ã€ç‰¹ç‚¹ç­‰ä¿¡æ¯ï¼Œæœ€å¤š 500 å­—ç¬¦ã€‚

**ä½ç½®ä¿¡æ¯**ï¼ˆå¯é€‰ï¼‰ï¼šåŒ…æ‹¬åœ°åŸŸï¼ˆå¦‚ `cn-beijing`ï¼‰ã€å¯ç”¨åŒºï¼ˆå¦‚ `zone-a`ï¼‰ã€æ•°æ®ä¸­å¿ƒã€‚

**è´Ÿè½½é…ç½®**ï¼ˆå¯é€‰ï¼‰ï¼šé…ç½® Ingress åŸŸåï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰ã€Node è´Ÿè½½å‡è¡¡åœ°å€ã€Master è´Ÿè½½å‡è¡¡åœ°å€ã€‚

**æ‰˜ç®¡é›†ç¾¤**ï¼šæ ‡è¯†æ˜¯å¦ä¸ºäº‘å‚å•†æ‰˜ç®¡é›†ç¾¤ï¼ˆå¦‚ EKSã€AKSã€GKEï¼‰ï¼Œé»˜è®¤ä¸ºã€Œå¦ã€ã€‚

### æ­¥éª¤ä¸‰ï¼šè®¤è¯é…ç½®

è®¾ç½®é›†ç¾¤çš„è®¿é—®è®¤è¯æ–¹å¼ã€‚å¹³å°æ”¯æŒå››ç§è®¤è¯ç±»å‹ï¼š

**æ”¯æŒå¤šç§äº‘å¹³å°ï¼š** ä½¿ç”¨ KubeConfig æ–‡ä»¶è¿›è¡Œè®¤è¯ï¼ŒåŒ…å«å®Œæ•´çš„é›†ç¾¤è®¿é—®ä¿¡æ¯ï¼Œæ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚åœ¨æ–‡æœ¬æ¡†ä¸­ç²˜è´´å®Œæ•´çš„ KubeConfig æ–‡ä»¶å†…å®¹å³å¯ã€‚

**ã€ŒTokenã€** ä½¿ç”¨ Bearer Token è¿›è¡Œè®¤è¯ï¼Œéœ€è¦é¢å¤–æä¾› API Server åœ°å€ã€‚

**ã€Œè¯ä¹¦ã€** ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦å’Œå¯†é’¥è¿›è¡ŒåŒå‘ TLS è®¤è¯ã€‚

**ã€Œé›†ç¾¤å†…éƒ¨ã€** åœ¨é›†ç¾¤å†…éƒ¨è¿è¡Œæ—¶ï¼Œä½¿ç”¨ ServiceAccount è¿›è¡Œè®¤è¯ã€‚

é…ç½®å®Œæˆåï¼Œå»ºè®®ç‚¹å‡» **ã€Œæµ‹è¯•è¿é€šæ€§ã€** éªŒè¯é›†ç¾¤å¯è¾¾æ€§ã€‚è¯·æ³¨æ„ï¼Œç”Ÿäº§ç¯å¢ƒä¸æ¨èå‹¾é€‰ **ã€Œè·³è¿‡ TLS è¯ä¹¦éªŒè¯ã€** é€‰é¡¹ã€‚

### æ­¥éª¤å››ï¼šè´¹ç”¨é…ç½®

**è´¹ç”¨ç®¡ç†ç« èŠ‚** ä¼šè¯¦ç»†ä»‹ç»è®¡è´¹ç›¸å…³é…ç½®ã€‚

é€‰æ‹©é›†ç¾¤çš„è®¡è´¹ä»·æ ¼é…ç½®ï¼Œæ­¤é…ç½®å°†ç”¨äºèµ„æºè®¡è´¹ç»Ÿè®¡ã€‚

**æ ‡å‡†è®¡è´¹**ï¼ˆç³»ç»Ÿå†…ç½®ï¼‰ï¼šç³»ç»Ÿé»˜è®¤æä¾›çš„è®¡è´¹æ–¹æ¡ˆï¼Œä»·æ ¼å‚è€ƒå¦‚ä¸‹ï¼šCPU Â¥0.05/æ ¸/æ—¶ã€å†…å­˜ Â¥0.015/GiB/æ—¶ã€å­˜å‚¨ Â¥0.001/GiB/æ—¶ã€GPU Â¥15/å¡/æ—¶ã€Pod Â¥0.002/ä¸ª/æ—¶ã€ç®¡ç†è´¹ Â¥3.1/æ—¶ã€‚

**ä¸è®¡è´¹**ï¼ˆç³»ç»Ÿå†…ç½®ï¼‰ï¼šæ‰€æœ‰èµ„æºè®¡è´¹ä¸ºé›¶ï¼Œç³»ç»Ÿé»˜è®¤ä¸æ¨èä¿®æ”¹æ­¤é€‰é¡¹ã€‚

**è®¡è´¹å¼€å§‹æ—¶é—´**ï¼šé€‰æ‹©è®¡è´¹çš„èµ·å§‹æ—¶é—´ï¼Œç•™ç©ºåˆ™é»˜è®¤ä»é›†ç¾¤åˆ›å»ºæ—¶é—´å¼€å§‹è®¡è´¹ã€‚

### æ­¥éª¤äº”ï¼šç›‘æ§é…ç½®

é…ç½® Prometheus ç›‘æ§è¿æ¥ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ã€‚æ‚¨å¯ä»¥é€‰æ‹©ç«‹å³ã€Œé…ç½® Prometheusã€å¯ç”¨ç›‘æ§åŠŸèƒ½ï¼Œæˆ–è€…é€‰æ‹©ã€Œè·³è¿‡æ­¤æ­¥éª¤ã€ç¨ååœ¨ä¸­é—´ä»¶ç®¡ç†ä¸­é…ç½®ã€‚

å¦‚æœé€‰æ‹©è·³è¿‡ï¼Œè¯·æ³¨æ„ï¼šæ·»åŠ é›†ç¾¤åéœ€è¦åœ¨é›†ç¾¤ç®¡ç†ä¸­è¿›å…¥é›†ç¾¤æ§åˆ¶å°çš„ã€Œä¸­é—´ä»¶ç®¡ç†ã€é¡µé¢é…ç½® Prometheus è¿æ¥ä¿¡æ¯å¹¶è®¾ç½®ä¸ºé»˜è®¤ï¼Œå¦åˆ™ç›‘æ§åŠŸèƒ½ä¸å¯ç”¨ã€‚è¯·ç¡®ä¿ Prometheus æœåŠ¡å¯è¢« Kube Nova ç®¡ç†å¹³å°æ­£å¸¸è¿æ¥ã€‚

### æ­¥éª¤å…­ï¼šç®¡æ§é…ç½®

é…ç½®é›†ç¾¤èµ„æºåˆ›å»ºç®¡æ§ç­–ç•¥ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ²»ç†é€‰é¡¹ã€‚

**å¯ç”¨é›†ç¾¤ç®¡æ§**ï¼šå¹³å°å°†ç®¡æ§è¯¥é›†ç¾¤çš„èµ„æºåˆ›å»ºï¼Œåªå…è®¸é€šè¿‡å¹³å°åˆ›å»ºèµ„æºã€‚ç®¡æ§ç”Ÿæ•ˆåï¼Œé›†ç¾¤ä¸­çš„èµ„æºåªèƒ½é€šè¿‡ Kube Nova ç®¡ç†å¹³å°åˆ›å»ºï¼Œç›´æ¥ä½¿ç”¨ kubectl æˆ–å…¶ä»–å·¥å…·åˆ›å»ºèµ„æºå°†è¢«æ‹’ç»ã€‚å¦‚éœ€ä¸´æ—¶ç»•è¿‡ç®¡æ§é™åˆ¶ï¼Œå¯åœ¨èµ„æºä¸Šæ·»åŠ æ³¨è§£ï¼š`ikubeops.com/allow-create: "true"`ã€‚å¯ç”¨ç®¡æ§åï¼Œè¯·ç¡®ä¿ç›¸å…³è¿ç»´äººå‘˜äº†è§£è¯¥ç­–ç•¥ï¼Œé¿å…å› åˆ›å»ºèµ„æºè¢«æ‹’ç»è€Œå½±å“ä¸šåŠ¡ã€‚

**ä¸å¯ç”¨ç®¡æ§**ï¼šé›†ç¾¤èµ„æºå¯é€šè¿‡ä»»ä½•æ–¹å¼åˆ›å»ºï¼ˆkubectlã€Helmã€CI/CD ç­‰ï¼‰ï¼Œå¹³å°ä¸ä¼šè¿›è¡Œé™åˆ¶ã€‚è¯·æ³¨æ„ï¼Œæœªç»å¹³å°ç®¡æ§çš„èµ„æºå¯èƒ½å¯¼è‡´èµ„æºç»Ÿè®¡ä¸å‡†ç¡®ã€è´¹ç”¨è®¡ç®—é—æ¼ç­‰é—®é¢˜ã€‚å¦‚éœ€å¼€å¯ç®¡æ§ï¼Œå¯ç¨ååœ¨é›†ç¾¤è®¾ç½®ä¸­ä¿®æ”¹ã€‚

### æ­¥éª¤ä¸ƒï¼šå®Œæˆ

ç¡®è®¤å¹¶åˆ›å»ºé›†ç¾¤ã€‚å®Œæˆåé›†ç¾¤å°†å‡ºç°åœ¨é›†ç¾¤ç®¡ç†åˆ—è¡¨ä¸­ã€‚
![é›†ç¾¤åˆ›å»º](https://images.ikubeops.com/static/20260116214426493.png)

***

## é›†ç¾¤ç›‘æ§

é›†ç¾¤ç›‘æ§æä¾›å¯¹ Kubernetes é›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µçš„å®æ—¶ç›‘æ§å’Œå†å²è¶‹åŠ¿åˆ†æã€‚

ç›‘æ§é¡µé¢æä¾›å¤šä¸ªç»´åº¦çš„ç›‘æ§è§†å›¾ï¼Œé€šè¿‡é¡¶éƒ¨æ ‡ç­¾é¡µåˆ‡æ¢ï¼š

* ã€Œé›†ç¾¤èµ„æºã€å±•ç¤º CPUã€å†…å­˜ã€Podã€å­˜å‚¨ç­‰èµ„æºçš„æ•´ä½“ç›‘æ§ï¼ŒåŒ…æ‹¬å®¹é‡ã€å·²ç”¨é‡å’Œä½¿ç”¨ç‡è¶‹åŠ¿å›¾ã€‚
* ã€Œæ§åˆ¶å¹³é¢ã€ç›‘æ§ Kubernetes æ§åˆ¶å¹³é¢ç»„ä»¶çš„è¿è¡ŒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡ã€‚
* ã€ŒEtcdã€å±•ç¤º etcd é›†ç¾¤çš„å¥åº·çŠ¶æ€ã€å»¶è¿Ÿã€ååé‡ç­‰å…³é”®æŒ‡æ ‡ã€‚
* ã€ŒèŠ‚ç‚¹ã€æ˜¾ç¤ºå„èŠ‚ç‚¹çš„èµ„æºä½¿ç”¨æƒ…å†µå’Œå¥åº·çŠ¶æ€ã€‚
* ã€Œå·¥ä½œè´Ÿè½½ã€ç›‘æ§ Deploymentã€StatefulSetã€DaemonSet ç­‰å·¥ä½œè´Ÿè½½çš„è¿è¡ŒçŠ¶æ€ã€‚
* ã€ŒPod & å‘½åç©ºé—´ã€æŒ‰å‘½åç©ºé—´å’Œ Pod ç»´åº¦æŸ¥çœ‹èµ„æºä½¿ç”¨è¯¦æƒ…ã€‚

**æ“ä½œè·¯å¾„**ï¼šä»ªè¡¨ç›˜ â†’ é›†ç¾¤ç›‘æ§ â†’ é€‰æ‹©å¯¹åº”çš„é›†ç¾¤
![é›†ç¾¤ç›‘æ§](https://images.ikubeops.com/static/20260116214938534.png)

***

## ä¸­é—´ä»¶ç®¡ç†

ä¸­é—´ä»¶ç®¡ç†ç”¨äºé…ç½®å’Œç®¡ç†é›†ç¾¤çš„å¯è§‚æµ‹æ€§ç»„ä»¶ï¼ŒåŒ…æ‹¬ç›‘æ§ã€æ—¥å¿—ã€é“¾è·¯è¿½è¸ªå’Œå‘Šè­¦ç­‰ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤ç®¡ç† â†’ é€‰æ‹©å¯¹åº”çš„é›†ç¾¤ â†’ è¿›å…¥æ§åˆ¶å°

ç»„ä»¶åˆ†ç±»:

* **ç›‘æ§ç®¡ç†**ï¼ˆ4 ä¸ªç»„ä»¶ï¼‰ï¼šPrometheus æ˜¯å¼€æºç›‘æ§å’Œå‘Šè­¦å·¥å…·åŒ…ï¼ŒThanos æä¾›é«˜å¯ç”¨æ€§ Prometheus é•¿æœŸå­˜å‚¨ï¼ŒGrafana æ˜¯å¼€æºå¯è§†åŒ–å’Œç›‘æ§å¹³å°ï¼ŒVictoriaMetrics æ˜¯å¿«é€Ÿã€ç»æµé«˜æ•ˆçš„ç›‘æ§è§£å†³æ–¹æ¡ˆã€‚
* **æ—¥å¿—ç®¡ç†**ï¼ˆ4 ä¸ªç»„ä»¶ï¼‰ï¼šElasticsearch æ˜¯åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼ŒLoki æ˜¯æ°´å¹³å¯æ‰©å±•çš„æ—¥å¿—èšåˆç³»ç»Ÿï¼ŒKibana æ˜¯ Elasticsearch æ•°æ®å¯è§†åŒ–å·¥å…·
* **é“¾è·¯è¿½è¸ª**ï¼ˆ3 ä¸ªç»„ä»¶ï¼‰ï¼šJaeger æ˜¯ç«¯åˆ°ç«¯åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼ŒSkyWalking æ˜¯åº”ç”¨æ€§èƒ½ç›‘æ§ç³»ç»Ÿï¼ŒZipkin æ˜¯åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿã€‚
* **å‘Šè­¦ç®¡ç†**ï¼ˆ2 ä¸ªç»„ä»¶ï¼‰ï¼šAlertManager å¤„ç†ç”± Prometheus å‘é€çš„å‘Šè­¦ã€‚

### é»˜è®¤ç»„ä»¶é…ç½®

æ¯ä¸ªåˆ†ç±»ä¸­éœ€è¦è®¾ç½®ä¸€ä¸ªç»„ä»¶ä¸ºé»˜è®¤å¯ç”¨çŠ¶æ€ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå› ä¸ºåç»­å¹³å°è·å–è¯¥é›†ç¾¤çš„ç›‘æ§ã€æ—¥å¿—ç­‰æ•°æ®æ—¶ï¼Œä¼šä»å¯¹åº”åˆ†ç±»çš„ä¸­é—´ä»¶ä¸­æŸ¥æ‰¾é»˜è®¤å¯ç”¨çš„ç»„ä»¶ã€‚å¦‚æœæœªé…ç½®é»˜è®¤ç»„ä»¶ï¼Œç›¸å…³åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚

ä¾‹å¦‚ï¼Œè‹¥è¦ä½¿ç”¨é›†ç¾¤ç›‘æ§åŠŸèƒ½ï¼Œå¿…é¡»åœ¨ã€Œç›‘æ§ç®¡ç†ã€åˆ†ç±»ä¸­é…ç½®å¹¶å¯ç”¨ä¸€ä¸ªç»„ä»¶ï¼ˆå¦‚ Prometheusï¼‰ä½œä¸ºé»˜è®¤ç›‘æ§æºã€‚

### ç»„ä»¶é…ç½®

ç‚¹å‡»å„ç»„ä»¶å¡ç‰‡ä¸Šçš„ã€Œé…ç½®ã€æŒ‰é’®è¿›å…¥é…ç½®é¡µé¢ï¼Œå¡«å†™ç»„ä»¶çš„è¿æ¥ä¿¡æ¯ï¼ˆåœ°å€ã€ç«¯å£ã€è®¤è¯æ–¹å¼ç­‰ï¼‰ã€‚é…ç½®å®Œæˆåï¼Œç»„ä»¶çŠ¶æ€ä¼šä»ã€Œæœªé…ç½®ã€å˜æ›´ä¸ºã€Œæ­£å¸¸ã€æˆ–å…¶ä»–çŠ¶æ€ã€‚

***

## èµ„æºç®¡ç†

èµ„æºç®¡ç†å±•ç¤ºé›†ç¾¤èµ„æºçš„åˆ†é…æƒ…å†µï¼Œæ³¨æ„è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯èµ„æºåˆ†é…é‡ï¼Œè€Œéå®æ—¶ä½¿ç”¨é‡ï¼ˆå®æ—¶ä½¿ç”¨è¯·æŸ¥çœ‹é›†ç¾¤ç›‘æ§ï¼‰ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤ç®¡ç† â†’ é€‰æ‹©å¯¹åº”çš„é›†ç¾¤ â†’ è¿›å…¥æ§åˆ¶å°

**CPU**ï¼šæ˜¾ç¤ºæ€»æ ¸æ•°ã€å·²åˆ†é…æ¯”ä¾‹ã€å‰©ä½™æ ¸æ•°ã€‚

**å†…å­˜**ï¼šæ˜¾ç¤ºæ€»å®¹é‡ï¼ˆGiBï¼‰ã€å·²åˆ†é…æ¯”ä¾‹ã€å‰©ä½™å®¹é‡ã€‚

**GPU**ï¼šæ˜¾ç¤º GPU å¡æ€»æ•°ã€å·²åˆ†é…æ¯”ä¾‹ã€å‰©ä½™æ•°é‡ã€‚

**Pod**ï¼šæ˜¾ç¤º Pod é…é¢æ€»æ•°ã€å·²åˆ†é…æ¯”ä¾‹ã€å‰©ä½™æ•°é‡ã€‚

**å­˜å‚¨**ï¼šæ˜¾ç¤ºä¸´æ—¶å­˜å‚¨æ€»å®¹é‡ï¼ˆGiBï¼‰ã€å·²åˆ†é…æ¯”ä¾‹ã€å‰©ä½™å®¹é‡ã€‚å­˜å‚¨èµ„æºè¾ƒä¸ºç‰¹æ®Šï¼Œè¿™é‡Œæ§åˆ¶çš„æ˜¯ä¸´æ—¶å­˜å‚¨ï¼ˆephemeral storageï¼‰ï¼Œéœ€è¦æ ¹æ®é›†ç¾¤èŠ‚ç‚¹é…ç½®æ‰‹åŠ¨è®¾ç½®å®¹é‡å€¼ã€‚
![image.png](https://images.ikubeops.com/static/20260116215109134.png)

***

## åŒæ­¥åŠŸèƒ½

åŒæ­¥åŠŸèƒ½ç”¨äºå°†é›†ç¾¤çš„æœ€æ–°çŠ¶æ€åŒæ­¥åˆ° Kube Nova å¹³å°ï¼Œç¡®ä¿å¹³å°æ•°æ®ä¸å®é™…é›†ç¾¤ä¿æŒä¸€è‡´ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤ç®¡ç† â†’ ç‚¹å‡»é›†ç¾¤å¡ç‰‡ä¸Šçš„ã€ŒåŒæ­¥ã€æŒ‰é’®

åŒæ­¥æ“ä½œä¼šæ›´æ–°ä»¥ä¸‹ä¿¡æ¯ï¼šé›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ã€Podã€å­˜å‚¨ç­‰çš„åˆ†é…å’Œä½¿ç”¨æ•°æ®ï¼‰ã€å‘½åç©ºé—´ï¼ˆNamespaceï¼‰åˆ—è¡¨ã€å·¥ä½œè´Ÿè½½å’Œåº”ç”¨ä¿¡æ¯ï¼ˆDeploymentã€StatefulSetã€DaemonSet ç­‰ï¼‰ã€èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯ã€å…¶ä»–é›†ç¾¤å…ƒæ•°æ®ã€‚

> \[!NOTE] é›†ç¾¤åŒæ­¥
> é›†ç¾¤ç¬¬ä¸€æ¬¡åŒæ­¥ä¸ºå…¨é‡åŒæ­¥
> åç»­åŒæ­¥é€»è¾‘ å¢é‡ Informer
> å…¨é‡å®šæ—¶ä»»åŠ¡

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/04.èŠ‚ç‚¹ç®¡ç†.md
---

# é›†ç¾¤èŠ‚ç‚¹ç®¡ç†

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Kube Nova å¹³å°ä¸­ç®¡ç† Kubernetes é›†ç¾¤çš„èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹åˆ—è¡¨æŸ¥çœ‹ã€èŠ‚ç‚¹ç›‘æ§ã€èŠ‚ç‚¹è¯¦æƒ…ç®¡ç†ã€æ ‡ç­¾/æ³¨è§£/æ±¡ç‚¹é…ç½®ä»¥åŠèŠ‚ç‚¹ç»´æŠ¤æ“ä½œç­‰åŠŸèƒ½ã€‚

âœ¨ **ç‰¹æ€§:**

* ç›‘æ§
* YAML è¯¦æƒ…
* èŠ‚ç‚¹ç»´æŠ¤
* å¯ç”¨/ç¦ç”¨è°ƒåº¦
* æ ‡ç­¾ç®¡ç†
* æ±¡ç‚¹ç®¡ç†
* æ³¨è§£ç®¡ç†

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤èŠ‚ç‚¹ â†’ é€‰æ‹©å¯¹åº”çš„é›†ç¾¤

## èŠ‚ç‚¹åˆ—è¡¨

èŠ‚ç‚¹åˆ—è¡¨é¡µé¢å±•ç¤ºé›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æ¦‚è§ˆä¿¡æ¯ï¼Œæ”¯æŒå¡ç‰‡è§†å›¾å’Œåˆ—è¡¨è§†å›¾ä¸¤ç§å±•ç¤ºæ–¹å¼ã€‚

### èŠ‚ç‚¹å¡ç‰‡ä¿¡æ¯

æ¯ä¸ªèŠ‚ç‚¹ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š

* **èŠ‚ç‚¹æ ‡è¯†**ï¼šèŠ‚ç‚¹åç§°ï¼ˆå¦‚ `nova-24.ikubeops.local`ï¼‰å’Œ IP åœ°å€ï¼ˆå¦‚ `172.16.1.24`ï¼‰ã€‚
* **èŠ‚ç‚¹è§’è‰²**ï¼šã€ŒWorkerã€è¡¨ç¤ºå·¥ä½œèŠ‚ç‚¹ï¼Œè´Ÿè´£è¿è¡Œä¸šåŠ¡ Podï¼›ã€ŒControl Planeã€è¡¨ç¤ºæ§åˆ¶å¹³é¢èŠ‚ç‚¹ï¼Œè¿è¡Œ Kubernetes æ ¸å¿ƒç»„ä»¶ã€‚
* **è¿è¡ŒçŠ¶æ€**ï¼šæ˜¾ç¤ºèŠ‚ç‚¹å½“å‰çŠ¶æ€ï¼Œã€Œè¿è¡Œä¸­ã€è¡¨ç¤ºèŠ‚ç‚¹æ­£å¸¸å·¥ä½œã€‚
* **è°ƒåº¦çŠ¶æ€**ï¼šã€Œå¯è°ƒåº¦ã€è¡¨ç¤ºèŠ‚ç‚¹å¯ä»¥æ¥æ”¶æ–°çš„ Pod è°ƒåº¦ï¼›ã€Œç¦æ­¢è°ƒåº¦ã€è¡¨ç¤ºèŠ‚ç‚¹å·²è¢«è®¾ç½®ä¸ºä¸å¯è°ƒåº¦çŠ¶æ€ã€‚
* **èµ„æºä½¿ç”¨**ï¼šä»¥è¿›åº¦æ¡å’Œç™¾åˆ†æ¯”å½¢å¼å±•ç¤º CPU ä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ã€Pod æ•°é‡ï¼ˆå½“å‰/æœ€å¤§å®¹é‡ï¼‰ã€‚
* **èŠ‚ç‚¹ä¿¡æ¯**ï¼šæ˜¾ç¤ºèŠ‚ç‚¹æ¶æ„ï¼ˆå¦‚ amd64ï¼‰å’ŒåŠ å…¥é›†ç¾¤çš„æ—¶é—´ã€‚

### èŠ‚ç‚¹å¿«æ·æ“ä½œ

ç‚¹å‡»èŠ‚ç‚¹å¡ç‰‡å³ä¸Šè§’çš„èœå•æŒ‰é’®ï¼ˆä¸‰ä¸ªç‚¹ï¼‰ï¼Œå¯æ‰§è¡Œä»¥ä¸‹å¿«æ·æ“ä½œï¼š

**ç¦ç”¨è°ƒåº¦**ï¼šå°†èŠ‚ç‚¹è®¾ç½®ä¸ºä¸å¯è°ƒåº¦çŠ¶æ€ï¼ˆCordonNodeï¼‰ï¼Œæ–°çš„ Pod å°†ä¸ä¼šè¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ï¼Œä½†å·²è¿è¡Œçš„ Pod ä¸å—å½±å“ã€‚

**èŠ‚ç‚¹ç»´æŠ¤**ï¼šè¿›å…¥èŠ‚ç‚¹ç»´æŠ¤æ¨¡å¼ï¼ˆDrainï¼‰ï¼Œä¼šå®‰å…¨é©±é€èŠ‚ç‚¹ä¸Šçš„ Pod å¹¶ç¦æ­¢æ–°çš„è°ƒåº¦ï¼Œé€‚ç”¨äºèŠ‚ç‚¹å‡çº§æˆ–ç¡¬ä»¶ç»´æŠ¤åœºæ™¯ã€‚

***

## èŠ‚ç‚¹ç›‘æ§

èŠ‚ç‚¹ç›‘æ§é¡µé¢æä¾›å•ä¸ªèŠ‚ç‚¹çš„è¯¦ç»†æ€§èƒ½ç›‘æ§æ•°æ®ã€‚

æ ¸å¿ƒæŒ‡æ ‡ï¼š

* CPU ä½¿ç”¨ç‡
* å†…å­˜ä½¿ç”¨
* ç£ç›˜ä½¿ç”¨
* ç½‘ç»œæµé‡
* Pod çŠ¶æ€
* Kubernetes èŠ‚ç‚¹ä¿¡æ¯
* ç³»ç»Ÿç›‘æ§
* Pod CPU Top æ¦œ
* Pod å†…å­˜ Top æ¦œ
  **æ“ä½œè·¯å¾„**ï¼šèŠ‚ç‚¹å¡ç‰‡ â†’ ç›‘æ§æŒ‰é’®

***

## èŠ‚ç‚¹ç®¡ç†

### åŸºæœ¬ä¿¡æ¯

* **åŸºæœ¬ä¿¡æ¯åŒºåŸŸ**ï¼šèŠ‚ç‚¹åç§°ã€ä¸»æœºåã€èŠ‚ç‚¹ UUIDã€IP åœ°å€ã€èŠ‚ç‚¹è§’è‰²ï¼ˆworker/control-planeï¼‰ã€çŠ¶æ€ï¼ˆReady/NotReadyï¼‰ã€è°ƒåº¦çŠ¶æ€ï¼ˆå…è®¸è°ƒåº¦/ç¦æ­¢è°ƒåº¦ï¼‰ã€åŠ å…¥æ—¶é—´ã€‚
* **ç³»ç»Ÿä¿¡æ¯åŒºåŸŸ**ï¼šæ“ä½œç³»ç»Ÿï¼ˆå¦‚ linuxï¼‰ã€ç³»ç»Ÿé•œåƒï¼ˆå¦‚ Ubuntu 24.04.2 LTSï¼‰ã€å†…æ ¸ç‰ˆæœ¬ï¼ˆå¦‚ 6.8.0-90-genericï¼‰ã€æ¶æ„ï¼ˆå¦‚ amd64ï¼‰ã€å®¹å™¨è¿è¡Œæ—¶ï¼ˆå¦‚ containerd://2.2.0ï¼‰ã€Kubelet ç‰ˆæœ¬ï¼ˆå¦‚ v1.34.2ï¼‰ã€GPU æ”¯æŒï¼ˆæ˜¯/å¦ï¼‰ã€‚
* **èµ„æºé…ç½®åŒºåŸŸ**ï¼šCPU æ ¸å¿ƒæ•°ã€å†…å­˜å®¹é‡ã€Pod å®¹é‡ï¼ˆè¯¥èŠ‚ç‚¹æœ€å¤§å¯è¿è¡Œçš„ Pod æ•°é‡ï¼‰ã€‚
* **ç½‘ç»œä¿¡æ¯åŒºåŸŸ**ï¼šPod CIDRï¼ˆåˆ†é…ç»™è¯¥èŠ‚ç‚¹çš„ Pod ç½‘æ®µï¼‰ã€Pod CIDRsï¼ˆåŒ…å« IPv4 å’Œ IPv6 çš„å®Œæ•´ç½‘æ®µé…ç½®ï¼‰ã€‚
  ![åŸºæœ¬ä¿¡æ¯](https://images.ikubeops.com/static/20260117000732231.png)

### æ ‡ç­¾ç®¡ç†

æ ‡ç­¾ï¼ˆLabelsï¼‰ç”¨äºå¯¹èŠ‚ç‚¹è¿›è¡Œåˆ†ç±»å’Œé€‰æ‹©ï¼Œæ˜¯ Kubernetes ä¸­é‡è¦çš„å…ƒæ•°æ®æœºåˆ¶ã€‚

* **æ“ä½œåŠŸèƒ½**ï¼šæ·»åŠ æ ‡ç­¾ã€åˆ·æ–°æ ‡ç­¾åˆ—è¡¨ã€æœç´¢æ ‡ç­¾ã€‚
* **æ ‡ç­¾åˆ—è¡¨**å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼šé”®ï¼ˆKeyï¼‰ã€å€¼ï¼ˆValueï¼‰ã€ç±»å‹ã€æ“ä½œã€‚
* **æ ‡ç­¾ç±»å‹**åˆ†ä¸ºä¸¤ç§ï¼š
  * ã€Œå¯ç®¡ç†æ ‡ç­¾ã€æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„æ ‡ç­¾ï¼Œå¯ä»¥è‡ªç”±ç¼–è¾‘å’Œåˆ é™¤ï¼Œç”¨äºä¸šåŠ¡éœ€æ±‚å¦‚èŠ‚ç‚¹é€‰æ‹©ã€è°ƒåº¦çº¦æŸç­‰ã€‚
  * ã€Œç³»ç»Ÿä¿æŠ¤æ ‡ç­¾ã€ç”± Kubernetes ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå’Œç®¡ç†ï¼Œä¸å¯ä¿®æ”¹æˆ–åˆ é™¤ã€‚å¸¸è§çš„ç³»ç»Ÿæ ‡ç­¾åŒ…æ‹¬ `kubernetes.io/os`ï¼ˆæ“ä½œç³»ç»Ÿï¼‰ã€`kubernetes.io/arch`ï¼ˆæ¶æ„ï¼‰ã€`kubernetes.io/hostname`ï¼ˆä¸»æœºåï¼‰ã€`beta.kubernetes.io/arch`ï¼ˆæ¶æ„å…¼å®¹æ ‡ç­¾ï¼‰ã€`beta.kubernetes.io/os`ï¼ˆæ“ä½œç³»ç»Ÿå…¼å®¹æ ‡ç­¾ï¼‰ã€‚
    ![image.png](https://images.ikubeops.com/static/20260117000909182.png)

### æ³¨è§£ç®¡ç†

æ³¨è§£ï¼ˆAnnotationsï¼‰ç”¨äºå­˜å‚¨èŠ‚ç‚¹çš„é™„åŠ å…ƒæ•°æ®ä¿¡æ¯ï¼Œé€šå¸¸ç”±ç³»ç»Ÿç»„ä»¶æˆ–å·¥å…·è‡ªåŠ¨æ·»åŠ ã€‚

**æ“ä½œåŠŸèƒ½**ï¼šæ·»åŠ æ³¨è§£ã€åˆ·æ–°æ³¨è§£åˆ—è¡¨ã€æœç´¢æ³¨è§£ã€å¤åˆ¶æ³¨è§£å€¼ã€‚

å¸¸è§çš„ç³»ç»Ÿæ³¨è§£åŒ…æ‹¬ï¼š`volumes.kubernetes.io/controller-managed-attach-detach`ï¼ˆå·æŒ‚è½½ç®¡ç†ï¼‰ã€`csi.volume.kubernetes.io/nodeid`ï¼ˆCSI èŠ‚ç‚¹æ ‡è¯†ï¼‰ã€`node.alpha.kubernetes.io/ttl`ï¼ˆèŠ‚ç‚¹ TTLï¼‰ã€`projectcalico.org/IPv4Address`ï¼ˆCalico ç½‘ç»œ IPv4 åœ°å€ï¼‰ã€‚

æ³¨è§£ä¸æ ‡ç­¾ç±»ä¼¼ï¼Œä¹Ÿåˆ†ä¸ºã€Œå¯ç®¡ç†æ³¨è§£ã€å’Œã€Œç³»ç»Ÿä¿æŠ¤æ³¨è§£ã€ä¸¤ç§ç±»å‹ã€‚
![image.png](https://images.ikubeops.com/static/20260117000937974.png)

### æ±¡ç‚¹ç®¡ç†

æ±¡ç‚¹ï¼ˆTaintsï¼‰ç”¨äºæ§åˆ¶ Pod çš„è°ƒåº¦è¡Œä¸ºï¼Œå¯ä»¥é˜»æ­¢ç‰¹å®š Pod è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šã€‚

**æ±¡ç‚¹æ•ˆæœç±»å‹**ï¼š

* ã€ŒNoScheduleã€ä¸å…è®¸æ–°çš„ Pod è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ï¼Œå·²å­˜åœ¨çš„ Pod ä¸å—å½±å“ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„æ±¡ç‚¹æ•ˆæœï¼Œé€‚ç”¨äºéœ€è¦éš”ç¦»ç‰¹å®šå·¥ä½œè´Ÿè½½çš„åœºæ™¯ã€‚
* ã€ŒPreferNoScheduleã€å°½é‡é¿å…å°† Pod è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ï¼Œä½†ä¸æ˜¯å¼ºåˆ¶çš„ã€‚å½“æ²¡æœ‰å…¶ä»–å¯ç”¨èŠ‚ç‚¹æ—¶ï¼ŒPod ä»å¯èƒ½è¢«è°ƒåº¦åˆ°æ­¤èŠ‚ç‚¹ã€‚
* ã€ŒNoExecuteã€ä¸å…è®¸æ–°çš„ Pod è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ï¼Œå¹¶ä¸”é©±é€å·²å­˜åœ¨çš„ Podã€‚è¿™æ˜¯æœ€ä¸¥æ ¼çš„æ±¡ç‚¹æ•ˆæœï¼Œé€‚ç”¨äºèŠ‚ç‚¹ç»´æŠ¤æˆ–æ•…éšœéš”ç¦»åœºæ™¯ã€‚

**æ“ä½œåŠŸèƒ½**ï¼šæ·»åŠ æ±¡ç‚¹ã€åˆ·æ–°æ±¡ç‚¹åˆ—è¡¨ã€ç¼–è¾‘æ±¡ç‚¹ã€åˆ é™¤æ±¡ç‚¹ã€‚

**æ±¡ç‚¹ç¤ºä¾‹**ï¼š`nvidia.com/gpu=true:NoSchedule` è¡¨ç¤ºè¯¥èŠ‚ç‚¹é…ç½®äº† GPU æ±¡ç‚¹ï¼Œåªæœ‰å¸¦æœ‰å¯¹åº”å®¹å¿ï¼ˆTolerationï¼‰çš„ Pod æ‰èƒ½è°ƒåº¦åˆ°æ­¤èŠ‚ç‚¹ï¼Œé€šå¸¸ç”¨äº GPU èŠ‚ç‚¹çš„ä¸“ç”¨è°ƒåº¦ã€‚
![image.png](https://images.ikubeops.com/static/20260117001023252.png)

***

## èŠ‚ç‚¹ç»´æŠ¤æ“ä½œ

### ç¦ç”¨è°ƒåº¦ï¼ˆCordonï¼‰

ç¦ç”¨è°ƒåº¦ä¼šå°†èŠ‚ç‚¹æ ‡è®°ä¸ºä¸å¯è°ƒåº¦çŠ¶æ€ï¼Œæ–°çš„ Pod å°†ä¸ä¼šè¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ã€‚

**ä½¿ç”¨åœºæ™¯**ï¼šè®¡åˆ’è¿›è¡ŒèŠ‚ç‚¹ç»´æŠ¤ä½†ä¸éœ€è¦ç«‹å³é©±é€ç°æœ‰ Podã€ä¸´æ—¶éš”ç¦»èŠ‚ç‚¹è¿›è¡Œé—®é¢˜æ’æŸ¥ã€ä¸ºåç»­çš„ Drain æ“ä½œåšå‡†å¤‡ã€‚

**æ“ä½œæ–¹å¼**ï¼šèŠ‚ç‚¹å¡ç‰‡èœå• â†’ ç¦ç”¨è°ƒåº¦ã€‚

æ‰§è¡ŒåèŠ‚ç‚¹çš„è°ƒåº¦çŠ¶æ€å°†ä»ã€Œå¯è°ƒåº¦ã€å˜ä¸ºã€Œç¦æ­¢è°ƒåº¦ã€ã€‚

### å¯ç”¨è°ƒåº¦ï¼ˆUncordonï¼‰

å¯ç”¨è°ƒåº¦ä¼šå°†èŠ‚ç‚¹æ¢å¤ä¸ºå¯è°ƒåº¦çŠ¶æ€ã€‚

**ä½¿ç”¨åœºæ™¯**ï¼šèŠ‚ç‚¹ç»´æŠ¤å®Œæˆåæ¢å¤æ­£å¸¸è°ƒåº¦ã€é—®é¢˜æ’æŸ¥ç»“æŸåæ¢å¤èŠ‚ç‚¹æœåŠ¡ã€‚

**æ“ä½œæ–¹å¼**ï¼šèŠ‚ç‚¹å¡ç‰‡èœå• â†’ å¯ç”¨è°ƒåº¦ï¼ˆå½“èŠ‚ç‚¹å¤„äºç¦æ­¢è°ƒåº¦çŠ¶æ€æ—¶æ˜¾ç¤ºï¼‰ã€‚

### èŠ‚ç‚¹ç»´æŠ¤ï¼ˆDrainï¼‰

èŠ‚ç‚¹ç»´æŠ¤ä¼šå®‰å…¨åœ°é©±é€èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Podï¼Œå¹¶å°†èŠ‚ç‚¹è®¾ç½®ä¸ºä¸å¯è°ƒåº¦çŠ¶æ€ã€‚

**ä½¿ç”¨åœºæ™¯**ï¼šèŠ‚ç‚¹ç¡¬ä»¶ç»´æŠ¤æˆ–å‡çº§ã€Kubernetes ç‰ˆæœ¬å‡çº§ã€æ“ä½œç³»ç»Ÿæ›´æ–°æˆ–é‡å¯ã€‚

**æ“ä½œæ–¹å¼**ï¼šèŠ‚ç‚¹å¡ç‰‡èœå• â†’ èŠ‚ç‚¹ç»´æŠ¤ã€‚

**æ³¨æ„äº‹é¡¹**ï¼šDrain æ“ä½œä¼šå°è¯•ä¼˜é›…ç»ˆæ­¢ Podï¼Œéµå®ˆ PodDisruptionBudget é…ç½®ï¼›DaemonSet ç®¡ç†çš„ Pod é»˜è®¤ä¼šè¢«å¿½ç•¥ï¼›ç»´æŠ¤å®Œæˆåéœ€è¦æ‰‹åŠ¨æ‰§è¡Œã€Œå¯ç”¨è°ƒåº¦ã€æ¢å¤èŠ‚ç‚¹ã€‚

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/02.é›†ç¾¤èµ„æºç®¡ç†.md
---

âœ¨ **ç‰¹æ€§:**

* StorageClassï¼ˆå­˜å‚¨ç±»ï¼‰
* PersistentVolumeï¼ˆæŒä¹…å·ï¼‰
* ClusterRoleï¼ˆé›†ç¾¤è§’è‰²ï¼‰
* ClusterRoleBindingï¼ˆé›†ç¾¤è§’è‰²ç»‘å®šï¼‰
* IngressClassï¼ˆå…¥å£ç±»ï¼‰
  æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Kube Nova å¹³å°ä¸­ç®¡ç† Kubernetes é›†ç¾¤çº§åˆ«çš„èµ„æºå¯¹è±¡ï¼ŒåŒ…æ‹¬ StorageClassã€PersistentVolumeã€ClusterRoleã€ClusterRoleBinding å’Œ IngressClass ç­‰ã€‚

**æ“ä½œè·¯å¾„**ï¼šé›†ç¾¤ç®¡ç† â†’ é›†ç¾¤èµ„æº â†’ é€‰æ‹©å¯¹åº”çš„é›†ç¾¤

é¡µé¢é€šè¿‡æ ‡ç­¾é¡µç»„ç»‡ä¸åŒç±»å‹çš„èµ„æºï¼šStorageClassï¼ˆå­˜å‚¨ç±»ï¼‰ã€PersistentVolumeï¼ˆæŒä¹…å·ï¼‰ã€ClusterRoleï¼ˆé›†ç¾¤è§’è‰²ï¼‰ã€ClusterRoleBindingï¼ˆé›†ç¾¤è§’è‰²ç»‘å®šï¼‰ã€IngressClassï¼ˆå…¥å£ç±»ï¼‰ã€‚

## StorageClassï¼ˆå­˜å‚¨ç±»ï¼‰

StorageClass ä¸ºç®¡ç†å‘˜æä¾›äº†ä¸€ç§æè¿°å­˜å‚¨"ç±»"çš„æ–¹æ³•ï¼Œä¸åŒçš„ç±»å¯èƒ½æ˜ å°„åˆ°ä¸åŒçš„æœåŠ¡è´¨é‡ç­‰çº§ã€å¤‡ä»½ç­–ç•¥æˆ–å…¶ä»–ç­–ç•¥ã€‚

**åˆ›å»º StorageClass**ï¼šç‚¹å‡»ã€Œåˆ›å»º StorageClassã€æŒ‰é’®åˆ›å»ºæ–°çš„å­˜å‚¨ç±»ã€‚

**æœç´¢ä¸ç­›é€‰**ï¼šæ”¯æŒæŒ‰åç§°æœç´¢ï¼ŒæŒ‰ä¾›åº”å•†ç­›é€‰ã€‚

**èµ„æºæ“ä½œ**ï¼ˆç‚¹å‡»è¡Œæœ«æ“ä½œèœå•ï¼‰ï¼š

* æŸ¥çœ‹ YAMLï¼šä»¥ YAML æ ¼å¼æŸ¥çœ‹å­˜å‚¨ç±»çš„å®Œæ•´é…ç½®
* æŸ¥çœ‹è¯¦æƒ…ï¼šæŸ¥çœ‹å­˜å‚¨ç±»çš„è¯¦ç»†ä¿¡æ¯
* ç¼–è¾‘ï¼šä¿®æ”¹å­˜å‚¨ç±»é…ç½®
* å–æ¶ˆé»˜è®¤/è®¾ä¸ºé»˜è®¤ï¼šè®¾ç½®æˆ–å–æ¶ˆé›†ç¾¤é»˜è®¤å­˜å‚¨ç±»
* åˆ é™¤ï¼šåˆ é™¤å­˜å‚¨ç±»
  ![image.png](https://images.ikubeops.com/static/20260117211725505.png)

## PersistentVolumeï¼ˆæŒä¹…å·ï¼‰

PersistentVolumeï¼ˆPVï¼‰æ˜¯é›†ç¾¤ä¸­çš„ä¸€å—å­˜å‚¨ï¼Œç”±ç®¡ç†å‘˜é…ç½®æˆ–ä½¿ç”¨ StorageClass åŠ¨æ€é…ç½®ã€‚

**åˆ›å»º PersistentVolume**ï¼šç‚¹å‡»ã€Œåˆ›å»º PersistentVolumeã€æŒ‰é’®æ‰‹åŠ¨åˆ›å»º PVã€‚

**æœç´¢ä¸ç­›é€‰**ï¼šæ”¯æŒæŒ‰åç§°æœç´¢ï¼ŒæŒ‰çŠ¶æ€å’Œå­˜å‚¨ç±»ç­›é€‰ã€‚

**èµ„æºæ“ä½œ**ï¼ˆç‚¹å‡»è¡Œæœ«æ“ä½œèœå•ï¼‰ï¼š

* æŸ¥çœ‹ YAMLï¼šä»¥ YAML æ ¼å¼æŸ¥çœ‹ PV çš„å®Œæ•´é…ç½®
* Describeï¼šæŸ¥çœ‹ PV çš„è¯¦ç»†æè¿°ä¿¡æ¯
* ä½¿ç”¨æƒ…å†µï¼šæŸ¥çœ‹ PV çš„ä½¿ç”¨ç»Ÿè®¡
* ç¼–è¾‘ï¼šä¿®æ”¹ PV é…ç½®
* åˆ é™¤ï¼šåˆ é™¤ PV

![image.png](https://images.ikubeops.com/static/20260117211747624.png)

## ClusterRoleï¼ˆé›†ç¾¤è§’è‰²ï¼‰

ClusterRole æ˜¯é›†ç¾¤çº§åˆ«çš„æƒé™é›†åˆï¼Œå®šä¹‰äº†ä¸€ç»„å¯¹é›†ç¾¤èµ„æºçš„è®¿é—®è§„åˆ™ã€‚

**åˆ›å»º ClusterRole**ï¼šç‚¹å‡»ã€Œåˆ›å»º ClusterRoleã€æŒ‰é’®åˆ›å»ºæ–°çš„é›†ç¾¤è§’è‰²ã€‚

**æœç´¢**ï¼šæ”¯æŒæŒ‰åç§°æœç´¢è§’è‰²ã€‚

**èµ„æºæ“ä½œ**ï¼ˆç‚¹å‡»è¡Œæœ«æ“ä½œèœå•ï¼‰ï¼š

* æŸ¥çœ‹ YAMLï¼šä»¥ YAML æ ¼å¼æŸ¥çœ‹è§’è‰²çš„å®Œæ•´é…ç½®
* Describeï¼šæŸ¥çœ‹è§’è‰²çš„è¯¦ç»†æè¿°ä¿¡æ¯
* ä½¿ç”¨æƒ…å†µï¼šæŸ¥çœ‹å“ªäº›ä¸»ä½“ç»‘å®šäº†è¯¥è§’è‰²
* æƒé™æ‘˜è¦ï¼šæŸ¥çœ‹è§’è‰²åŒ…å«çš„æ‰€æœ‰æƒé™è§„åˆ™æ‘˜è¦
* ç¼–è¾‘ï¼šä¿®æ”¹è§’è‰²é…ç½®ï¼ˆç³»ç»Ÿè§’è‰²ä¸å¯ç¼–è¾‘ï¼‰
* åˆ é™¤ï¼šåˆ é™¤è§’è‰²ï¼ˆç³»ç»Ÿè§’è‰²ä¸å¯åˆ é™¤ï¼‰
  ![image.png](https://images.ikubeops.com/static/20260117211813008.png)

## ClusterRoleBindingï¼ˆé›†ç¾¤è§’è‰²ç»‘å®šï¼‰

ClusterRoleBinding å°† ClusterRole ä¸­å®šä¹‰çš„æƒé™æˆäºˆä¸€ä¸ªæˆ–ä¸€ç»„ç”¨æˆ·ï¼Œä½œç”¨äºæ•´ä¸ªé›†ç¾¤ã€‚

**åˆ›å»º ClusterRoleBinding**ï¼šç‚¹å‡»ã€Œåˆ›å»º ClusterRoleBindingã€æŒ‰é’®åˆ›å»ºæ–°çš„è§’è‰²ç»‘å®šã€‚

**æœç´¢**ï¼šæ”¯æŒæŒ‰åç§°æœç´¢ç»‘å®šã€‚

**èµ„æºæ“ä½œ**ï¼ˆç‚¹å‡»è¡Œæœ«æ“ä½œèœå•ï¼‰ï¼š

* æŸ¥çœ‹ YAMLï¼šä»¥ YAML æ ¼å¼æŸ¥çœ‹ç»‘å®šçš„å®Œæ•´é…ç½®
* Describeï¼šæŸ¥çœ‹ç»‘å®šçš„è¯¦ç»†æè¿°ä¿¡æ¯
* å®é™…æƒé™ï¼šæŸ¥çœ‹é€šè¿‡æ­¤ç»‘å®šè·å¾—çš„å®é™…æƒé™åˆ—è¡¨
* ç¼–è¾‘ï¼šä¿®æ”¹ç»‘å®šé…ç½®
* åˆ é™¤ï¼šåˆ é™¤ç»‘å®š
  ![image.png](https://images.ikubeops.com/static/20260117211840154.png)

## IngressClassï¼ˆå…¥å£ç±»ï¼‰

IngressClass ç”¨äºæ ‡è¯† Ingress æ§åˆ¶å™¨çš„ç±»å‹ï¼Œå…è®¸åœ¨åŒä¸€é›†ç¾¤ä¸­è¿è¡Œå¤šä¸ª Ingress æ§åˆ¶å™¨ã€‚

**åˆ›å»º IngressClass**ï¼šç‚¹å‡»ã€Œåˆ›å»º IngressClassã€æŒ‰é’®åˆ›å»ºæ–°çš„å…¥å£ç±»ã€‚

**æœç´¢**ï¼šæ”¯æŒæŒ‰åç§°æˆ–æ§åˆ¶å™¨æœç´¢ã€‚

**èµ„æºæ“ä½œ**ï¼ˆç‚¹å‡»è¡Œæœ«æ“ä½œèœå•ï¼‰ï¼š

* æŸ¥çœ‹ YAMLï¼šä»¥ YAML æ ¼å¼æŸ¥çœ‹å…¥å£ç±»çš„å®Œæ•´é…ç½®
* Describeï¼šæŸ¥çœ‹å…¥å£ç±»çš„è¯¦ç»†æè¿°ä¿¡æ¯
* ä½¿ç”¨æƒ…å†µï¼šæŸ¥çœ‹ä½¿ç”¨æ­¤å…¥å£ç±»çš„ Ingress èµ„æº
* æ§åˆ¶å™¨çŠ¶æ€ï¼šæŸ¥çœ‹å…³è” Ingress æ§åˆ¶å™¨çš„è¿è¡ŒçŠ¶æ€
* ç¼–è¾‘ï¼šä¿®æ”¹å…¥å£ç±»é…ç½®
* è®¾ä¸ºé»˜è®¤ï¼šå°†æ­¤å…¥å£ç±»è®¾ç½®ä¸ºé›†ç¾¤é»˜è®¤
* åˆ é™¤ï¼šåˆ é™¤å…¥å£ç±»
  ![image.png](https://images.ikubeops.com/static/20260117211855840.png)

---

---
url: /01.æŒ‡å—/10.ä½¿ç”¨/07.é¡¹ç›®ç®¡ç†.md
---

âœ¨ **ç‰¹æ€§:**

* å¤šç§Ÿæˆ·éš”ç¦»: åŸºäºé¡¹ç›®çš„èµ„æºéš”ç¦»ä¸æƒé™ç®¡ç†
* å¤šé›†ç¾¤èµ„æºæ± : ä¸€ä¸ªé¡¹ç›®å¯ç»‘å®šå¤šä¸ªé›†ç¾¤çš„èµ„æºé…é¢
* çµæ´»é…é¢ç®¡ç†: æ”¯æŒ CPUã€å†…å­˜ã€GPUã€å­˜å‚¨ã€Pod ç­‰å¤šç»´åº¦é…é¢
* è¶…åˆ†é…æ¯”ä¾‹: æ”¯æŒèµ„æºè¶…åˆ†é…ï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡
* Kubernetes èµ„æºé™åˆ¶: ç»†ç²’åº¦æ§åˆ¶å„ç±» K8s èµ„æºå¯¹è±¡æ•°é‡

## æ ¸å¿ƒæ¦‚å¿µ

åœ¨ Kube Nova ä¸­ï¼Œ**é¡¹ç›®ï¼ˆProjectï¼‰** æ˜¯å¤šç§Ÿæˆ·éš”ç¦»çš„æ ¸å¿ƒå•ä½ã€‚ç†è§£é¡¹ç›®ä¸é›†ç¾¤èµ„æºçš„å…³ç³»æ˜¯ä½¿ç”¨å¹³å°çš„åŸºç¡€ã€‚

### é¡¹ç›®ä¸èµ„æºæ± çš„å…³ç³»

**é¡¹ç›®** æ˜¯ä¸€ä¸ªé€»è¾‘éš”ç¦»å•å…ƒï¼Œä»£è¡¨ä¸€ä¸ªç§Ÿæˆ·ã€å›¢é˜Ÿæˆ–ä¸šåŠ¡çº¿ã€‚æ¯ä¸ªé¡¹ç›®å¯ä»¥å…³è”å¤šä¸ªé›†ç¾¤çš„èµ„æºé…é¢ï¼Œè¿™ç§å…³è”å…³ç³»åœ¨ Kube Nova ä¸­ç§°ä¸º **èµ„æºæ± ï¼ˆResource Poolï¼‰**ã€‚

èµ„æºæ± å®šä¹‰äº†é¡¹ç›®åœ¨æŸä¸ªç‰¹å®šé›†ç¾¤ä¸Šå¯ä»¥ä½¿ç”¨çš„èµ„æºä¸Šé™ã€‚åªæœ‰å½“é¡¹ç›®æ‹¥æœ‰æŸä¸ªé›†ç¾¤çš„èµ„æºæ± åï¼Œé¡¹ç›®ç®¡ç†è€…æ‰èƒ½åœ¨è¯¥é›†ç¾¤ä¸Šåˆ›å»ºå·¥ä½œç©ºé—´ï¼ˆNamespaceï¼‰ã€‚

è¿™ç§è®¾è®¡çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼šé›†ç¾¤ç®¡ç†å‘˜å¯ä»¥å°†é›†ç¾¤èµ„æºæŒ‰éœ€åˆ†é…ç»™ä¸åŒé¡¹ç›®ï¼Œå®ç°èµ„æºçš„ç²¾ç»†åŒ–ç®¡ç†å’Œæˆæœ¬åˆ†æ‘Šï¼›åŒæ—¶ï¼Œé¡¹ç›®ç®¡ç†è€…åªèƒ½åœ¨è¢«æˆæƒçš„é›†ç¾¤èŒƒå›´å†…æ“ä½œï¼Œç¡®ä¿äº†å¤šç§Ÿæˆ·ç¯å¢ƒä¸‹çš„å®‰å…¨éš”ç¦»ã€‚

### èµ„æºå±‚çº§å…³ç³»

```
å¹³å° (Kube Nova)
  â””â”€â”€ é›†ç¾¤ (Cluster)
        â””â”€â”€ èµ„æºæ±  (Resource Pool) â”€â”€å…³è”â”€â”€â–º é¡¹ç›® (Project)
              â””â”€â”€ å·¥ä½œç©ºé—´ (Workspace / Namespace)
                    â””â”€â”€ å·¥ä½œè´Ÿè½½ (Workload)
```

***

## é¡¹ç›®ç®¡ç†

é¡¹ç›®ç®¡ç†æ¨¡å—ç”¨äºåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å’ŒæŸ¥çœ‹é¡¹ç›®ä¿¡æ¯ã€‚

**æ“ä½œè·¯å¾„**ï¼šé¡¹ç›®ä¸­å¿ƒ â†’ é¡¹ç›®ç®¡ç†

### é¡¹ç›®åˆ—è¡¨

é¡¹ç›®åˆ—è¡¨å±•ç¤ºæ‰€æœ‰å·²åˆ›å»ºçš„é¡¹ç›®ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ä¿¡æ¯ï¼š

**é¡¹ç›®åç§°** æ˜¾ç¤ºé¡¹ç›®çš„æ˜¾ç¤ºåç§°ï¼Œä¾¿äºè¯†åˆ«å’Œç®¡ç†ã€‚

**é¡¹ç›®æ ‡è¯†** ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUID æ ¼å¼ï¼‰ï¼Œç”¨äº API è°ƒç”¨å’Œå†…éƒ¨å…³è”ã€‚

**æè¿°** é¡¹ç›®çš„ç”¨é€”è¯´æ˜å’Œå¤‡æ³¨ä¿¡æ¯ã€‚

**ç®¡ç†å‘˜** æ˜¾ç¤ºé¡¹ç›®ç®¡ç†å‘˜æ•°é‡ï¼Œç‚¹å‡»å¯æŸ¥çœ‹ç®¡ç†å‘˜åˆ—è¡¨ã€‚

**èµ„æºæ± ** æ˜¾ç¤ºé¡¹ç›®å…³è”çš„é›†ç¾¤èµ„æºæ± æ•°é‡ï¼Œæ•°å­—é“¾æ¥å¯è·³è½¬è‡³èµ„æºæ± è¯¦æƒ…ã€‚

**åˆ›å»ºæ—¶é—´** é¡¹ç›®çš„åˆ›å»ºæ—¶é—´æˆ³ã€‚

**æ“ä½œ** åŒ…æ‹¬æˆå‘˜ç®¡ç†ã€è¯¦æƒ…æŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½ã€‚

### æ–°å»ºé¡¹ç›®

ç‚¹å‡»ã€Œ+ æ–°å»ºé¡¹ç›®ã€æŒ‰é’®åˆ›å»ºæ–°é¡¹ç›®ã€‚

**é¡¹ç›®åç§°**ï¼ˆå¿…å¡«ï¼‰ï¼šè¾“å…¥é¡¹ç›®çš„æ˜¾ç¤ºåç§°ï¼Œå»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°ä¾¿äºè¯†åˆ«ï¼Œä¾‹å¦‚ `äº‘åŸç”Ÿé¡¹ç›®`ã€`å¤§æ¨¡å‹å¹³å°`ã€`å¾®æœåŠ¡é¡¹ç›®` ç­‰ã€‚

**é¡¹ç›®æè¿°**ï¼ˆå¯é€‰ï¼‰ï¼šæè¿°é¡¹ç›®çš„ç”¨é€”ã€è´Ÿè´£å›¢é˜Ÿã€ä¸šåŠ¡èŒƒå›´ç­‰ä¿¡æ¯ï¼Œæœ€å¤š 500 å­—ç¬¦ã€‚

**é¡¹ç›®ç®¡ç†å‘˜**ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šé¡¹ç›®çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œç®¡ç†å‘˜æ‹¥æœ‰é¡¹ç›®å†…çš„æœ€é«˜æƒé™ï¼ŒåŒ…æ‹¬èµ„æºæ± åˆ†é…ã€å·¥ä½œç©ºé—´åˆ›å»ºã€æˆå‘˜ç®¡ç†ç­‰ã€‚

### é»˜è®¤é¡¹ç›®

ç³»ç»Ÿå†…ç½®ä¸€ä¸ªã€Œé»˜è®¤é¡¹ç›®ã€ï¼Œè¯¥é¡¹ç›®å…·æœ‰ç‰¹æ®Šå±æ€§ï¼šæœªç½²åé¡¹ç›®ä¼šé»˜è®¤åˆ°æ­¤é¡¹ç›®ä¸‹ã€‚é»˜è®¤é¡¹ç›®ä¸å¯åˆ é™¤ï¼Œä½†å¯ä»¥ä¿®æ”¹å…¶é…ç½®ã€‚å»ºè®®ä¸è¦å°†ç”Ÿäº§ä¸šåŠ¡éƒ¨ç½²åœ¨é»˜è®¤é¡¹ç›®ä¸­ï¼Œåº”ä¸ºæ¯ä¸ªä¸šåŠ¡çº¿åˆ›å»ºç‹¬ç«‹é¡¹ç›®ã€‚

### åŒæ­¥å…¨éƒ¨æ•°æ®

ç‚¹å‡»ã€ŒåŒæ­¥å…¨éƒ¨æ•°æ®ã€æŒ‰é’®å¯å°†æ‰€æœ‰é¡¹ç›®åŠå…¶èµ„æºæ± çš„æœ€æ–°çŠ¶æ€åŒæ­¥åˆ°å¹³å°ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚å½“å‘ç°èµ„æºæ± æ•°æ®ä¸å®é™…é›†ç¾¤çŠ¶æ€ä¸ç¬¦æ—¶ï¼Œå¯ä½¿ç”¨æ­¤åŠŸèƒ½è¿›è¡ŒåŒæ­¥ã€‚

***

## èµ„æºæ± ç®¡ç†

èµ„æºæ± æ˜¯é¡¹ç›®ä¸é›†ç¾¤ä¹‹é—´çš„æ¡¥æ¢ï¼Œå®šä¹‰äº†é¡¹ç›®åœ¨ç‰¹å®šé›†ç¾¤ä¸Šçš„èµ„æºé…é¢ã€‚

**æ“ä½œè·¯å¾„**ï¼šé¡¹ç›®ä¸­å¿ƒ â†’ èµ„æºæ± 

### åˆ†é…èµ„æºæ± 

ç‚¹å‡»ã€Œ+ åˆ†é…èµ„æºæ± ã€æŒ‰é’®ä¸ºé¡¹ç›®åˆ†é…æ–°çš„é›†ç¾¤èµ„æºã€‚

#### æ­¥éª¤ä¸€ï¼šé€‰æ‹©é›†ç¾¤

åœ¨é›†ç¾¤é€‰æ‹©åŒºåŸŸï¼Œè¾“å…¥é›†ç¾¤åç§°è¿›è¡Œæœç´¢æˆ–ç‚¹å‡»ã€Œæµè§ˆå…¨éƒ¨ã€æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é›†ç¾¤ã€‚åªæœ‰å·²æ·»åŠ åˆ°å¹³å°ä¸”çŠ¶æ€æ­£å¸¸çš„é›†ç¾¤æ‰ä¼šå‡ºç°åœ¨åˆ—è¡¨ä¸­ã€‚

é€‰æ‹©ç›®æ ‡é›†ç¾¤åï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºè¯¥é›†ç¾¤çš„åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€UUIDï¼‰ã€‚ä¸€ä¸ªé›†ç¾¤å¯ä»¥è¢«åˆ†é…ç»™å¤šä¸ªé¡¹ç›®ï¼Œä½†æ¯ä¸ªé¡¹ç›®åœ¨åŒä¸€é›†ç¾¤ä¸Šåªèƒ½æœ‰ä¸€ä¸ªèµ„æºæ± ã€‚

#### æ­¥éª¤äºŒï¼šè´¹ç”¨é…ç½®

è´¹ç”¨é…ç½®å†³å®šäº†è¯¥èµ„æºæ± çš„è®¡è´¹æ–¹æ¡ˆï¼Œç”¨äºæˆæœ¬æ ¸ç®—å’Œè´¹ç”¨åˆ†æ‘Šã€‚

**è®¡è´¹æ–¹æ¡ˆ** ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©é¢„è®¾çš„è®¡è´¹æ–¹æ¡ˆï¼š

* **æ ‡å‡†è®¡è´¹**ï¼ˆç³»ç»Ÿå†…ç½®ï¼‰ï¼šä½¿ç”¨å¹³å°é»˜è®¤ä»·æ ¼ä½“ç³»
* **ä¸è®¡è´¹**ï¼ˆç³»ç»Ÿå†…ç½®ï¼‰ï¼šè¯¥èµ„æºæ± ä¸äº§ç”Ÿè´¹ç”¨
* **è‡ªå®šä¹‰è®¡è´¹**ï¼šå¦‚æœå·²åœ¨è´¹ç”¨ç®¡ç†æ¨¡å—åˆ›å»ºè‡ªå®šä¹‰è®¡è´¹æ–¹æ¡ˆï¼Œå¯åœ¨æ­¤é€‰æ‹©

**è®¡è´¹å¼€å§‹æ—¶é—´** è®¾ç½®è¯¥èµ„æºæ± å¼€å§‹è®¡è´¹çš„æ—¶é—´ç‚¹ã€‚ç•™ç©ºåˆ™ä»èµ„æºæ± åˆ›å»ºæ—¶åˆ»å¼€å§‹è®¡è´¹ã€‚

**ä»·æ ¼é¢„è§ˆ** å±•ç¤ºæ‰€é€‰è®¡è´¹æ–¹æ¡ˆçš„å…·ä½“ä»·æ ¼ï¼š

* CPU: Â¥0.0500/æ ¸/æ—¶
* å†…å­˜: Â¥0.0150/GiB/æ—¶
* å­˜å‚¨: Â¥0.0010/GiB/æ—¶
* GPU: Â¥15.0000/å¡/æ—¶
* Pod: Â¥0.0020/ä¸ª/æ—¶
* ç®¡ç†è´¹: Â¥3.1000/æ—¶

#### æ­¥éª¤ä¸‰ï¼šèµ„æºé…é¢é…ç½®

èµ„æºé…é¢é…ç½®æ˜¯èµ„æºæ± çš„æ ¸å¿ƒè®¾ç½®ï¼Œå†³å®šäº†é¡¹ç›®åœ¨è¯¥é›†ç¾¤ä¸Šå¯ä½¿ç”¨çš„èµ„æºä¸Šé™ã€‚

é¡µé¢é¡¶éƒ¨çš„ã€Œé›†ç¾¤èµ„æºæ¦‚è§ˆã€åŒºåŸŸå®æ—¶æ˜¾ç¤ºç›®æ ‡é›†ç¾¤çš„èµ„æºæ€»é‡å’Œå·²åˆ†é…æƒ…å†µï¼Œå¸®åŠ©ç®¡ç†å‘˜äº†è§£å¯åˆ†é…ç©ºé—´ï¼š

* **CPU èµ„æº**ï¼š
* **å†…å­˜èµ„æº**ï¼š
* **å­˜å‚¨èµ„æº**ï¼š
* **GPU èµ„æº**ï¼š

##### CPU é…é¢

**é™åˆ¶å®¹é‡** è®¾ç½®é¡¹ç›®å¯ä½¿ç”¨çš„ CPU æ ¸æ•°ä¸Šé™ã€‚å•ä½å¯é€‰æ‹©ã€Œæ ¸ã€æˆ–ã€Œæ¯«æ ¸ã€ã€‚

**è¶…åˆ†æ¯”ä¾‹** èµ„æºè¶…åˆ†é…ç³»æ•°ï¼ŒèŒƒå›´ 1.0x - 10.0xã€‚ä¾‹å¦‚è®¾ç½®ä¸º 4x æ—¶ï¼Œå¦‚æœé™åˆ¶å®¹é‡ä¸º 10 æ ¸ï¼Œåˆ™é¡¹ç›®å®é™…å¯ç”³è¯·çš„ CPU requests æ€»é‡ä¸º 40 æ ¸ã€‚

**å®é™…å®¹é‡** ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—ï¼šå®é™…å®¹é‡ = é™åˆ¶å®¹é‡ Ã— è¶…åˆ†æ¯”ä¾‹ã€‚è¿™æ˜¯é¡¹ç›®åœ¨è¯¥é›†ç¾¤ä¸Šå¯ç”³è¯·çš„ CPU requests æ€»å’Œä¸Šé™ã€‚

è¶…åˆ†é…æœºåˆ¶çš„è®¾è®¡ç†å¿µï¼šå®¹å™¨çš„ CPU requests é€šå¸¸æ˜¯é¢„ç•™å€¼ï¼Œå®é™…ä½¿ç”¨é‡å¾€å¾€ä½äºç”³è¯·é‡ã€‚é€šè¿‡åˆç†çš„è¶…åˆ†æ¯”ä¾‹ï¼Œå¯ä»¥æé«˜é›†ç¾¤èµ„æºåˆ©ç”¨ç‡ï¼Œä½†éœ€è¦æ³¨æ„é¿å…è¶…åˆ†è¿‡é«˜å¯¼è‡´èµ„æºç«äº‰ã€‚

##### å†…å­˜é…é¢

**é™åˆ¶å®¹é‡** è®¾ç½®é¡¹ç›®å¯ä½¿ç”¨çš„å†…å­˜ä¸Šé™ã€‚å•ä½å¯é€‰æ‹© Giï¼ˆGiBï¼‰ã€Miï¼ˆMiBï¼‰ç­‰ã€‚

**è¶…åˆ†æ¯”ä¾‹** å†…å­˜èµ„æºçš„è¶…åˆ†é…ç³»æ•°ï¼Œå»ºè®®æ¯” CPU æ›´ä¿å®ˆï¼ˆå¦‚ 1.5x - 3xï¼‰ï¼Œå› ä¸ºå†…å­˜è¶…åˆ†å¯èƒ½å¯¼è‡´ OOMï¼ˆOut of Memoryï¼‰é—®é¢˜ã€‚

**å®é™…å®¹é‡** ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—çš„å†…å­˜ requests æ€»å’Œä¸Šé™ã€‚

##### å­˜å‚¨é…é¢

**å­˜å‚¨å®¹é‡é™åˆ¶** è®¾ç½®é¡¹ç›®å¯ä½¿ç”¨çš„ä¸´æ—¶å­˜å‚¨ï¼ˆephemeral storageï¼‰ä¸Šé™ã€‚å•ä½å¯é€‰æ‹© Giã€Mi ç­‰ã€‚

> \[!NOTE] å­˜å‚¨é…é¢è¯´æ˜
> æ­¤å¤„é…ç½®çš„æ˜¯ Kubernetes ä¸´æ—¶å­˜å‚¨ï¼ˆephemeral-storageï¼‰é…é¢ï¼Œä¸»è¦ç”¨äºæ§åˆ¶å®¹å™¨çš„ emptyDirã€æ—¥å¿—ã€å®¹å™¨å±‚å†™å…¥ç­‰ä¸´æ—¶æ•°æ®ã€‚æŒä¹…åŒ–å­˜å‚¨ï¼ˆPVCï¼‰çš„é…é¢é€šè¿‡ PVC æ•°é‡é™åˆ¶æ¥æ§åˆ¶ã€‚

##### GPU é…é¢

**GPU æ•°é‡** è®¾ç½®é¡¹ç›®å¯ä½¿ç”¨çš„ GPU å¡æ•°ä¸Šé™ã€‚å¦‚æœç›®æ ‡é›†ç¾¤æ²¡æœ‰ GPU èµ„æºï¼Œæ­¤é¡¹å°†æ˜¾ç¤ºä¸ºç¦ç”¨çŠ¶æ€ã€‚

**è¶…åˆ†æ¯”ä¾‹** GPU èµ„æºçš„è¶…åˆ†é…ç³»æ•°ã€‚ç”±äº GPU èµ„æºæ˜‚è´µä¸”é€šå¸¸ç”¨äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œå»ºè®®è°¨æ…è®¾ç½®è¶…åˆ†æ¯”ä¾‹ã€‚

##### Pod é…é¢

**Pod æ•°é‡é™åˆ¶** è®¾ç½®é¡¹ç›®å¯åˆ›å»ºçš„ Pod æ€»æ•°ä¸Šé™ã€‚è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„å®‰å…¨é…é¢ï¼Œå¯é˜²æ­¢å•ä¸ªé¡¹ç›®åˆ›å»ºè¿‡å¤š Pod å½±å“é›†ç¾¤ç¨³å®šæ€§ã€‚

##### é«˜çº§é…ç½®ï¼šKubernetes èµ„æºé™åˆ¶

å±•å¼€ã€Œé«˜çº§é…ç½®ã€åŒºåŸŸå¯è®¾ç½®å„ç±» Kubernetes èµ„æºå¯¹è±¡çš„æ•°é‡é™åˆ¶ï¼š

**é…ç½®ç±»èµ„æº**

* **ConfigMap**ï¼šé…ç½®æ˜ å°„æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100
* **Secret**ï¼šå¯†é’¥æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100

**å­˜å‚¨ç±»èµ„æº**

* **PVC**ï¼šæŒä¹…åŒ–å­˜å‚¨å·å£°æ˜æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100

**ç½‘ç»œç±»èµ„æº**

* **Service**ï¼šæœåŠ¡æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100
* **Ingress**ï¼šå…¥å£èµ„æºæ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 50
* **LoadBalancer**ï¼šè´Ÿè½½å‡è¡¡å™¨æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 10ï¼ˆäº‘ç¯å¢ƒä¸­ LB é€šå¸¸æœ‰é¢å¤–æˆæœ¬ï¼‰
* **NodePort**ï¼šNodePort æœåŠ¡æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100

**å·¥ä½œè´Ÿè½½ç±»èµ„æº**

* **Deployment**ï¼šéƒ¨ç½²æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100
* **StatefulSet**ï¼šæœ‰çŠ¶æ€é›†æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 50
* **DaemonSet**ï¼šå®ˆæŠ¤è¿›ç¨‹é›†æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 10
* **Job**ï¼šä»»åŠ¡æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 100
* **CronJob**ï¼šå®šæ—¶ä»»åŠ¡æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 50

**å­˜å‚¨ç±»é…ç½®**

* **ä¸´æ—¶å­˜å‚¨**ï¼šè®¾ç½®ä¸´æ—¶å­˜å‚¨çš„æ€»é‡é™åˆ¶ï¼ˆGiBï¼‰

è¿™äº›é™åˆ¶é€šè¿‡ Kubernetes çš„ ResourceQuota æœºåˆ¶å®ç°ï¼Œå½“é¡¹ç›®å†…çš„èµ„æºä½¿ç”¨è¾¾åˆ°é™åˆ¶æ—¶ï¼Œæ–°çš„èµ„æºåˆ›å»ºè¯·æ±‚å°†è¢«æ‹’ç»ã€‚

#### æ­¥éª¤å››ï¼šç¡®è®¤åˆ†é…

ç¡®è®¤æ‰€æœ‰é…ç½®æ— è¯¯åï¼Œç‚¹å‡»ã€Œåˆ†é…èµ„æºã€æŒ‰é’®å®Œæˆèµ„æºæ± åˆ›å»ºã€‚åˆ›å»ºæˆåŠŸåï¼Œé¡¹ç›®ç®¡ç†è€…å³å¯åœ¨è¯¥é›†ç¾¤ä¸Šåˆ›å»ºå·¥ä½œç©ºé—´ã€‚

***

## èµ„æºæ± æ“ä½œ

### ç¼–è¾‘èµ„æºæ± 

åœ¨èµ„æºæ± å¡ç‰‡ä¸Šç‚¹å‡»æ›´å¤šèœå•ï¼ˆâ‹®ï¼‰ï¼Œé€‰æ‹©ã€Œç¼–è¾‘ã€å¯ä¿®æ”¹èµ„æºæ± çš„é…é¢è®¾ç½®ã€‚ç¼–è¾‘æ—¶éœ€æ³¨æ„ï¼š

**é…é¢å¢åŠ ** å¯éšæ—¶è¿›è¡Œï¼Œä¸å½±å“å·²æœ‰å·¥ä½œè´Ÿè½½ã€‚

**é…é¢å‡å°‘** å¦‚æœæ–°é…é¢å°äºå½“å‰å·²ä½¿ç”¨é‡ï¼Œä¿®æ”¹å°†è¢«æ‹’ç»ã€‚éœ€è¦å…ˆæ¸…ç†èµ„æºä½¿ç”¨åå†é™ä½é…é¢ã€‚

**è®¡è´¹æ–¹æ¡ˆå˜æ›´** å˜æ›´è®¡è´¹æ–¹æ¡ˆå°†å½±å“åç»­çš„è´¹ç”¨è®¡ç®—ï¼Œå†å²è´¹ç”¨ä¸å—å½±å“ã€‚

### åˆ é™¤èµ„æºæ± 

é€‰æ‹©ã€Œåˆ é™¤ã€å¯ç§»é™¤é¡¹ç›®ä¸é›†ç¾¤çš„å…³è”å…³ç³»ã€‚åˆ é™¤å‰è¯·æ³¨æ„ï¼š

**å‰ç½®æ¡ä»¶** åªæœ‰å½“èµ„æºæ± ä¸‹æ²¡æœ‰å·¥ä½œç©ºé—´ï¼ˆNamespaceï¼‰æ—¶æ‰èƒ½åˆ é™¤ã€‚å¦‚æœå­˜åœ¨å·¥ä½œç©ºé—´ï¼Œéœ€è¦å…ˆåˆ é™¤æ‰€æœ‰å·¥ä½œç©ºé—´ã€‚

**æ•°æ®å½±å“** åˆ é™¤èµ„æºæ± åï¼Œè¯¥é¡¹ç›®å°†æ— æ³•å†åœ¨å¯¹åº”é›†ç¾¤ä¸Šåˆ›å»ºèµ„æºã€‚å·²äº§ç”Ÿçš„å†å²è´¹ç”¨è®°å½•ä¸ä¼šè¢«åˆ é™¤ã€‚

**æ¢å¤æ–¹å¼** å¦‚éœ€æ¢å¤ï¼Œå¯é‡æ–°ä¸ºé¡¹ç›®åˆ†é…è¯¥é›†ç¾¤çš„èµ„æºæ± ã€‚

***

## å·¥ä½œç©ºé—´ç®¡ç†

å·¥ä½œç©ºé—´æ˜¯ Kubernetes Namespace åœ¨ Kube Nova ä¸­çš„æ¦‚å¿µæ˜ å°„ï¼Œæ˜¯é¡¹ç›®å†…èµ„æºéš”ç¦»çš„åŸºæœ¬å•ä½ã€‚

### åˆ›å»ºå·¥ä½œç©ºé—´çš„å‰ææ¡ä»¶

è¦åœ¨æŸä¸ªé›†ç¾¤ä¸Šåˆ›å»ºå·¥ä½œç©ºé—´ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

1. **é¡¹ç›®å·²åˆ†é…è¯¥é›†ç¾¤çš„èµ„æºæ± **ï¼šé¡¹ç›®å¿…é¡»æ‹¥æœ‰ç›®æ ‡é›†ç¾¤çš„èµ„æºé…é¢ã€‚
2. **èµ„æºé…é¢å……è¶³**ï¼šèµ„æºæ± ä¸­éœ€æœ‰è¶³å¤Ÿçš„å‰©ä½™é…é¢ã€‚
3. **ç”¨æˆ·æƒé™**ï¼šæ“ä½œç”¨æˆ·éœ€å…·æœ‰é¡¹ç›®ç®¡ç†å‘˜æˆ–ç›¸åº”çš„åˆ›å»ºæƒé™ã€‚

### å·¥ä½œç©ºé—´ä¸èµ„æºæ± çš„å…³ç³»

ä¸€ä¸ªèµ„æºæ± å¯ä»¥åŒ…å«å¤šä¸ªå·¥ä½œç©ºé—´ï¼Œæ‰€æœ‰å·¥ä½œç©ºé—´å…±äº«èµ„æºæ± çš„é…é¢ã€‚è¿™ç§è®¾è®¡å…è®¸é¡¹ç›®ç®¡ç†è€…çµæ´»åœ°ç»„ç»‡å’Œéš”ç¦»ä¸åŒçš„åº”ç”¨æˆ–ç¯å¢ƒã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªã€Œå¾®æœåŠ¡é¡¹ç›®ã€åœ¨æŸé›†ç¾¤çš„èµ„æºæ± é…é¢ä¸º 40 CPUã€30 GiB å†…å­˜ï¼Œé¡¹ç›®ç®¡ç†è€…å¯ä»¥åˆ›å»ºï¼š

* `microservice-prod`ï¼šç”Ÿäº§ç¯å¢ƒå·¥ä½œç©ºé—´
* `microservice-staging`ï¼šé¢„å‘å¸ƒç¯å¢ƒå·¥ä½œç©ºé—´
* `microservice-dev`ï¼šå¼€å‘ç¯å¢ƒå·¥ä½œç©ºé—´

ä¸‰ä¸ªå·¥ä½œç©ºé—´å…±äº«è¯¥èµ„æºæ± çš„ 40 CPUã€30 GiB å†…å­˜é…é¢ã€‚

***

## æœ€ä½³å®è·µ

### é¡¹ç›®è§„åˆ’å»ºè®®

**æŒ‰ä¸šåŠ¡çº¿åˆ’åˆ†é¡¹ç›®** å»ºè®®æ¯ä¸ªç‹¬ç«‹çš„ä¸šåŠ¡çº¿æˆ–äº§å“åˆ›å»ºç‹¬ç«‹é¡¹ç›®ï¼Œä¾¿äºèµ„æºç®¡ç†ã€æˆæœ¬æ ¸ç®—å’Œæƒé™æ§åˆ¶ã€‚

**é¿å…é¡¹ç›®ç²’åº¦è¿‡ç»†** é¡¹ç›®æ•°é‡è¿‡å¤šä¼šå¢åŠ ç®¡ç†å¤æ‚åº¦ï¼Œå»ºè®®æ ¹æ®ç»„ç»‡æ¶æ„å’Œä¸šåŠ¡è¾¹ç•Œåˆç†åˆ’åˆ†ã€‚

**æ˜ç¡®é¡¹ç›®ç®¡ç†å‘˜èŒè´£** ä¸ºæ¯ä¸ªé¡¹ç›®æŒ‡å®šæ˜ç¡®çš„ç®¡ç†å‘˜ï¼Œè´Ÿè´£èµ„æºæ± ç”³è¯·ã€å·¥ä½œç©ºé—´ç®¡ç†å’Œæˆå‘˜ç®¡ç†ã€‚

### èµ„æºé…é¢è®¾ç½®å»ºè®®

**æ ¹æ®å®é™…éœ€æ±‚è®¾ç½®é…é¢** ä¸è¦ä¸€æ¬¡æ€§åˆ†é…è¿‡å¤šèµ„æºï¼Œå¯æ ¹æ®ä¸šåŠ¡å‘å±•é€æ­¥å¢åŠ é…é¢ã€‚

**åˆç†è®¾ç½®è¶…åˆ†æ¯”ä¾‹**

* CPU è¶…åˆ†æ¯”ä¾‹å»ºè®® 2x - 4xï¼Œé€‚ç”¨äº Web æœåŠ¡ç­‰ CPU ä½¿ç”¨æ³¢åŠ¨è¾ƒå¤§çš„åœºæ™¯
* å†…å­˜è¶…åˆ†æ¯”ä¾‹å»ºè®® 1x - 2xï¼Œå†…å­˜è¶…åˆ†é£é™©è¾ƒé«˜ï¼Œéœ€è°¨æ…
* GPU è¶…åˆ†æ¯”ä¾‹å»ºè®® 1xï¼ŒGPU ä»»åŠ¡é€šå¸¸éœ€è¦ç‹¬å ä½¿ç”¨

**é¢„ç•™ç¼“å†²ç©ºé—´** é…é¢è®¾ç½®æ—¶é¢„ç•™ 10% - 20% çš„ç¼“å†²ç©ºé—´ï¼Œåº”å¯¹çªå‘æµé‡æˆ–ç´§æ€¥æ‰©å®¹éœ€æ±‚ã€‚

**å®šæœŸå®¡æŸ¥é…é¢ä½¿ç”¨** å®šæœŸæ£€æŸ¥èµ„æºæ± çš„é…é¢ä½¿ç”¨ç‡ï¼Œå¯¹äºé•¿æœŸä½ä½¿ç”¨ç‡çš„èµ„æºæ± è€ƒè™‘å›æ”¶æˆ–é‡æ–°åˆ†é…ã€‚
